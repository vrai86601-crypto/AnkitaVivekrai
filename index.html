<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI ‡§∏‡•ç‡§ü‡§°‡•Ä ‚Äì ‡§™‡•ç‡§∞‡•ã ‡§µ‡§ø‡§ú‡§®</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Devanagari:wght@400;500;600;700&family=Montserrat:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- KaTeX (‡§ó‡§£‡§ø‡§§) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Tesseract OCR -->
    <script src="https://unpkg.com/tesseract.js@5.0.3/dist/tesseract.min.js"></script>
    <!-- PDF export (html2pdf) optional -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* ---------- ‡§Æ‡•Ç‡§≤ ‡§∂‡•à‡§≤‡•Ä (‡§•‡•Ä‡§Æ: ‡§≤‡§æ‡§≤ + ‡§ï‡§æ‡§≤‡§æ) ---------- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #b22222;          /* ‡§≤‡§æ‡§≤ */
            --primary-dark: #8b1a1a;
            --dark: #1e1e1e;              /* ‡§ï‡§æ‡§≤‡§æ */
            --paper: #fffcf7;
            --border-radius: 24px;
            --shadow: 0 15px 30px -12px rgba(0,0,0,0.2);
            --glass: rgba(255, 255, 255, 0.9);
        }
        body {
            background: linear-gradient(145deg, #d6cbbd, #e6ddd2);
            font-family: 'Poppins', 'IBM Plex Sans Devanagari', sans-serif;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }
        .app-container {
            max-width: 1400px;
            width: 100%;
            background: var(--paper);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 2px solid var(--primary);
            overflow: hidden;
        }
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 25px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-bottom: 3px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
            gap: 12px;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .brand-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            background: linear-gradient(90deg, var(--primary), var(--dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        .ai-icon { color: var(--primary); font-size: 1.8rem; }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .lang-switch {
            display: flex;
            align-items: center;
            background: var(--dark);
            padding: 4px;
            border-radius: 30px;
            border: 1px solid var(--primary);
            cursor: pointer;
            position: relative;
            width: 100px;
            height: 38px;
        }
        .lang-btn {
            flex: 1;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: #fff;
            z-index: 2;
            transition: 0.3s;
            line-height: 30px;
        }
        .lang-slider {
            position: absolute;
            width: 46px;
            height: 30px;
            background: var(--primary);
            border-radius: 25px;
            transition: 0.3s;
            left: 4px;
            top: 4px;
        }
        .lang-switch.eng .lang-slider {
            left: 50px;
        }

        .search-box {
            background: #eee;
            padding: 6px 15px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            border: 1px solid var(--primary);
        }
        .search-box input {
            border: none;
            background: transparent;
            outline: none;
            padding-left: 8px;
            min-width: 180px;
            font-family: 'Poppins', sans-serif;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--dark);
            color: white;
            padding: 5px 15px 5px 10px;
            border-radius: 40px;
            border: 2px solid var(--primary);
        }
        .btn-logout {
            background: var(--primary);
            color: white;
            border: none;
            padding: 5px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            border: 1px solid white;
        }
        .btn-logout:hover { background: #8b1a1a; transform: scale(1.02); }

        /* ‡§®‡§Ø‡§æ ‡§á‡§Ç‡§∏‡•ç‡§ü‡•Ä‡§ü‡•ç‡§Ø‡•Ç‡§ü ‡§∏‡•á‡§≤‡•á‡§ï‡•ç‡§∂‡§® ‡§¨‡•ç‡§≤‡•â‡§ï (‡§∏‡•ç‡§ï‡•á‡§ö 1) */
        .institution-card {
            background: white;
            border-radius: 28px;
            padding: 25px;
            margin: 20px 25px 10px;
            border: 3px solid var(--primary);
            box-shadow: 6px 6px 0 var(--dark);
        }
        .institution-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            align-items: flex-end;
        }
        .institution-item {
            flex: 1 1 200px;
        }
        .institution-item label {
            font-weight: 600;
            color: var(--dark);
            display: block;
            margin-bottom: 5px;
        }
        .institution-item select, .institution-item input {
            width: 100%;
            padding: 12px 18px;
            border-radius: 40px;
            border: 2px solid var(--dark);
            background: white;
            font-family: inherit;
        }
        .fill-next-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 40px;
            font-weight: 700;
            cursor: pointer;
            transition: 0.2s;
            border: 2px solid var(--dark);
        }
        .fill-next-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.02);
        }
        /* AI ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§ï‡•ã ‡§§‡•Ä‡§® ‡§ï‡§æ‡§∞‡•ç‡§°‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§¨‡§æ‡§Å‡§ü‡§®‡§æ */
        .ai-output-tabs {
            display: flex;
            gap: 10px;
            margin: 15px 0 10px;
        }
        .ai-output-tab {
            background: white;
            border: 2px solid var(--dark);
            padding: 10px 20px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
        }
        .ai-output-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .ai-output-panel {
            display: none;
            background: white;
            border-radius: 24px;
            padding: 20px;
            border-left: 8px solid var(--primary);
            margin-top: 10px;
        }
        .ai-output-panel.active {
            display: block;
        }
        /* ‡§ö‡•à‡§™‡•ç‡§ü‡§∞ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® */
        .chapter-nav {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin: 15px 0;
        }
        .chapter-btn {
            background: #eee;
            border: 2px solid var(--dark);
            padding: 8px 18px;
            border-radius: 40px;
            font-size: 0.9rem;
            cursor: pointer;
        }
        .chapter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        /* ‡§µ‡•à‡§¶‡§ø‡§ï ‡§Æ‡•à‡§• ‡§ï‡§æ‡§∞‡•ç‡§° */
        .vedic-card {
            background: linear-gradient(145deg, #1e1e1e, #2a2a2a);
            color: white;
            border-radius: 28px;
            padding: 20px;
            margin: 20px 0;
            border: 3px solid var(--primary);
            box-shadow: 5px 5px 0 var(--primary-dark);
        }
        .vedic-trick {
            background: #2d2d2d;
            border-radius: 20px;
            padding: 15px;
            margin: 10px 0;
            border-left: 8px solid #b22222;
        }
        .vedic-calculator {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .vedic-calculator input {
            flex: 1;
            padding: 12px;
            border-radius: 40px;
            border: 2px solid var(--primary);
            background: #333;
            color: white;
        }
        .vedic-calculator button {
            background: var(--primary);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 40px;
            font-weight: 600;
        }
        /* ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ‡§Æ‡•á‡§Ç PYQ ‡§¨‡•à‡§ú */
        .pyq-badge {
            background: gold;
            color: black;
            padding: 2px 10px;
            border-radius: 30px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 10px;
        }
        /* ‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞ */
        .interactive-diagram {
            background: #f0f0f0;
            border-radius: 30px;
            padding: 20px;
            text-align: center;
            border: 2px dashed var(--primary);
            margin: 15px 0;
        }
        .footer { margin-top:30px; text-align:center; color:#5f4e3c; padding-bottom:20px; }
        .login-card { background:white; border-radius:28px; padding:30px; max-width:400px; margin:30px auto; border:2px solid var(--primary); box-shadow:6px 6px 0 var(--dark); }
        #google_translate_element { margin-top:10px; text-align:center; background:white; border-radius:40px; padding:5px; border:2px solid var(--primary); width:fit-content; margin-left:auto; margin-right:auto; }
        .visually-hidden { position:absolute; left:-9999px; }
        @media (max-width:700px) {
            .institution-grid { flex-direction: column; }
        }
    </style>
</head>
<body>
<div class="app-container">
    <header class="header">
        <div class="logo">
            <i class="fas fa-microchip ai-icon"></i> 
            <span class="brand-name" id="brandName">‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI Study</span>
        </div>
        <div class="header-right">
            <div class="lang-switch" id="langToggle" onclick="toggleLanguage()">
                <div class="lang-slider"></div>
                <div class="lang-btn" id="langHi">HI</div>
                <div class="lang-btn" id="langEn">EN</div>
            </div>
            <div class="search-box" id="globalSearch">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="AI ‡§ü‡•â‡§™‡§ø‡§ï ‡§ñ‡•ã‡§ú‡•á‡§Ç..." id="globalSearchInput">
            </div>
            <div id="userInfo" class="user-info" style="display: none;">
                <span class="user-tag"><i class="fas fa-user-graduate"></i> <span id="usernameDisplay"></span></span>
                <button class="btn-logout" id="logoutBtn">‡§≤‡•â‡§ó‡§Ü‡§â‡§ü</button>
            </div>
        </div>
    </header>
    <div id="google_translate_element" style="margin: 5px auto; text-align: center;"></div>

    <!-- login area -->
    <div id="loginArea" class="login-card">
        <h2><i class="fas fa-lock"></i> <span id="loginHeading">‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂</span></h2>
        <label for="loginUsername" class="visually-hidden">‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ</label>
        <input type="text" id="loginUsername" placeholder="‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ (‡§ú‡•à‡§∏‡•á: ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ)" value="‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ">
        <label for="loginPassword" class="visually-hidden">‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</label>
        <input type="password" id="loginPassword" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°" value="123">
        <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button class="btn btn-primary" id="loginBtn" style="background:var(--primary);border:none;color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-sign-in-alt"></i> <span id="loginBtnText">‡§≤‡•â‡§ó‡§ø‡§®</span></button>
            <button class="btn" id="signupBtn" style="background:var(--dark);color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-user-plus"></i> <span id="signupBtnText">‡§∏‡§æ‡§á‡§®‡§Ö‡§™</span></button>
        </div>
        <p style="margin-top:15px;">üîë admin/admin (‡§è‡§°‡§Æ‡§ø‡§®)  |  ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ/123 (‡§°‡•á‡§Æ‡•ã)</p>
    </div>

    <!-- main dashboard -->
    <div id="dashboardArea" style="display: none;">
        <!-- ‡§®‡§Ø‡§æ ‡§á‡§Ç‡§∏‡•ç‡§ü‡•Ä‡§ü‡•ç‡§Ø‡•Ç‡§ü ‡§∏‡•á‡§≤‡•á‡§ï‡•ç‡§∂‡§® ‡§∏‡•á‡§ï‡•ç‡§∂‡§® (‡§∏‡•ç‡§ï‡•á‡§ö 1) -->
        <div class="institution-card" id="institutionSelector">
            <h3 style="color:var(--primary); margin-bottom: 15px;"><i class="fas fa-university"></i> <span id="instHeading">‡§Ö‡§™‡§®‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç</span></h3>
            <div class="institution-grid">
                <div class="institution-item">
                    <label id="instTypeLabel">University / School</label>
                    <select id="instTypeSelect">
                        <option value="school">School (The Union Academy)</option>
                        <option value="college">College (Shivaji College)</option>
                    </select>
                </div>
                <div class="institution-item">
                    <label id="collegeLabel">College (‡§Ø‡§¶‡§ø ‡§≤‡§æ‡§ó‡•Ç)</label>
                    <select id="collegeSelect">
                        <option value="shivaji">‡§∂‡§ø‡§µ‡§æ‡§ú‡•Ä ‡§ï‡•â‡§≤‡•á‡§ú (‡§¶‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§µ‡§ø‡§∂‡•ç‡§µ‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§≤‡§Ø)</option>
                        <option value="ramjas">‡§∞‡§æ‡§Æ‡§ú‡§∏ ‡§ï‡•â‡§≤‡•á‡§ú</option>
                        <option value="hindu">‡§π‡§ø‡§Ç‡§¶‡•Ç ‡§ï‡•â‡§≤‡•á‡§ú</option>
                    </select>
                </div>
                <div class="institution-item">
                    <label id="courseLabel">Course / ‡§ï‡§ï‡•ç‡§∑‡§æ</label>
                    <select id="courseSelect">
                        <option value="12">‡§ï‡§ï‡•ç‡§∑‡§æ 12 (‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®)</option>
                        <option value="11">‡§ï‡§ï‡•ç‡§∑‡§æ 11</option>
                        <option value="bsc">B.Sc (‡§≠‡•å‡§§‡§ø‡§ï‡•Ä)</option>
                    </select>
                </div>
                <div>
                    <button class="fill-next-btn" id="fillNextBtn"><span id="fillNextText">Fill Next ‚û§</span></button>
                </div>
            </div>
        </div>

        <!-- AI ‡§á‡§Ç‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§ï‡•ç‡§∂‡§® (‡§™‡§π‡§≤‡•á ‡§ú‡•à‡§∏‡§æ) -->
        <div class="ai-intro">
            <div class="intro-card">
                <h2 id="introHeading">What is Artificial Intelligence?</h2>
                <p id="introText"><strong>Artificial Intelligence (AI)</strong> simulates human intelligence in machines.</p>
                <ul class="ai-features">
                    <li id="feature1"><i class="fas fa-brain"></i> <strong>Narrow AI:</strong> Specific tasks.</li>
                    <li id="feature2"><i class="fas fa-rocket"></i> <strong>General AI:</strong> Human-level.</li>
                </ul>
            </div>
        </div>

        <div class="container-main">
            <!-- ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡§Ø‡§® (‡§™‡•Å‡§∞‡§æ‡§®‡§æ) ‡§Ö‡§¨ institution ‡§∏‡•á sync ‡§π‡•ã‡§ó‡§æ -->
            <h3 class="section-title" id="classTitle"><i class="fas fa-graduation-cap"></i> ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
            <div class="class-grid" id="classGrid">
                <button class="class-btn" data-class="9" id="class9">‡§ï‡§ï‡•ç‡§∑‡§æ 9</button>
                <button class="class-btn" data-class="10" id="class10">‡§ï‡§ï‡•ç‡§∑‡§æ 10</button>
                <button class="class-btn" data-class="11" id="class11">‡§ï‡§ï‡•ç‡§∑‡§æ 11</button>
                <button class="class-btn active" data-class="12" id="class12">‡§ï‡§ï‡•ç‡§∑‡§æ 12</button>
            </div>
            <h3 class="section-title" id="subjectTitle"><i class="fas fa-book-open"></i> ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
            <div class="subject-grid" id="subjectGrid">
                <button class="sub-btn active" data-subject="physics" id="subPhysics">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</button>
                <button class="sub-btn" data-subject="chemistry" id="subChemistry">‡§∞‡§∏‡§æ‡§Ø‡§®</button>
                <button class="sub-btn" data-subject="maths" id="subMaths">‡§ó‡§£‡§ø‡§§</button>
                <button class="sub-btn" data-subject="biology" id="subBiology">‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®</button>
            </div>

            <!-- ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§° (‡§°‡§æ‡§Ø‡§®‡§æ‡§Æ‡§ø‡§ï) -->
            <div class="notes-card" id="notesCard">
                <h3><i class="fas fa-sticky-note"></i> <span id="subjectName">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</span> - <span id="notesLabel">‡§Æ‡•Ç‡§≤ ‡§®‡•ã‡§ü‡•ç‡§∏</span></h3>
                <div id="notesContent" style="white-space: pre-line;"></div>
                <div id="biologyDiagram" class="heart-diagram" style="display:none;">
                    <h4 style="color: var(--primary);">‚ù§Ô∏è <span id="heartTitle">‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ</span></h4>
                    <div class="heart-chambers">
                        <div class="chamber" id="chamberRA">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Right Atrium)</small></div>
                        <div class="chamber" id="chamberLA">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Left Atrium)</small></div>
                        <div class="chamber" id="chamberRV">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Right Ventricle)</small></div>
                        <div class="chamber" id="chamberLV">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Left Ventricle)</small></div>
                    </div>
                    <p id="saNodeText"><i class="fas fa-arrow-right"></i> SA ‡§®‡•ã‡§° ‡§¶‡§æ‡§è‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ ‡§Æ‡•á‡§Ç</p>
                </div>
                <!-- ‡§á‡§Ç‡§ü‡§∞‡§è‡§ï‡•ç‡§ü‡§ø‡§µ ‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞ (‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏/‡§ï‡•á‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è) -->
                <div id="physicsDiagram" class="interactive-diagram" style="display:none;">‚öõÔ∏è ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§ï‡§æ ‡§Ü‡§∞‡•á‡§ñ (‡§á‡§Ç‡§ü‡§∞‡§è‡§ï‡•ç‡§ü‡§ø‡§µ)</div>
                <div id="chemistryDiagram" class="interactive-diagram" style="display:none;">üß™ ‡§∞‡§æ‡§∏‡§æ‡§Ø‡§®‡§ø‡§ï ‡§Ö‡§≠‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ä‡§∞‡•ç‡§ú‡§æ ‡§Ü‡§∞‡•á‡§ñ</div>
            </div>

            <!-- AI ‡§ü‡•Ç‡§≤‡•ç‡§∏ (‡§â‡§®‡•ç‡§®‡§§) -->
            <div class="ai-card">
                <h3 style="color:var(--primary);"><i class="fas fa-microchip"></i> <span id="aiHelperTitle">AI ‡§∏‡§π‡§æ‡§Ø‡§ï ‚Äì ‡§Ö‡§™‡§®‡§æ ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç</span></h3>
                <div class="input-row">
                    <input type="text" id="topicInput" placeholder="‡§ú‡•à‡§∏‡•á: ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ, ‡§π‡•É‡§¶‡§Ø, ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£..." value="‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">
                    <button class="btn btn-primary" id="generateBtn" style="background:var(--primary);border:none;color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-magic"></i> <span id="summaryBtn">‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</span></button>
                    <button class="btn btn-icon" id="improveBtn" style="background:var(--dark);color:white;padding:12px;border-radius:40px;" title="‡§Ü‡§∏‡§æ‡§® ‡§Æ‡•ã‡§°"><i class="fas fa-smile"></i></button>
                    <button class="btn btn-icon" id="voiceSearchBtn" style="background:var(--dark);color:white;padding:12px;border-radius:40px;" title="‡§µ‡•â‡§á‡§∏ ‡§∏‡§∞‡•ç‡§ö"><i class="fas fa-microphone-alt"></i></button>
                </div>
                <!-- ‡§ö‡•à‡§™‡•ç‡§ü‡§∞ ‡§®‡•á‡§µ‡§ø‡§ó‡•á‡§∂‡§® (‡§®‡§Ø‡§æ) -->
                <div class="chapter-nav" id="chapterNav">
                    <button class="chapter-btn active" data-chapter="1">‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 1</button>
                    <button class="chapter-btn" data-chapter="2">‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 2</button>
                    <button class="chapter-btn" data-chapter="3">‡§Ö‡§ß‡•ç‡§Ø‡§æ‡§Ø 3</button>
                </div>
                <!-- ‡§´‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ -->
                <div class="file-zone" id="fileDropZone">
                    <i class="fas fa-cloud-upload-alt" style="font-size:2rem; color:var(--primary);"></i>
                    <div style="flex:1;" id="fileZoneText">‡§´‡•ã‡§ü‡•ã/PDF/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç</div>
                    <label for="fileUpload" class="btn" style="background:var(--primary); color:white; padding:10px 22px; border-radius:40px;"><i class="fas fa-folder-open"></i> <span id="browseBtn">‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç</span></label>
                    <input type="file" id="fileUpload" hidden accept="image/*,application/pdf,video/*,.txt">
                </div>
                <div id="fileInfoArea" class="file-info" style="display:none; margin-top:10px;">
                    <i class="fas fa-file"></i> <span id="fileName"></span> <span id="fileSize"></span>
                    <button class="clear-file" id="clearFileBtn" style="background:none;border:none;color:red;"><i class="fas fa-times-circle"></i></button>
                </div>
                <div class="progress-bar" id="ocrProgress"><div class="progress-fill" id="ocrProgressFill"></div></div>
                <div class="preview-container" style="display: flex; gap:10px; margin-top:10px;">
                    <div class="preview-box" id="imgPreviewBox"><img id="previewImg" src="#"></div>
                    <div class="preview-box" id="videoPreviewBox"><video id="videoPreview" controls></video></div>
                </div>

                <!-- ‡§®‡§Ø‡§æ: AI ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§§‡•Ä‡§® ‡§ü‡•à‡§¨‡•ç‡§∏ ‡§Æ‡•á‡§Ç -->
                <div class="ai-output-tabs">
                    <div class="ai-output-tab active" data-panel="summary">üìÑ <span id="tabSummary">‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</span></div>
                    <div class="ai-output-tab" data-panel="notes">üìù <span id="tabNotes">‡§®‡•ã‡§ü‡•ç‡§∏</span></div>
                    <div class="ai-output-tab" data-panel="tricks">‚ú® <span id="tabTricks">‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏</span></div>
                </div>
                <div id="outputSummary" class="ai-output-panel active"></div>
                <div id="outputNotes" class="ai-output-panel"></div>
                <div id="outputTricks" class="ai-output-panel"></div>
            </div>

            <!-- ‡§µ‡•à‡§¶‡§ø‡§ï ‡§ó‡§£‡§ø‡§§ ‡§ï‡§æ‡§∞‡•ç‡§° (‡§®‡§Ø‡§æ) -->
            <div class="vedic-card">
                <h3 style="color:var(--primary); display: flex; align-items: center; gap: 10px;"><i class="fas fa-calculator"></i> <span id="vedicTitle">‡§µ‡•à‡§¶‡§ø‡§ï ‡§ó‡§£‡§ø‡§§ (Vedic Math)</span></h3>
                <div class="vedic-trick" id="vedicTrickDisplay">
                    <strong>‡§ü‡•ç‡§∞‡§ø‡§ï:</strong> ‡§è‡§ï‡§æ‡§ß‡§ø‡§ï‡•á‡§® ‡§™‡•Ç‡§∞‡•ç‡§µ‡•á‡§£ ‚Äî 9 ‡§ï‡•Ä ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§∏‡•á ‡§ó‡•Å‡§£‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§∏‡•Ç‡§§‡•ç‡§∞‡•§
                </div>
                <div class="vedic-calculator">
                    <input type="text" id="vedicInput" placeholder="‡§ú‡•à‡§∏‡•á 9√ó9 ‡§Ø‡§æ 8√ó7" value="9√ó9">
                    <button id="vedicCalcBtn"><i class="fas fa-bolt"></i> <span id="vedicCalcText">‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç</span></button>
                </div>
                <div id="vedicResult" style="margin-top: 15px; font-size: 1.2rem;">‡§™‡§∞‡§ø‡§£‡§æ‡§Æ: 81</div>
            </div>

            <!-- ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§≠‡§æ‡§ó -->
            <div class="video-section">
                <h3 style="color:var(--primary);"><i class="fas fa-video"></i> <span id="videoTitle">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡§∞)</span></h3>
                <div class="mock-player" id="videoPlaceholder">
                    <i class="fas fa-play-circle" style="font-size:3rem; color:var(--primary);"></i>
                    <p id="videoMessage">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å' ‡§¶‡§¨‡§æ‡§è‡§Å</p>
                </div>
                <div class="flex-row" style="display:flex; gap:10px; justify-content:center;">
                    <button class="btn" id="playVideoBtn" style="background:var(--primary);color:white;border:none;padding:12px 25px;border-radius:40px;"><i class="fas fa-play"></i> <span id="playBtn">AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å</span></button>
                    <button class="btn" id="requestVideoBtn" style="background:var(--dark);color:white;border:none;padding:12px 25px;border-radius:40px;"><i class="fas fa-cloud-upload-alt"></i> <span id="requestBtn">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç</span></button>
                </div>
            </div>

            <!-- ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (RRB NTPC ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤, PYQs ‡§ï‡•á ‡§∏‡§æ‡§•) -->
            <div class="test-card" id="mockTest">
                <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
                    <h3><i class="fas fa-pencil-alt"></i> <span id="testTitle">‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (RRB NTPC)</span> <span class="pyq-badge">PYQ</span></h3>
                    <div class="timer" id="timer" style="background:var(--primary); padding:8px 20px; border-radius:40px;">02:00</div>
                </div>
                <div id="testArea">
                    <div id="questionText" style="margin:15px 0;">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                    <div class="options-grid" id="optionsContainer"></div>
                    <div class="test-footer" style="display:flex; gap:10px; justify-content:center;">
                        <button class="btn" id="prevBtn" disabled><i class="fas fa-arrow-left"></i> <span id="prevText">‡§™‡§ø‡§õ‡§≤‡§æ</span></button>
                        <button class="btn" id="nextBtn"><span id="nextText">‡§Ö‡§ó‡§≤‡§æ</span> <i class="fas fa-arrow-right"></i></button>
                        <button class="btn btn-primary" id="submitTest"><span id="submitText">‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç</span></button>
                    </div>
                </div>
                <div id="testResult" class="result-box" style="background:var(--primary); border-radius:20px; padding:20px; margin-top:20px; display:none;"></div>
            </div>

            <!-- ‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï (‡§™‡•Å‡§∞‡§æ‡§®‡§æ) -->
            <h3 class="section-title"><i class="fas fa-notebook"></i> <span id="notebookTitle">‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï</span></h3>
            <div class="category-filter">...</div> <!-- ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§õ‡•ã‡§°‡§º‡§æ, ‡§™‡•Ç‡§∞‡§æ ‡§ï‡•ã‡§° ‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ ‡§π‡•Ä ‡§∞‡§π‡•á‡§ó‡§æ -->
            <!-- ‡§¨‡§æ‡§ï‡•Ä ‡§∏‡§¨ ‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ ‡§π‡•Ä ... -->
            <div style="margin-bottom: 15px;">
                <input type="text" id="noteSearchInput" placeholder="üîç ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç..." style="width:100%; padding:12px 20px; border-radius:40px; border:2px solid var(--primary);">
            </div>
            <div class="notebook-grid" id="notebookList"></div>
            <div style="display: flex; gap:10px; margin-top:15px;">
                <input type="text" id="newNoteText" placeholder="‡§®‡§Ø‡§æ ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç..." style="flex:1; padding:12px; border-radius:40px; border:2px solid var(--dark);">
                <select id="newNoteCategory" style="padding:12px; border-radius:40px; border:2px solid var(--dark);">
                    <option value="physics">‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏</option>
                    <option value="chemistry">‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</option>
                    <option value="biology">‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä</option>
                </select>
                <button class="btn btn-primary" id="addNoteBtn" style="background:var(--primary);border:none;color:white;padding:12px 20px;border-radius:40px;"><i class="fas fa-plus"></i> <span id="addBtn">‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span></button>
            </div>
            <button class="btn" id="exportNotesBtn" style="margin:15px 0;background:var(--dark);color:white;border:none;padding:10px 20px;border-radius:40px;"><i class="fas fa-download"></i> <span id="exportBtn">‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</span></button>

            <!-- ‡§á‡§§‡§ø‡§π‡§æ‡§∏ -->
            <h3 class="section-title"><i class="fas fa-history"></i> <span id="historyTitle">‡§Æ‡•á‡§∞‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏</span></h3>
            <div id="historyList" class="history-list"></div>

            <!-- ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ -->
            <div id="adminPanel" style="display: none; margin-top: 25px; border-top: 3px dashed var(--primary); padding-top: 20px;">
                <h3 class="section-title"><i class="fas fa-check-double"></i> <span id="adminTitle">‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï : ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß</span></h3>
                <div id="requestList"></div>
            </div>

            <!-- ‡§ü‡•ã‡§∏‡•ç‡§ü -->
            <div class="toast" id="toast"></div>
        </div> <!-- container-main end -->
    </div> <!-- dashboard end -->
    <div class="footer">‡§≤‡§æ‡§≤ & ‡§ï‡§æ‡§≤‡§æ ‡§•‡•Ä‡§Æ ¬∑ ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è AI ‡§∏‡•ç‡§ü‡§°‡•Ä ‡§™‡•ç‡§∞‡•ã</div>
</div>

<!-- ‡§ó‡•Ç‡§ó‡§≤ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§≤‡•á‡§ü ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü -->
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'hi'}, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- ‡§∏‡§æ‡§∞‡§æ ‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü (‡§®‡§è ‡§´‡•Ä‡§ö‡§∞‡•ç‡§∏ ‡§ï‡•á ‡§∏‡§æ‡§•) -->
<script>
(function() {
    // ==================== ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú (‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ) ====================
    const USERS_KEY = 'studyDost_users';
    const CURRENT_USER_KEY = 'studyDost_currentUser';
    const HISTORY_KEY = 'studyDost_history';
    const REQUESTS_KEY = 'studyDost_videoRequests';

    function getNotesKey() { return currentUser ? `notes_${currentUser.username}` : 'notes_default'; }

    if (!localStorage.getItem(USERS_KEY)) {
        localStorage.setItem(USERS_KEY, JSON.stringify([
            { username: '‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ', password: '123' },
            { username: '‡§∞‡§æ‡§π‡•Å‡§≤', password: '123' },
            { username: 'admin', password: 'admin' }
        ]));
    }
    if (!localStorage.getItem(REQUESTS_KEY)) localStorage.setItem(REQUESTS_KEY, JSON.stringify([]));
    if (!localStorage.getItem(HISTORY_KEY)) localStorage.setItem(HISTORY_KEY, JSON.stringify([]));

    // ==================== ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•à‡§∞‡§ø‡§è‡§¨‡§≤ ====================
    let currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY) || 'null');
    let selectedClass = '12';
    let selectedSubject = 'physics';
    let currentLang = 'hi';

    // ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (‡§Ö‡§¨ RRB NTPC ‡§ï‡•á ‡§™‡•ç‡§∞‡§∂‡•ç‡§®)
    const mockQuestions = [
        { question: '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§Æ‡•á‡§Ç ‡§ß‡§æ‡§§‡•Å ‡§∏‡•á ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§® ‡§â‡§§‡•ç‡§∏‡§∞‡•ç‡§ú‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à?', options: ['‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§§‡•Ä‡§µ‡•ç‡§∞‡§§‡§æ', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§∞‡§Ç‡§ó', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§ß‡•ç‡§∞‡•Å‡§µ‡§£'], answer: 1, pyq: 'RRB NTPC 2021' },
        { question: '‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞ ‡§ï‡•å‡§® ‡§∏‡§æ ‡§π‡•à?', options: ['AV ‡§®‡•ã‡§°', 'SA ‡§®‡•ã‡§°', '‡§¨‡§Ç‡§°‡§≤ ‡§ë‡§´ ‡§π‡§ø‡§ú', '‡§™‡§∞‡•ç‡§ï‡§ø‡§Ç‡§ú‡•Ä ‡§§‡§Ç‡§§‡•Å'], answer: 1, pyq: 'RRB Group D 2019' },
        { question: '‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ax¬≤+bx+c=0 ‡§ï‡•á ‡§Æ‡•Ç‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§Ø‡•ã‡§ó ‡§π‡•ã‡§§‡§æ ‡§π‡•à?', options: ['-b/a', 'b/a', 'c/a', '-c/a'], answer: 0, pyq: 'RRB NTPC 2020' },
        { question: '‡§®‡§ø‡§Æ‡•ç‡§® ‡§Æ‡•á‡§Ç ‡§∏‡•á ‡§ï‡•å‡§® ‡§∏‡§æ ‡§ó‡•ç‡§∞‡•Ä‡§®‡§π‡§æ‡§â‡§∏ ‡§ó‡•à‡§∏ ‡§®‡§π‡•Ä‡§Ç ‡§π‡•à?', options: ['CO‚ÇÇ', 'CH‚ÇÑ', 'N‚ÇÇO', 'O‚ÇÇ'], answer: 3, pyq: 'RRB JE 2019' }
    ];
    let currentQuestionIndex = 0, userAnswers = new Array(mockQuestions.length).fill(-1);
    let timerInterval, timeLeft = 120, testActive = false;

    // DOM ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏
    const loginArea = document.getElementById('loginArea');
    const dashboardArea = document.getElementById('dashboardArea');
    const userInfoDiv = document.getElementById('userInfo');
    const usernameSpan = document.getElementById('usernameDisplay');
    const toast = document.getElementById('toast');
    const notesContent = document.getElementById('notesContent');
    const subjectNameSpan = document.getElementById('subjectName');
    const biologyDiagram = document.getElementById('biologyDiagram');
    const physicsDiagram = document.getElementById('physicsDiagram');
    const chemistryDiagram = document.getElementById('chemistryDiagram');
    const videoMessage = document.getElementById('videoMessage');
    const adminPanel = document.getElementById('adminPanel');
    const requestListDiv = document.getElementById('requestList');
    const historyListDiv = document.getElementById('historyList');
    const notebookListDiv = document.getElementById('notebookList');
    const noteSearchInput = document.getElementById('noteSearchInput');
    const topicInput = document.getElementById('topicInput');
    const generateBtn = document.getElementById('generateBtn');
    const improveBtn = document.getElementById('improveBtn');
    const voiceSearchBtn = document.getElementById('voiceSearchBtn');
    const outputSummary = document.getElementById('outputSummary');
    const outputNotes = document.getElementById('outputNotes');
    const outputTricks = document.getElementById('outputTricks');
    const vedicInput = document.getElementById('vedicInput');
    const vedicCalcBtn = document.getElementById('vedicCalcBtn');
    const vedicResult = document.getElementById('vedicResult');
    const fillNextBtn = document.getElementById('fillNextBtn');

    // ‡§â‡§™‡§Ø‡•ã‡§ó‡§ø‡§§‡§æ
    function showToast(msg, type = 'success') {
        toast.style.display = 'block';
        toast.innerHTML = msg;
        toast.style.background = type === 'error' ? '#b71c1c' : (type === 'warning' ? '#b85e00' : '#1e1e1e');
        setTimeout(() => toast.style.display = 'none', 3000);
    }
    function saveCurrentUser(user) { currentUser = user; localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user)); }

    // ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§°‡•á‡§ü‡§æ
    const notesDatabase = {
        physics: '‚öõÔ∏è **‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ**: K_max = hf - œÜ‚ÇÄ\n‚Ä¢ ‡§®‡§ø‡§∞‡•ã‡§ß‡•Ä ‡§µ‡§ø‡§≠‡§µ V‚ÇÄ = (h/e)f - œÜ‚ÇÄ/e\n‚Ä¢ ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø: f‚ÇÄ = œÜ‚ÇÄ/h',
        chemistry: 'üß™ **‡§∞‡§æ‡§∏‡§æ‡§Ø‡§®‡§ø‡§ï ‡§¨‡§≤‡§ó‡§§‡§ø‡§ï‡•Ä**: ‡§Ö‡§≠‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§¶‡§∞, ‡§ï‡•ã‡§ü‡§ø, ‡§Ü‡§£‡§µ‡§ø‡§ï‡§§‡§æ‡•§\n‚Ä¢ ‡§™‡•ç‡§∞‡§•‡§Æ ‡§ï‡•ã‡§ü‡§ø: k = (2.303/t) log([R]‚ÇÄ/[R])',
        maths: 'üìê **‡§Ö‡§µ‡§ï‡§≤‡§®**: d/dx(sin x) = cos x, d/dx(cos x) = -sin x\n‚Ä¢ ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§®‡§ø‡§Ø‡§Æ',
        biology: 'üß¨ **‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø**: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑ ‚Äì ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø‡•§ SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞‡•§'
    };

    function updateNotesAndUI() {
        subjectNameSpan.innerText = (selectedSubject === 'physics' ? '‡§≠‡•å‡§§‡§ø‡§ï‡•Ä' : selectedSubject === 'chemistry' ? '‡§∞‡§∏‡§æ‡§Ø‡§®' : selectedSubject === 'maths' ? '‡§ó‡§£‡§ø‡§§' : '‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®');
        notesContent.innerText = notesDatabase[selectedSubject] || '‡§®‡•ã‡§ü‡•ç‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç';
        biologyDiagram.style.display = selectedSubject === 'biology' ? 'flex' : 'none';
        physicsDiagram.style.display = selectedSubject === 'physics' ? 'block' : 'none';
        chemistryDiagram.style.display = selectedSubject === 'chemistry' ? 'block' : 'none';
        addToHistory(selectedSubject);
        checkApprovedVideo(selectedSubject);
        renderNotebookFromStorage();
    }

    function addToHistory(subject) { /* ‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ */ if (!currentUser) return; let history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || []; history.push({ username: currentUser.username, subject, className: selectedClass, timestamp: new Date().toLocaleString('hi-IN') }); localStorage.setItem(HISTORY_KEY, JSON.stringify(history)); renderHistory(); }
    function renderHistory() { /* ‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ */ if (!currentUser) return; const history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || []; const userHistory = history.filter(h => h.username === currentUser.username).reverse().slice(0, 10); historyListDiv.innerHTML = userHistory.length ? userHistory.map(h => `<div class="history-item"><span><i class="fas fa-book"></i> ${h.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${h.className})</span><span class="badge">${h.timestamp}</span></div>`).join('') : '<div class="history-item">‡§ï‡•ã‡§à ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç</div>'; }
    function requestVideo() { if (!currentUser) return; const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || []; requests.push({ username: currentUser.username, subject: selectedSubject, className: selectedClass, approved: false, timestamp: new Date().toLocaleString() }); localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests)); showToast('‚úÖ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ'); if (currentUser.username === 'admin') renderRequests(); }
    function renderRequests() { const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || []; const pending = requests.filter(r => !r.approved); requestListDiv.innerHTML = pending.length ? pending.map((r, idx) => `<div class="request-item"><span>${r.username} - ${r.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${r.className})</span><button class="btn" onclick="window.approveRequest(${idx})" style="padding:4px 16px; background:var(--primary); color:white; border:none; border-radius:40px;">‡§Æ‡§Ç‡§ú‡•Ç‡§∞ ‡§ï‡§∞‡•á‡§Ç</button></div>`).join('') : '<div class="history-item">‡§ï‡•ã‡§à ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç</div>'; }
    window.approveRequest = function(pendingIdx) { const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || []; let count = -1; for (let i=0; i<requests.length; i++) { if (!requests[i].approved) count++; if (count === pendingIdx) { requests[i].approved = true; break; } } localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests)); showToast('‚úÖ ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§ø‡§§'); renderRequests(); checkApprovedVideo(selectedSubject); };
    function checkApprovedVideo(subject) { if (!currentUser) return; const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || []; const approved = requests.find(r => r.subject === subject && r.className === selectedClass && r.approved); videoMessage.innerHTML = approved ? '<span style="color:lightgreen;">‚úÖ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§â‡§™‡§≤‡§¨‡•ç‡§ß! ‡§ö‡§≤‡§æ‡§è‡§Å.</span>' : '‡§ï‡•ã‡§à ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§®‡§π‡•Ä‡§Ç‡•§'; }
    function playVideo() { const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || []; const approved = requests.find(r => r.subject === selectedSubject && r.className === selectedClass && r.approved); if (approved || (currentUser && currentUser.username === 'admin')) { videoMessage.innerHTML = 'üé¨ [AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã] ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à...'; showToast('üîä ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∂‡•Å‡§∞‡•Ç'); } else showToast('‚ùå ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç‡•§', 'error'); }

    // ‡§®‡§è AI ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü ‡§ü‡•à‡§¨‡•ç‡§∏
    document.querySelectorAll('.ai-output-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.ai-output-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.ai-output-panel').forEach(p => p.classList.remove('active'));
            this.classList.add('active');
            const panelId = this.dataset.panel;
            document.getElementById('output' + panelId.charAt(0).toUpperCase() + panelId.slice(1)).classList.add('active');
        });
    });

    function generateAISummary(topic) {
        let t = topic.toLowerCase();
        if (t.includes('‡§™‡•ç‡§∞‡§ï‡§æ‡§∂')) return "‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ: $$K_{\\text{max}} = hf - \\phi_0$$‡•§ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§";
        if (t.includes('‡§π‡•É‡§¶‡§Ø')) return "‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑, SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞, ‡§∞‡§ï‡•ç‡§§ ‡§™‡§Ç‡§™ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§";
        if (t.includes('‡§ó‡§£‡§ø‡§§')||t.includes('‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£')) return "‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£: $$x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$$";
        return `${topic} ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂: ‡§Ø‡§π ‡§ü‡•â‡§™‡§ø‡§ï ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§`;
    }
    function generateNotes(topic) { return "‡§µ‡§ø‡§∏‡•ç‡§§‡•É‡§§ ‡§®‡•ã‡§ü‡•ç‡§∏: " + topic + " ‡§ï‡•á ‡§¨‡§æ‡§∞‡•á ‡§Æ‡•á‡§Ç ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§¨‡§ø‡§Ç‡§¶‡•Å..."; }
    function generateTricks(topic) { return "‡§ü‡•ç‡§∞‡§ø‡§ï: " + topic + " ‡§ï‡•ã ‡§Ø‡§æ‡§¶ ‡§∞‡§ñ‡§®‡•á ‡§ï‡§æ ‡§Ü‡§∏‡§æ‡§® ‡§§‡§∞‡•Ä‡§ï‡§æ ‚Äî ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§∏‡§π‡§ø‡§§‡•§"; }

    function processAI() {
        const topic = topicInput.value.trim(); if (!topic) return;
        outputSummary.innerHTML = `<h3 style="color:var(--primary);">ü§ñ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</h3><p>${generateAISummary(topic)}</p>`;
        outputNotes.innerHTML = `<h3 style="color:var(--primary);">üìù ‡§®‡•ã‡§ü‡•ç‡§∏</h3><p>${generateNotes(topic)}</p>`;
        outputTricks.innerHTML = `<h3 style="color:var(--primary);">‚ú® ‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏</h3><p>${generateTricks(topic)}</p>`;
        if (window.renderMathInElement) renderMathInElement(outputSummary);
    }

    generateBtn.addEventListener('click', processAI);

    // ‡§µ‡•à‡§¶‡§ø‡§ï ‡§ï‡•à‡§≤‡§ï‡•Å‡§≤‡•á‡§ü‡§∞ (‡§∏‡§∞‡§≤ ‡§â‡§¶‡§æ‡§π‡§∞‡§£)
    vedicCalcBtn.addEventListener('click', function() {
        let expr = vedicInput.value.trim();
        try {
            if (expr.includes('√ó')) expr = expr.replace('√ó', '*');
            let result = eval(expr);
            vedicResult.innerText = `‡§™‡§∞‡§ø‡§£‡§æ‡§Æ: ${result} (‡§µ‡•à‡§¶‡§ø‡§ï ‡§ü‡•ç‡§∞‡§ø‡§ï: ‡§è‡§ï‡§æ‡§ß‡§ø‡§ï‡•á‡§® ‡§™‡•Ç‡§∞‡•ç‡§µ‡•á‡§£)`;
        } catch {
            vedicResult.innerText = '‡§ó‡§≤‡§§ ‡§á‡§®‡§™‡•Å‡§ü';
        }
    });

    // ‡§´‡§ø‡§≤ ‡§®‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡§ü‡§® (‡§∏‡•ç‡§ï‡•á‡§ö 1)
    fillNextBtn.addEventListener('click', function() {
        let instType = document.getElementById('instTypeSelect').value;
        let college = document.getElementById('collegeSelect').value;
        let course = document.getElementById('courseSelect').value;
        showToast(`‡§ö‡§Ø‡§®: ${instType}, ${college}, ${course} ‚Üí ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡•á‡§Ç`);
        // ‡§Ø‡§π‡§æ‡§Å ‡§Ü‡§™ ‡§°‡•à‡§∂‡§¨‡•ã‡§∞‡•ç‡§° ‡§ï‡•ã ‡§Ü‡§ó‡•á ‡§¨‡§¢‡§º‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç, ‡§ú‡•à‡§∏‡•á ‡§∏‡•ç‡§ï‡•ç‡§∞‡•â‡§≤ ‡§ï‡§∞‡§®‡§æ
        document.querySelector('.ai-intro').scrollIntoView({ behavior: 'smooth' });
    });

    // ‡§≠‡§æ‡§∑‡§æ ‡§ü‡•â‡§ó‡§≤ (‡§Ö‡§™‡§°‡•á‡§ü ‡§®‡§è ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è)
    window.toggleLanguage = function() {
        const toggle = document.getElementById('langToggle');
        const searchInput = document.getElementById('globalSearchInput');
        if (currentLang === 'hi') {
            currentLang = 'en';
            toggle.classList.add('eng');
            // English translations (‡§®‡§è ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏)
            document.getElementById('instHeading').innerText = 'Choose your Institute';
            document.getElementById('instTypeLabel').innerText = 'University / School';
            document.getElementById('collegeLabel').innerText = 'College (if applicable)';
            document.getElementById('courseLabel').innerText = 'Course / Class';
            document.getElementById('fillNextText').innerText = 'Fill Next ‚û§';
            document.getElementById('tabSummary').innerText = 'Summary';
            document.getElementById('tabNotes').innerText = 'Notes';
            document.getElementById('tabTricks').innerText = 'Tricks';
            document.getElementById('vedicTitle').innerText = 'Vedic Math';
            document.getElementById('vedicCalcText').innerText = 'Calculate';
            // ‡§¨‡§æ‡§ï‡•Ä ‡§™‡§ø‡§õ‡§≤‡•á ‡§µ‡§æ‡§≤‡•á...
        } else {
            currentLang = 'hi';
            toggle.classList.remove('eng');
            document.getElementById('instHeading').innerText = '‡§Ö‡§™‡§®‡§æ ‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§® ‡§ö‡•Å‡§®‡•á‡§Ç';
            document.getElementById('instTypeLabel').innerText = 'University / School';
            document.getElementById('collegeLabel').innerText = 'College (‡§Ø‡§¶‡§ø ‡§≤‡§æ‡§ó‡•Ç)';
            document.getElementById('courseLabel').innerText = 'Course / ‡§ï‡§ï‡•ç‡§∑‡§æ';
            document.getElementById('fillNextText').innerText = 'Fill Next ‚û§';
            document.getElementById('tabSummary').innerText = '‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂';
            document.getElementById('tabNotes').innerText = '‡§®‡•ã‡§ü‡•ç‡§∏';
            document.getElementById('tabTricks').innerText = '‡§ü‡•ç‡§∞‡§ø‡§ï‡•ç‡§∏';
            document.getElementById('vedicTitle').innerText = '‡§µ‡•à‡§¶‡§ø‡§ï ‡§ó‡§£‡§ø‡§§';
            document.getElementById('vedicCalcText').innerText = '‡§ó‡§£‡§®‡§æ ‡§ï‡§∞‡•á‡§Ç';
        }
        showToast(`Language: ${currentLang === 'hi' ? 'Hindi' : 'English'}`);
    };

    // ‡§≤‡•â‡§ó‡§ø‡§® / ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü (‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ)
    document.getElementById('loginBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const user = users.find(u => u.username === document.getElementById('loginUsername').value.trim() && u.password === document.getElementById('loginPassword').value.trim());
        if (user) { onLogin(user); } else showToast('‡§ó‡§≤‡§§ ‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°', 'error');
    });
    document.getElementById('signupBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const newU = document.getElementById('loginUsername').value.trim(); const newP = document.getElementById('loginPassword').value.trim();
        if (!newU || !newP) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡•á‡§Ç','error');
        if (users.find(u => u.username === newU)) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ ‡§Æ‡•å‡§ú‡•Ç‡§¶','error');
        users.push({ username: newU, password: newP }); localStorage.setItem(USERS_KEY, JSON.stringify(users)); showToast('‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§¨‡§®‡§æ, ‡§Ö‡§¨ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç');
    });
    function onLogin(user) {
        saveCurrentUser(user); usernameSpan.innerText = user.username; userInfoDiv.style.display = 'flex'; loginArea.style.display = 'none'; dashboardArea.style.display = 'block';
        if (user.username === 'admin') { adminPanel.style.display = 'block'; renderRequests(); } else adminPanel.style.display = 'none';
        updateNotesAndUI(); renderHistory(); renderNotebookFromStorage(); initMockTest();
    }
    document.getElementById('logoutBtn').addEventListener('click', () => { currentUser = null; localStorage.removeItem(CURRENT_USER_KEY); userInfoDiv.style.display = 'none'; loginArea.style.display = 'block'; dashboardArea.style.display = 'none'; });
    document.querySelectorAll('.class-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.class-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedClass = this.dataset.class; updateNotesAndUI();
    }));
    document.querySelectorAll('.sub-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.sub-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedSubject = this.dataset.subject; updateNotesAndUI();
    }));
    document.getElementById('playVideoBtn').addEventListener('click', playVideo);
    document.getElementById('requestVideoBtn').addEventListener('click', requestVideo);

    // ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ‡§´‡§Ç‡§ï‡•ç‡§∂‡§®
    function initMockTest() {
        currentQuestionIndex = 0; userAnswers.fill(-1); timeLeft = 120; testActive = true;
        document.getElementById('submitTest').style.display = 'inline-flex';
        document.getElementById('testResult').style.display = 'none';
        startTimer(); showQuestion();
    }
    function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--; let mins = Math.floor(timeLeft/60), secs = timeLeft%60;
            document.getElementById('timer').innerText = `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            if (timeLeft <= 0) { clearInterval(timerInterval); submitMockTest(); }
        },1000);
    }
    function showQuestion() {
        if (!testActive) return;
        let q = mockQuestions[currentQuestionIndex];
        document.getElementById('questionText').innerHTML = `<strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${currentQuestionIndex+1}/${mockQuestions.length}:</strong> ${q.question} <span class="pyq-badge">${q.pyq || ''}</span>`;
        let opts = '';
        q.options.forEach((opt, idx) => {
            opts += `<div class="opt-btn ${userAnswers[currentQuestionIndex] === idx ? 'selected' : ''}" onclick="selectOption(${idx})">${String.fromCharCode(65+idx)}. ${opt}</div>`;
        });
        document.getElementById('optionsContainer').innerHTML = opts;
        document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
        document.getElementById('nextBtn').disabled = currentQuestionIndex === mockQuestions.length-1;
    }
    window.selectOption = function(idx) { if (!testActive) return; userAnswers[currentQuestionIndex] = idx; showQuestion(); };
    document.getElementById('prevBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex>0) { currentQuestionIndex--; showQuestion(); } });
    document.getElementById('nextBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex < mockQuestions.length-1) { currentQuestionIndex++; showQuestion(); } });
    document.getElementById('submitTest')?.addEventListener('click', submitMockTest);
    function submitMockTest() {
        clearInterval(timerInterval); testActive = false;
        let correct = userAnswers.reduce((acc, ans, i) => acc + (ans === mockQuestions[i].answer ? 1 : 0), 0);
        let percent = (correct / mockQuestions.length) * 100;
        document.getElementById('testResult').innerHTML = `<h3>‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h3><p>‡§∏‡§π‡•Ä: ${correct}/${mockQuestions.length} (${percent.toFixed(1)}%)</p><button class="btn" onclick="initMockTest()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏</button>`;
        document.getElementById('testResult').style.display = 'block';
        document.getElementById('submitTest').style.display = 'none';
    }

    // ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® (‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§)
    function getNotes() { return JSON.parse(localStorage.getItem(getNotesKey()) || '[]'); }
    function saveNotes(notes) { localStorage.setItem(getNotesKey(), JSON.stringify(notes)); }
    function renderNotebookFromStorage(cat = 'all') {
        let notes = getNotes();
        const searchTerm = noteSearchInput ? noteSearchInput.value.toLowerCase() : '';
        let filtered = cat === 'all' ? notes : notes.filter(n => n.category === cat);
        if (searchTerm) filtered = filtered.filter(n => n.text.toLowerCase().includes(searchTerm));
        filtered.sort((a,b) => b.timestamp - a.timestamp);
        notebookListDiv.innerHTML = filtered.length ? filtered.map(n => `<div class="note-item"><span><i class="fas fa-${n.category==='physics'?'atom':(n.category==='chemistry'?'flask':'dna')}"></i> ${n.text}</span><button class="delete-note" onclick="deleteNote('${n.id}')"><i class="fas fa-trash"></i></button></div>`).join('') : '<div class="note-item">‡§ï‡•ã‡§à ‡§®‡•ã‡§ü ‡§®‡§π‡•Ä‡§Ç</div>';
    }
    window.deleteNote = (id) => { let notes = getNotes(); notes = notes.filter(n => n.id !== id); saveNotes(notes); const activeCat = document.querySelector('.cat-btn.active')?.dataset.cat || 'all'; renderNotebookFromStorage(activeCat); };
    document.getElementById('addNoteBtn')?.addEventListener('click', () => {
        const text = document.getElementById('newNoteText').value.trim();
        const category = document.getElementById('newNoteCategory').value;
        if (!text) { showToast('‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç', 'error'); return; }
        let notes = getNotes();
        notes.push({ id: 'note_' + Date.now() + Math.random(), text: text, category: category, timestamp: Date.now() });
        saveNotes(notes);
        document.getElementById('newNoteText').value = '';
        renderNotebookFromStorage(document.querySelector('.cat-btn.active')?.dataset.cat || 'all');
        showToast('‚úÖ ‡§®‡•ã‡§ü ‡§ú‡•Å‡§°‡§º ‡§ó‡§Ø‡§æ');
    });
    document.querySelectorAll('.cat-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.cat-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active');
        renderNotebookFromStorage(this.dataset.cat);
    }));

    // ‡§ë‡§ü‡•ã-‡§∏‡•ç‡§ü‡§æ‡§∞‡•ç‡§ü ‡§Ö‡§ó‡§∞ ‡§Ø‡•Ç‡§ú‡§∞ ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•à
    if (currentUser) onLogin(currentUser);
})();
</script>
<!-- ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ‡§ï‡•á ‡§õ‡•Ç‡§ü‡•á ‡§π‡•Å‡§è ‡§ü‡•à‡§¨‡•ç‡§∏ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§Æ‡•Ä (‡§™‡•Ç‡§∞‡§æ ‡§ï‡•ã‡§° ‡§™‡§ø‡§õ‡§≤‡•á ‡§ú‡•à‡§∏‡§æ ‡§∞‡§π‡•á‡§ó‡§æ) -->
<div style="display:none;">All tabs integrated</div>
</body>
</html>