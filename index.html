<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vivek AI Â· Self-Checking Core</title>
    <style>
        :root { --primary: #00ff88; --bg: #05070a; --card: #12161f; --text: #e6edf3; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background: var(--bg); color: var(--text); padding: 15px; }

        /* Diagnostic Overlay */
        #check-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: var(--bg); z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.5s; }
        .spinner { border: 4px solid rgba(255,255,255,0.1); border-top: 4px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        .diag-text { font-family: monospace; font-size: 0.9rem; color: var(--primary); }

        .dashboard { max-width: 1000px; margin: auto; display: flex; flex-direction: column; gap: 20px; opacity: 0; pointer-events: none; transition: 0.5s; }
        .ready { opacity: 1 !important; pointer-events: all !important; }

        .panel { background: var(--card); border: 1px solid #30363d; border-radius: 16px; padding: 25px; flex: 2; }
        textarea { width: 100%; background: #010409; border: 1px solid #333; border-radius: 10px; padding: 15px; color: white; margin-bottom: 15px; resize: none; border-left: 4px solid var(--primary); }
        .btn { width: 100%; background: var(--primary); color: #000; border: none; padding: 18px; border-radius: 10px; font-weight: bold; cursor: pointer; }
    </style>
</head>
<body>

<div id="check-overlay">
    <div class="spinner"></div>
    <div class="diag-text" id="diag-msg">INITIALIZING VIVEK AI CORE...</div>
    <div style="font-size: 0.7rem; color: #555; margin-top: 10px;">Checking API Nodes & Model Health</div>
</div>

<div class="dashboard" id="main-ui">
    <div class="panel">
        <h3 style="margin-bottom: 15px;">ðŸš€ Core Learning Interface</h3>
        <textarea id="studyQuery" rows="5" placeholder="à¤…à¤¬ à¤†à¤ª à¤¸à¤µà¤¾à¤² à¤ªà¥‚à¤› à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚ (à¤œà¥ˆà¤¸à¥‡: Magnetism and Matter)..."></textarea>
        <button class="btn" onclick="startAnalysis()" id="mainBtn">ANALYZE KNOWLEDGE</button>
        <div id="resBox" style="margin-top:20px; padding:15px; background:#010409; border-radius:10px; border:1px solid #333; display:none; line-height:1.7;">
            <div id="resText"></div>
        </div>
    </div>

    <div class="panel" style="flex: 1; text-align: center; height: fit-content;">
        <div style="font-size: 3.5rem;" id="avatar">ðŸ‘¶</div>
        <h4 id="rankName" style="color: #ffd700; margin: 10px 0;">RANK: NEW BORN</h4>
        <div style="background: #161b22; padding: 15px; border-radius: 10px;">
            <div style="font-size: 1.8rem; font-weight: 800; color: var(--primary);" id="topicCount">0</div>
            <small>Topics Mastered</small>
        </div>
    </div>
</div>

<script>
    const V_KEY = "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";
    const MODELS = ["google/gemini-2.0-flash-lite-preview-02-05:free", "deepseek/deepseek-r1:free"];

    // 1. Boot-up Diagnostic (Auto-Checking)
    async function runDiagnostics() {
        const msg = document.getElementById('diag-msg');
        const overlay = document.getElementById('check-overlay');
        const ui = document.getElementById('main-ui');

        try {
            msg.innerText = "> CHECKING API KEY STATUS...";
            await new Promise(r => setTimeout(r, 1500)); // Simulating check

            msg.innerText = "> VERIFYING MODEL ENDPOINTS...";
            const res = await fetch("https://openrouter.ai/api/v1/models");
            
            if(res.ok) {
                msg.innerText = "> SYSTEM OPTIMIZED: ALL GREEN âœ“";
                await new Promise(r => setTimeout(r, 1000));
                overlay.style.opacity = '0';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    ui.classList.add('ready');
                }, 500);
            } else {
                throw new Error("Connection Refused");
            }
        } catch (e) {
            msg.style.color = "#ff4444";
            msg.innerText = "> ERROR: AUTO-HEALING IN PROGRESS...";
            // Auto-heal logic
            setTimeout(runDiagnostics, 3000);
        }
    }

    // 2. Main Analysis Logic
    async function startAnalysis() {
        const query = document.getElementById('studyQuery').value.trim();
        const btn = document.getElementById('mainBtn');
        const resBox = document.getElementById('resBox');
        if(!query) return;

        btn.disabled = true;
        btn.innerText = "THINKING...";

        for(let model of MODELS) {
            try {
                const res = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                    method: "POST",
                    headers: { "Authorization": `Bearer ${V_KEY}`, "Content-Type": "application/json" },
                    body: JSON.stringify({ "model": model, "messages": [{"role": "user", "content": query}] })
                });
                const data = await res.json();
                if(res.ok) {
                    document.getElementById('resText').innerText = data.choices[0].message.content;
                    resBox.style.display = 'block';
                    saveProgress(query);
                    break;
                }
            } catch (e) { console.log("Rerouting..."); }
        }
        btn.disabled = false;
        btn.innerText = "ANALYZE DATA";
    }

    function saveProgress(q) {
        let brain = JSON.parse(localStorage.getItem('v_v4_diag') || '[]');
        brain.push(q);
        localStorage.setItem('v_v4_diag', JSON.stringify(brain));
        updateUI();
    }

    function updateUI() {
        const brain = JSON.parse(localStorage.getItem('v_v4_diag') || '[]');
        document.getElementById('topicCount').innerText = brain.length;
        if(brain.length >= 5) {
            document.getElementById('rankName').innerText = "RANK: ANALYST";
            document.getElementById('avatar').innerText = "ðŸ‘¦";
        }
    }

    window.onload = () => { updateUI(); runDiagnostics(); };
</script>
</body>
</html>
