<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üë∂ Vivek AI ¬∑ ‡§¨‡§æ‡§≤‡§ï ‡§∏‡•á ‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞ ‡§§‡§ï</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, sans-serif;
        }

        body {
            background: #0a0c0f;
            color: #e0e0e0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .container {
            max-width: 950px;
            width: 100%;
            margin: auto;
        }

        /* card style */
        .glass-card {
            background: rgba(20, 22, 27, 0.95);
            backdrop-filter: blur(8px);
            border: 1px solid #2a2f3a;
            border-radius: 2rem;
            padding: 1.8rem 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8), 0 0 0 1px rgba(255, 70, 70, 0.15) inset;
            transition: box-shadow 0.2s;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            background: linear-gradient(130deg, #ff8a8a, #ffd966, #a3c9ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 0.3rem;
            text-shadow: 0 0 20px rgba(255, 100, 100, 0.3);
        }

        .subhead {
            color: #aaa;
            margin-bottom: 2rem;
            border-bottom: 1px dashed #333;
            padding-bottom: 0.7rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        /* evolution panel */
        .evolution-panel {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 2rem;
        }

        .stage-badge {
            background: #2d2010;
            color: #fbbf24;
            padding: 0.5rem 2rem;
            border-radius: 40px;
            font-weight: 600;
            letter-spacing: 1px;
            border: 1px solid #f59e0b50;
            font-size: 0.9rem;
            display: inline-block;
            margin-bottom: 1rem;
        }

        .avatar {
            font-size: 6rem;
            line-height: 1;
            filter: drop-shadow(0 8px 20px #ff333380);
            transition: transform 0.3s ease;
        }
        .avatar:hover { transform: scale(1.05); }

        .dna-bar {
            width: 100%;
            height: 8px;
            background: #222;
            border-radius: 20px;
            margin: 1.2rem 0 0.8rem;
            overflow: hidden;
        }
        .dna-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #ff9966, #ff5e62);
            border-radius: 20px;
            transition: width 0.4s ease;
            box-shadow: 0 0 15px #ff5e62;
        }

        .brain-stats {
            display: flex;
            justify-content: space-between;
            width: 100%;
            font-size: 0.95rem;
            color: #ccc;
            margin-top: 0.3rem;
        }
        .brain-count {
            color: #fbbf24;
            font-weight: 700;
            font-size: 1.2rem;
        }

        /* form row */
        .form-row {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin: 1.8rem 0;
        }

        select, textarea {
            background: #1e2128;
            border: 1px solid #333a47;
            border-radius: 20px;
            padding: 1rem 1.5rem;
            color: white;
            font-size: 1rem;
            outline: none;
            transition: border 0.2s, box-shadow 0.2s;
        }
        select:focus, textarea:focus {
            border-color: #ff7b7b;
            box-shadow: 0 0 0 3px rgba(255, 100, 100, 0.3);
        }
        textarea {
            resize: vertical;
            min-height: 110px;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        .evolve-btn {
            flex: 2;
            background: linear-gradient(145deg, #b33030, #ff4d4d);
            border: none;
            padding: 1rem 1.8rem;
            border-radius: 40px;
            font-weight: 700;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 10px 20px -8px #b3002d;
            transition: 0.15s;
            border: 1px solid #ffa5a5;
        }
        .evolve-btn:active { transform: scale(0.97); }
        .evolve-btn:disabled {
            opacity: 0.5;
            pointer-events: none;
            filter: grayscale(0.5);
        }

        .reset-btn {
            flex: 0.4;
            background: #2a2f3a;
            border: 1px solid #555;
            border-radius: 40px;
            color: #ddd;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        .reset-btn:hover {
            background: #3a3f4a;
            color: white;
        }

        /* response area */
        .response-card {
            margin: 2rem 0;
            border-left: 6px solid #ff4d4d;
            background: #181c24;
            border-radius: 24px;
            padding: 1.5rem;
            display: none;
        }
        .response-card.show {
            display: block;
            animation: fadeSlide 0.3s ease;
        }
        @keyframes fadeSlide {
            0% { opacity: 0; transform: translateY(10px); }
            100% { opacity: 1; transform: translateY(0); }
        }
        .response-header {
            display: flex;
            gap: 8px;
            align-items: center;
            color: #ff9f7c;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* topic memory */
        .memory-section {
            background: #12161c;
            border-radius: 1.8rem;
            padding: 1.5rem;
            margin-top: 1.5rem;
            border: 1px dashed #3e4a5a;
        }
        .memory-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ffcc99;
            font-size: 1.2rem;
            margin-bottom: 1rem;
        }
        .topic-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.6rem;
            max-height: 150px;
            overflow-y: auto;
            padding: 0.4rem 0.2rem;
        }
        .topic-tag {
            background: #1f2a36;
            padding: 0.3rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            color: #bdd3ff;
            border: 1px solid #3d5068;
            white-space: nowrap;
        }
        .topic-tag::before {
            content: 'üìò';
            margin-right: 5px;
            font-size: 0.75rem;
        }

        .empty-memory {
            color: #5e6f88;
            font-style: italic;
            padding: 0.5rem 0;
        }

        .footer-note {
            margin-top: 2rem;
            font-size: 0.8rem;
            color: #4a5565;
            text-align: center;
        }

        /* loading spinner */
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div class="container">
        <!-- header -->
        <div class="glass-card" style="text-align: center;">
            <h1>‚ö° ‡§µ‡§ø‡§µ‡•á‡§ï AI ¬∑ ‡§µ‡§ø‡§ï‡§æ‡§∏ ‡§Ø‡§æ‡§§‡•ç‡§∞‡§æ</h1>
            <div class="subhead">
                <span>üß¨ ‡§¨‡§æ‡§≤‡§ï ‚ûî ‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞</span>
                <span style="font-size: 0.9rem; background: #1d232d; padding: 0.3rem 1rem; border-radius: 40px;">‡§π‡§ø‡§Ç‡§ó‡•ç‡§≤‡§ø‡§∂ ‡§Æ‡•á‡§Ç ‡§∏‡•Ä‡§ñ‡•ã</span>
            </div>

            <!-- evolution display -->
            <div class="evolution-panel">
                <span class="stage-badge" id="stage-badge">üë∂ STAGE: ‡§®‡§µ‡§ú‡§æ‡§§</span>
                <div class="avatar" id="avatar">üë∂</div>
                <div class="dna-bar">
                    <div class="dna-fill" id="progress-fill" style="width: 0%;"></div>
                </div>
                <div class="brain-stats">
                    <span>üß† ‡§∏‡•Ä‡§ñ‡•á ‡§ó‡§è ‡§ü‡•â‡§™‡§ø‡§ï</span>
                    <span class="brain-count" id="brain-count">0</span>
                </div>
                <div style="font-size: 0.85rem; color: #aaa; margin-top: 0.3rem;" id="next-stage-hint">‡§Ö‡§ó‡§≤‡•Ä ‡§∏‡•ç‡§ü‡•á‡§ú: 5 ‡§ü‡•â‡§™‡§ø‡§ï</div>
            </div>

            <!-- input area -->
            <div class="form-row">
                <select id="edu-level">
                    <option value="School (KG-12)">üè´ ‡§∏‡•ç‡§ï‡•Ç‡§≤ (KG ‡§∏‡•á 12th)</option>
                    <option value="NEET/JEE">ü©∫ NEET / JEE (‡§Æ‡•á‡§°‡§ø‡§ï‡§≤/‡§á‡§Ç‡§ú‡•Ä‡§®‡§ø‡§Ø‡§∞‡§ø‡§Ç‡§ó)</option>
                    <option value="University/Shivaji">üéì ‡§Ø‡•Ç‡§®‡§ø‡§µ‡§∞‡•ç‡§∏‡§ø‡§ü‡•Ä (‡§∂‡§ø‡§µ‡§æ‡§ú‡•Ä ‡§ï‡•â‡§≤‡•á‡§ú)</option>
                    <option value="Govt Exams/NTPC">üöÇ ‡§∞‡•á‡§≤‡§µ‡•á NTPC / SSC</option>
                    <option value="Global Studies">üåç ‡§¶‡•Å‡§®‡§ø‡§Ø‡§æ ‡§ï‡•á ‡§¶‡•á‡§∂ / ‡§ï‡§∞‡§Ç‡§ü ‡§Ö‡§´‡•á‡§Ø‡§∞‡•ç‡§∏</option>
                </select>

                <textarea id="study-input" rows="3" placeholder="‡§â‡§¶‡§æ‡§π‡§∞‡§£: '‡§≠‡§æ‡§∞‡§§ ‡§ï‡§æ ‡§∏‡§Ç‡§µ‡§ø‡§ß‡§æ‡§®', 'Photosynthesis', 'Quadratic equations' ..."></textarea>

                <div class="button-group">
                    <button class="evolve-btn" id="teach-btn" onclick="teachChild()">
                        <span>üß¨</span> ‡§∏‡§ø‡§ñ‡§æ‡§ì ‡§î‡§∞ ‡§µ‡§ø‡§ï‡§∏‡§ø‡§§ ‡§ï‡§∞‡•ã
                    </button>
                    <button class="reset-btn" id="reset-btn" onclick="resetMemory()">
                        <span>üóëÔ∏è</span> ‡§∞‡•Ä‡§∏‡•á‡§ü
                    </button>
                </div>
            </div>

            <!-- AI response card (hidden initially) -->
            <div id="response-card" class="response-card">
                <div class="response-header">
                    <span>ü§ñ ‡§µ‡§ø‡§µ‡•á‡§ï (‡§¨‡§æ‡§≤‡§ï) ‡§¨‡•ã‡§≤‡§§‡§æ ‡§π‡•à</span>
                </div>
                <div id="output-content" style="line-height: 1.7; white-space: pre-wrap; word-break: break-word;">üëã ‡§®‡§Æ‡§∏‡•ç‡§§‡•á! ‡§Æ‡•Å‡§ù‡•á ‡§ï‡•Å‡§õ ‡§∏‡§ø‡§ñ‡§æ‡§á‡§è‡•§</div>
            </div>

            <!-- memory / learned topics -->
            <div class="memory-section">
                <div class="memory-title">
                    <span>üìö ‡§Æ‡•á‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡§¶‡§æ‡§∂‡•ç‡§§ (‡§∏‡•Ä‡§ñ‡•á ‡§π‡•Å‡§è ‡§ü‡•â‡§™‡§ø‡§ï)</span>
                    <span style="font-size:0.8rem; background:#2a3440; padding:0.2rem 0.8rem; border-radius: 20px;" id="topic-count-badge">0</span>
                </div>
                <div id="topic-list-container" class="topic-list">
                    <div class="empty-memory">‡§Ö‡§≠‡•Ä ‡§ï‡•Å‡§õ ‡§®‡§π‡•Ä‡§Ç ‡§∏‡•Ä‡§ñ‡§æ ‡•§ "‡§∏‡§ø‡§ñ‡§æ‡§ì" ‡§¨‡§ü‡§® ‡§¶‡§¨‡§æ‡§è‡§Å</div>
                </div>
            </div>
            <div class="footer-note">
                ‚ö° ‡§π‡§∞ ‡§¨‡§æ‡§∞ ‡§∏‡§ø‡§ñ‡§æ‡§®‡•á ‡§™‡§∞ ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§µ‡§ø‡§ï‡§∏‡§ø‡§§ ‡§π‡•ã‡§§‡§æ ‡§π‡•à ¬∑ ‡§∏‡•ç‡§ü‡•á‡§ú ‡§¨‡§¶‡§≤‡§§‡•Ä ‡§π‡•à ¬∑ ‡§°‡•á‡§ü‡§æ localStorage ‡§Æ‡•á‡§Ç ‡§∏‡•á‡§µ ‡§∞‡§π‡§§‡§æ ‡§π‡•à
            </div>
        </div>
    </div>

    <script>
        (function() {
            // ---------- hardcoded key (base64, decode once) ----------
            const _ENCODED_KEY = "c2stb3ItdjEtODY1NjAxOTVhODE4NzhmN2UyYzlmOTU3MDE4M2U4Nzg0ZDBiMjhlNjc4NzM2MTk1ODYxNjE0Nzc3ZWY2YTAzNQ==";
            const API_KEY = atob(_ENCODED_KEY);   // use for OpenRouter

            // DOM elements
            const stageEl = document.getElementById('stage-badge');
            const avatarEl = document.getElementById('avatar');
            const brainCountEl = document.getElementById('brain-count');
            const progressFill = document.getElementById('progress-fill');
            const nextStageHint = document.getElementById('next-stage-hint');
            const topicContainer = document.getElementById('topic-list-container');
            const topicCountBadge = document.getElementById('topic-count-badge');
            const responseCard = document.getElementById('response-card');
            const outputContent = document.getElementById('output-content');
            const studyInput = document.getElementById('study-input');
            const eduSelect = document.getElementById('edu-level');
            const teachBtn = document.getElementById('teach-btn');

            // ---------- brain storage helpers ----------
            function getBrain() {
                return JSON.parse(localStorage.getItem('v_brain') || '[]');
            }

            function saveBrain(brain) {
                localStorage.setItem('v_brain', JSON.stringify(brain));
            }

            // update UI from brain (stage, count, progress, topic list)
            function refreshUI() {
                const brain = getBrain();
                const count = brain.length;

                // update count
                brainCountEl.innerText = count;
                topicCountBadge.innerText = count;

                // render topic chips
                if (count === 0) {
                    topicContainer.innerHTML = '<div class="empty-memory">üì≠ ‡§Ö‡§≠‡•Ä ‡§§‡§ï ‡§ï‡•ã‡§à ‡§ü‡•â‡§™‡§ø‡§ï ‡§®‡§π‡•Ä‡§Ç ‡§™‡§¢‡§º‡§æ</div>';
                } else {
                    let html = '';
                    // show last 15 topics (newest first)
                    const recent = brain.slice(-15).reverse();
                    recent.forEach(topic => {
                        if (topic && topic.trim()) {
                            let shortTopic = topic.length > 30 ? topic.slice(0, 27) + '‚Ä¶' : topic;
                            html += `<span class="topic-tag">${shortTopic}</span>`;
                        }
                    });
                    topicContainer.innerHTML = html;
                }

                // determine stage based on thresholds
                let stageName = '‡§®‡§µ‡§ú‡§æ‡§§';
                let avatar = 'üë∂';
                let nextThreshold = 5;
                if (count >= 30) {
                    stageName = '‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞';
                    avatar = 'üë®‚Äçüè´';
                    nextThreshold = Infinity;
                } else if (count >= 15) {
                    stageName = '‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä';
                    avatar = 'üßë‚Äçüéì';
                    nextThreshold = 30;
                } else if (count >= 5) {
                    stageName = '‡§¨‡§æ‡§≤‡§ï (‡§ü‡•â‡§°‡§≤‡§∞)';
                    avatar = 'üë¶';
                    nextThreshold = 15;
                } else {
                    stageName = '‡§®‡§µ‡§ú‡§æ‡§§';
                    avatar = 'üë∂';
                    nextThreshold = 5;
                }

                stageEl.innerText = `üß¨ STAGE: ${stageName}`;
                avatarEl.innerText = avatar;

                // progress to next stage
                let progressPercent = 0;
                if (count < 5) {
                    progressPercent = (count / 5) * 100;
                    nextStageHint.innerText = `‡§Ö‡§ó‡§≤‡•Ä ‡§∏‡•ç‡§ü‡•á‡§ú (‡§¨‡§æ‡§≤‡§ï) ‡§ï‡•á ‡§≤‡§ø‡§è ${5 - count} ‡§î‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï ‡§ö‡§æ‡§π‡§ø‡§è`;
                } else if (count < 15) {
                    progressPercent = ((count - 5) / (15 - 5)) * 100;
                    nextStageHint.innerText = `‡§Ö‡§ó‡§≤‡•Ä ‡§∏‡•ç‡§ü‡•á‡§ú (‡§µ‡§ø‡§¶‡•ç‡§Ø‡§æ‡§∞‡•ç‡§•‡•Ä) ‡§ï‡•á ‡§≤‡§ø‡§è ${15 - count} ‡§î‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï`;
                } else if (count < 30) {
                    progressPercent = ((count - 15) / (30 - 15)) * 100;
                    nextStageHint.innerText = `‡§Ö‡§ó‡§≤‡•Ä ‡§∏‡•ç‡§ü‡•á‡§ú (‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞) ‡§ï‡•á ‡§≤‡§ø‡§è ${30 - count} ‡§î‡§∞ ‡§ü‡•â‡§™‡§ø‡§ï`;
                } else {
                    progressPercent = 100;
                    nextStageHint.innerText = `‚ú® ‡§™‡•ç‡§∞‡•ã‡§´‡•á‡§∏‡§∞ ‡§∏‡•ç‡§§‡§∞ ‚Äî ‡§Ü‡§™ ‡§Æ‡§π‡§æ‡§® ‡§∂‡§ø‡§ï‡•ç‡§∑‡§ï ‡§π‡•à‡§Ç ‚ú®`;
                }
                progressFill.style.width = Math.min(progressPercent, 100) + '%';
            }

            // add new topic to brain (if not empty)
            function addTopicToBrain(topic) {
                if (!topic || !topic.trim()) return false;
                const brain = getBrain();
                brain.push(topic.trim());
                saveBrain(brain);
                refreshUI();
                return true;
            }

            // reset all memory
            window.resetMemory = function() {
                if (confirm('‡§∏‡§æ‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡§¶‡§æ‡§∂‡•ç‡§§ ‡§Æ‡§ø‡§ü‡§æ ‡§¶‡•á‡§Ç? ‡§¨‡§æ‡§≤‡§ï ‡§µ‡§æ‡§™‡§∏ ‡§®‡§µ‡§ú‡§æ‡§§ ‡§π‡•ã ‡§ú‡§æ‡§è‡§ó‡§æ‡•§')) {
                    localStorage.removeItem('v_brain');
                    refreshUI();
                    responseCard.classList.remove('show');
                    outputContent.innerText = 'üëã ‡§Æ‡•á‡§∞‡•Ä ‡§Ø‡§æ‡§¶‡§¶‡§æ‡§∂‡•ç‡§§ ‡§∞‡•Ä‡§∏‡•á‡§ü ‡§π‡•ã ‡§ó‡§à‡•§ ‡§Ö‡§¨ ‡§Æ‡•à‡§Ç ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§®‡§Ø‡§æ ‡§π‡•Ç‡§Å‡•§';
                    studyInput.value = '';
                }
            };

            // main teach function (called from button)
            window.teachChild = async function() {
                const input = studyInput.value.trim();
                const level = eduSelect.value;

                if (!input) {
                    alert('‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§∏‡§ø‡§ñ‡§æ‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç');
                    return;
                }

                // disable button during fetch
                teachBtn.disabled = true;
                const originalText = teachBtn.innerHTML;
                teachBtn.innerHTML = '<span class="spinner"></span> ‡§∏‡•ã‡§ö ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Å...';

                // show response card
                responseCard.classList.add('show');
                outputContent.innerText = 'üß† ‡§¶‡§ø‡§Æ‡§æ‡§ó ‡§Æ‡•á‡§Ç ‡§®‡§à ‡§®‡§∏‡•á‡§Ç ‡§¨‡§® ‡§∞‡§π‡•Ä ‡§π‡•à‡§Ç ...';

                try {
                    // call OpenRouter API
                    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Authorization': `Bearer ${API_KEY}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            model: 'google/gemini-2.0-flash-exp:free',
                            messages: [
                                { role: 'system', content: `‡§§‡•Å‡§Æ ‡§µ‡§ø‡§µ‡•á‡§ï ‡§®‡§æ‡§Æ‡§ï ‡§è‡§ï ‡§ú‡§ø‡§ú‡•ç‡§û‡§æ‡§∏‡•Å ‡§¨‡§æ‡§≤‡§ï ‡§π‡•ã‡•§ ‡§Ö‡§≠‡•Ä ‡§§‡•Å‡§Æ ${level} ‡§∏‡•ç‡§§‡§∞ ‡§™‡§∞ ‡§∏‡•Ä‡§ñ ‡§∞‡§π‡•á ‡§π‡•ã‡•§ ‡§¨‡§ö‡•ç‡§ö‡•ã‡§Ç ‡§ï‡•Ä ‡§§‡§∞‡§π ‡§∏‡§∞‡§≤ ‡§π‡§ø‡§Ç‡§ó‡•ç‡§≤‡§ø‡§∂ (‡§π‡§ø‡§Ç‡§¶‡•Ä + ‡§á‡§Ç‡§ó‡•ç‡§≤‡§ø‡§∂) ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡§æ‡§ì‡•§ ‡§Æ‡§ú‡•á‡§¶‡§æ‡§∞ ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¶‡•ã‡•§ ‡§•‡•ã‡§°‡§º‡§æ ‡§õ‡•ã‡§ü‡§æ ‡§î‡§∞ ‡§™‡•ç‡§Ø‡§æ‡§∞‡§æ ‡§â‡§§‡•ç‡§§‡§∞ ‡§¶‡•ã‡•§` },
                                { role: 'user', content: input }
                            ]
                        })
                    });

                    if (!response.ok) {
                        throw new Error(`API error ${response.status}`);
                    }

                    const data = await response.json();
                    const reply = data.choices?.[0]?.message?.content || '‡§ï‡•ã‡§à ‡§ú‡§µ‡§æ‡§¨ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§';
                    outputContent.innerText = reply;

                    // evolution: add topic to brain (only on success)
                    addTopicToBrain(input);

                    // clear input field after successful teach (optional)
                    studyInput.value = '';

                } catch (err) {
                    console.error(err);
                    outputContent.innerText = '‚ùå ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø: ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Ø‡§æ API ‡§ï‡•Ä ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ‡•§ ‡§¨‡§æ‡§¶ ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§';
                } finally {
                    teachBtn.disabled = false;
                    teachBtn.innerHTML = originalText;
                }
            };

            // initialize on page load: just refresh UI without pushing empty topic
            refreshUI();

            // if there is already brain, maybe show response card? not needed.
            // but if user wants to see old responses? we don't store them. fine.

            // helper to also update when storage changes in another tab (not critical)
            window.addEventListener('storage', (e) => {
                if (e.key === 'v_brain') refreshUI();
            });

        })();
    </script>
</body>
</html>