<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ‡§ï‡§æ AI ‡§∏‡•ç‡§ü‡§°‡•Ä ‡§¶‡•ã‡§∏‡•ç‡§§ ¬∑ ‡§∏‡§∞‡•ç‡§ö ‡§ï‡•á ‡§∏‡§æ‡§•</title>

    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Devanagari:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- KaTeX (‡§ó‡§£‡§ø‡§§) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Tesseract OCR -->
    <script src="https://unpkg.com/tesseract.js@5.0.3/dist/tesseract.min.js"></script>
    <!-- PDF export -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #b22222;
            --primary-dark: #8b1a1a;
            --dark: #1e1e1e;
            --paper: #fffcf7;
            --success: #2e7d32;
            --warning: #b85e00;
            --info: #1565c0;
            --border-radius: 24px;
            --shadow: 0 15px 30px -12px rgba(0,0,0,0.2);
        }
        body {
            background: linear-gradient(145deg, #d6cbbd, #e6ddd2);
            font-family: 'IBM Plex Sans Devanagari', sans-serif;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }
        .app-container {
            max-width: 1400px;
            width: 100%;
            background: var(--paper);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 2px solid var(--primary);
            padding: 25px;
        }
        /* header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid var(--primary);
            padding-bottom: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }
        .logo {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(145deg, var(--primary), black);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .user-info {
            background: var(--dark);
            color: white;
            padding: 8px 20px;
            border-radius: 40px;
            border: 2px solid var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .btn {
            background: var(--dark);
            color: white;
            border: 2px solid var(--primary);
            padding: 10px 22px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 6px;
            font-size: 0.95rem;
        }
        .btn-primary {
            background: var(--primary);
            border-color: var(--dark);
        }
        .btn:hover { transform: scale(1.02); filter: brightness(1.1); }
        .btn-icon {
            padding: 10px 16px;
        }
        /* login card */
        .login-card {
            background: white;
            border-radius: 28px;
            padding: 30px;
            max-width: 400px;
            margin: 30px auto;
            border: 2px solid var(--primary);
            box-shadow: 6px 6px 0 var(--dark);
        }
        .login-card h2 { color: var(--primary); margin-bottom: 20px; }
        .login-card input {
            width: 100%;
            padding: 12px 18px;
            margin: 10px 0;
            border-radius: 40px;
            border: 2px solid var(--dark);
            font-size: 1rem;
        }
        .flex-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }
        /* dashboard */
        .section-title {
            color: var(--primary);
            margin: 25px 0 15px;
            border-left: 8px solid var(--primary);
            padding-left: 15px;
        }
        .class-grid, .subject-grid {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 25px;
        }
        .class-btn, .sub-btn {
            background: white;
            border: 2px solid var(--dark);
            padding: 12px 24px;
            border-radius: 40px;
            font-weight: 600;
            cursor: pointer;
            transition: 0.2s;
        }
        .class-btn.active, .sub-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .notes-card {
            background: var(--dark);
            color: white;
            border-radius: 28px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid var(--primary);
            box-shadow: 5px 5px 0 var(--primary-dark);
        }
        /* ‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä ‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ñ‡§æ‡§∏ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ */
        .heart-diagram {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 20px 0;
            color: black;
            background: #f0f0f0;
            padding: 15px;
            border-radius: 30px;
        }
        .heart-chambers {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            max-width: 300px;
            margin: 10px auto;
        }
        .chamber {
            background: var(--primary);
            color: white;
            padding: 15px 10px;
            border-radius: 50%;
            text-align: center;
            font-weight: bold;
            box-shadow: 4px 4px 0 var(--dark);
        }
        .chamber small { display: block; font-size: 0.7rem; color: #ffdddd; }
        .video-section {
            background: white;
            border-radius: 28px;
            padding: 25px;
            border: 2px solid var(--primary);
            margin: 25px 0;
        }
        .mock-player {
            background: #2d2d2d;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            color: white;
            margin: 15px 0;
            border: 2px solid var(--primary);
        }
        .history-item, .request-item {
            background: white;
            border-radius: 40px;
            padding: 12px 20px;
            margin-bottom: 12px;
            border-left: 12px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 3px 3px 0 var(--dark);
        }
        .badge {
            background: var(--primary);
            color: white;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
        }
        /* ai tools */
        .ai-card {
            background: white;
            border-radius: 28px;
            padding: 25px;
            border: 2px solid var(--primary);
            margin: 20px 0;
        }
        .input-row {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .input-row input {
            flex: 1;
            min-width: 250px;
            padding: 14px 22px;
            border-radius: 50px;
            border: 2px solid var(--dark);
            font-size: 1rem;
        }
        .file-zone {
            background: #f0ebe2;
            border-radius: 40px;
            padding: 16px 20px;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
            border: 2px dashed var(--primary);
            margin: 15px 0;
        }
        .file-info {
            background: white;
            padding: 8px 16px;
            border-radius: 40px;
            display: flex;
            align-items: center;
            gap: 12px;
            border: 2px solid var(--dark);
        }
        .progress-bar {
            height: 8px;
            background: #e0d6cc;
            border-radius: 10px;
            overflow: hidden;
            width: 100%;
            margin-top: 12px;
            display: none;
        }
        .progress-fill { height: 100%; background: var(--primary); transition: width 0.2s; }
        .preview-box {
            background: white;
            border: 2px solid var(--dark);
            border-radius: 20px;
            padding: 10px;
            max-width: 200px;
            display: none;
        }
        .preview-box.show { display: block; }
        .preview-box img, .preview-box video { max-width: 100%; border-radius: 12px; }
        .toast {
            background: var(--dark);
            color: white;
            padding: 12px 20px;
            border-radius: 50px;
            display: none;
            margin: 15px 0;
        }
        /* notebook grid */
        .notebook-grid {
            background: #ffeede;
            border-radius: 30px;
            padding: 20px;
            border: 3px solid var(--primary);
            min-height: 150px;
        }
        .note-item {
            background: white;
            border-radius: 40px;
            padding: 12px 18px;
            margin-bottom: 10px;
            border-left: 12px solid var(--primary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .delete-note {
            background: none;
            border: none;
            color: var(--primary);
            font-size: 1.3rem;
            cursor: pointer;
        }
        .category-filter {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        .cat-btn {
            background: transparent;
            border: 2px solid var(--dark);
            padding: 6px 20px;
            border-radius: 40px;
            cursor: pointer;
        }
        .cat-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        /* test */
        .test-card {
            background: var(--dark);
            color: white;
            border-radius: 28px;
            padding: 25px;
            margin: 20px 0;
        }
        .options-grid {
            display: grid;
            grid-template-columns: repeat(2,1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .opt-btn {
            background: #3a3a3a;
            border: 2px solid var(--primary);
            padding: 12px;
            border-radius: 40px;
            cursor: pointer;
            color: white;
        }
        .opt-btn.selected { background: var(--primary); }
        
        /* ‡§®‡§Ø‡§æ: AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® */
        .media-creator-card {
            background: linear-gradient(145deg, #ffffff, #f8f4ed);
            border-radius: 28px;
            padding: 25px;
            border: 3px solid var(--primary);
            margin: 30px 0;
            box-shadow: 8px 8px 0 var(--dark);
        }
        .media-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--primary);
            padding-bottom: 10px;
        }
        .media-tab {
            padding: 10px 25px;
            border-radius: 40px;
            cursor: pointer;
            font-weight: 600;
            background: white;
            border: 2px solid var(--dark);
        }
        .media-tab.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .media-content {
            display: none;
        }
        .media-content.active {
            display: block;
        }
        .style-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 10px;
            margin: 15px 0;
        }
        .style-btn {
            background: white;
            border: 2px solid var(--dark);
            padding: 8px 12px;
            border-radius: 30px;
            cursor: pointer;
            text-align: center;
            font-size: 0.9rem;
        }
        .style-btn.selected {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }
        .generated-media {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .media-item {
            background: var(--dark);
            border-radius: 20px;
            padding: 15px;
            color: white;
            text-align: center;
            border: 2px solid var(--primary);
        }
        .media-item img, .media-item video {
            width: 100%;
            border-radius: 15px;
            margin-bottom: 10px;
            border: 2px solid var(--primary);
        }
        .media-item .prompt-text {
            font-size: 0.8rem;
            color: #ccc;
            margin: 5px 0;
        }
        
        .footer {
            margin-top: 30px;
            text-align: center;
            color: #5f4e3c;
        }
        @media (max-width:700px) {
            .options-grid { grid-template-columns: 1fr; }
            .style-grid { grid-template-columns: repeat(2, 1fr); }
        }
    </style>
</head>
<body>
<div class="app-container">
    <!-- header -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-robot" style="color: var(--primary);"></i> 
            ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI ‡§∏‡•ç‡§ü‡§°‡•Ä ‡§Æ‡§Ç‡§°‡§≤‡•Ä
        </div>
        <div id="userInfo" class="user-info" style="display: none;">
            <i class="fas fa-user-circle"></i> <span id="usernameDisplay"></span>
            <button class="btn" id="logoutBtn" style="padding: 4px 12px;">‡§≤‡•â‡§ó‡§Ü‡§â‡§ü</button>
        </div>
    </div>

    <!-- login area (default visible) -->
    <div id="loginArea" class="login-card">
        <h2><i class="fas fa-lock"></i> ‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂</h2>
        <input type="text" id="loginUsername" placeholder="‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ (‡§ú‡•à‡§∏‡•á: ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ)" value="‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ">
        <input type="password" id="loginPassword" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°" value="123">
        <div class="flex-row">
            <button class="btn btn-primary" id="loginBtn"><i class="fas fa-sign-in-alt"></i> ‡§≤‡•â‡§ó‡§ø‡§®</button>
            <button class="btn" id="signupBtn"><i class="fas fa-user-plus"></i> ‡§∏‡§æ‡§á‡§®‡§Ö‡§™</button>
        </div>
        <p style="margin-top:15px;">üîë admin/admin (‡§è‡§°‡§Æ‡§ø‡§®)  |  ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ/123</p>
    </div>

    <!-- main dashboard (visible after login) -->
    <div id="dashboardArea" style="display: none;">

        <!-- ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡§Ø‡§® -->
        <h3 class="section-title"><i class="fas fa-graduation-cap"></i> ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
        <div class="class-grid" id="classGrid">
            <button class="class-btn" data-class="9">‡§ï‡§ï‡•ç‡§∑‡§æ 9</button>
            <button class="class-btn" data-class="10">‡§ï‡§ï‡•ç‡§∑‡§æ 10</button>
            <button class="class-btn" data-class="11">‡§ï‡§ï‡•ç‡§∑‡§æ 11</button>
            <button class="class-btn active" data-class="12">‡§ï‡§ï‡•ç‡§∑‡§æ 12</button>
        </div>

        <h3 class="section-title"><i class="fas fa-book-open"></i> ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
        <div class="subject-grid" id="subjectGrid">
            <button class="sub-btn active" data-subject="physics">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</button>
            <button class="sub-btn" data-subject="chemistry">‡§∞‡§∏‡§æ‡§Ø‡§®</button>
            <button class="sub-btn" data-subject="maths">‡§ó‡§£‡§ø‡§§</button>
            <button class="sub-btn" data-subject="biology">‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®</button>
        </div>

        <!-- ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§° (‡§Ö‡§¨ ‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§ï‡•á ‡§∏‡§æ‡§•) -->
        <div class="notes-card" id="notesCard">
            <h3><i class="fas fa-sticky-note"></i> <span id="subjectName">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</span> - ‡§Æ‡•Ç‡§≤ ‡§®‡•ã‡§ü‡•ç‡§∏</h3>
            <div id="notesContent" style="white-space: pre-line;"></div>
            <!-- ‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§æ‡§Ø‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§Ø‡§π‡§æ‡§Å ‡§°‡§æ‡§≤‡•á‡§Ç‡§ó‡•á (‡§°‡§æ‡§Ø‡§®‡§æ‡§Æ‡§ø‡§ï) -->
            <div id="biologyDiagram" style="display: none;" class="heart-diagram">
                <h4 style="color: var(--primary);">‚ù§Ô∏è ‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ</h4>
                <div class="heart-chambers">
                    <div class="chamber">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Right Atrium)</small></div>
                    <div class="chamber">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Left Atrium)</small></div>
                    <div class="chamber">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Right Ventricle)</small></div>
                    <div class="chamber">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Left Ventricle)</small></div>
                </div>
                <p><i class="fas fa-arrow-right"></i> SA ‡§®‡•ã‡§° (‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞) ‡§¶‡§æ‡§è‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§</p>
            </div>
        </div>

        <!-- AI ‡§ü‡•Ç‡§≤‡•ç‡§∏ ‡§ï‡§æ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® (‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§ú‡§®‡§∞‡•á‡§ü‡§∞) -->
        <div class="ai-card">
            <h3 style="color:var(--primary);"><i class="fas fa-microchip"></i> AI ‡§∏‡§π‡§æ‡§Ø‡§ï ‚Äì ‡§Ö‡§™‡§®‡§æ ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç</h3>
            <div class="input-row">
                <input type="text" id="topicInput" placeholder="‡§ú‡•à‡§∏‡•á: ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ, ‡§π‡•É‡§¶‡§Ø, ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£..." value="‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">
                <button class="btn btn-primary" id="generateBtn"><i class="fas fa-magic"></i> ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</button>
                <button class="btn btn-icon" id="improveBtn" title="‡§Ü‡§∏‡§æ‡§® ‡§Æ‡•ã‡§°"><i class="fas fa-smile"></i></button>
                <button class="btn btn-icon" id="voiceSearchBtn" title="‡§µ‡•â‡§á‡§∏ ‡§∏‡§∞‡•ç‡§ö"><i class="fas fa-microphone-alt"></i></button>
            </div>

            <!-- ‡§´‡§æ‡§á‡§≤ ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡•ç‡§∑‡•á‡§§‡•ç‡§∞ -->
            <div class="file-zone" id="fileDropZone">
                <i class="fas fa-cloud-upload-alt" style="font-size:2rem; color:var(--primary);"></i>
                <div style="flex:1;">‡§´‡•ã‡§ü‡•ã/PDF/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç</div>
                <label for="fileUpload" class="btn btn-icon" style="background:var(--primary);"><i class="fas fa-folder-open"></i> ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç</label>
                <input type="file" id="fileUpload" hidden accept="image/*,application/pdf,video/*,.txt">
            </div>
            <div id="fileInfoArea" class="file-info" style="display:none; margin-top:10px;">
                <i class="fas fa-file"></i> <span id="fileName"></span> <span id="fileSize"></span>
                <button class="clear-file" id="clearFileBtn"><i class="fas fa-times-circle"></i></button>
            </div>
            <div class="progress-bar" id="ocrProgress"><div class="progress-fill" id="ocrProgressFill"></div></div>
            <div class="preview-container" style="display: flex; gap:10px; margin-top:10px;">
                <div class="preview-box" id="imgPreviewBox"><img id="previewImg" src="#"></div>
                <div class="preview-box" id="videoPreviewBox"><video id="videoPreview" controls></video></div>
            </div>
            <!-- AI ‡§ú‡§®‡§∞‡•á‡§ü‡•á‡§° ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§ó‡§æ -->
            <div id="outputArea"></div>
        </div>

        <!-- ========== ‡§®‡§Ø‡§æ AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ‡§∏‡•á‡§ï‡•ç‡§∂‡§® (‡§â‡§ö‡•ç‡§ö ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ ‡§µ‡§æ‡§≤‡§æ) ========== -->
        <div class="media-creator-card">
            <h2 style="color:var(--primary); display: flex; align-items: center; gap: 10px;">
                <i class="fas fa-magic"></i> AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ (‡§â‡§ö‡•ç‡§ö ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ)
                <span style="background: var(--primary); color: white; padding: 4px 15px; border-radius: 40px; font-size: 0.9rem;">‡§°‡•á‡§Æ‡•ã ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£</span>
            </h2>
            <p style="margin-bottom: 20px;">‡§Ö‡§™‡§®‡•á ‡§™‡§¢‡§º‡§æ‡§à ‡§ï‡•á ‡§ü‡•â‡§™‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§õ‡§µ‡§ø‡§Ø‡§æ‡§Å ‡§î‡§∞ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ‡§è‡§Å‡•§ ‡§®‡•Ä‡§ö‡•á ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§ö‡•Å‡§®‡•á‡§Ç‡•§</p>
            
            <!-- ‡§ü‡•à‡§¨‡•ç‡§∏ -->
            <div class="media-tabs">
                <div class="media-tab active" data-media="image">üñºÔ∏è ‡§õ‡§µ‡§ø ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</div>
                <div class="media-tab" data-media="video">üé¨ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</div>
            </div>
            
            <!-- ‡§õ‡§µ‡§ø ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§ü‡•à‡§¨ -->
            <div class="media-content active" id="image-tab">
                <div class="input-row">
                    <input type="text" id="imagePrompt" placeholder="‡§õ‡§µ‡§ø ‡§ï‡§æ ‡§µ‡§∞‡•ç‡§£‡§® ‡§ï‡§∞‡•á‡§Ç... (‡§ú‡•à‡§∏‡•á: ‡§∏‡•Ç‡§∞‡•ç‡§Ø‡§æ‡§∏‡•ç‡§§ ‡§ï‡•á ‡§∏‡§Æ‡§Ø ‡§π‡§ø‡§Æ‡§æ‡§≤‡§Ø)" value="‡§¨‡§æ‡§¶‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§â‡§°‡§º‡§§‡§æ ‡§π‡•Å‡§Ü ‡§∂‡•á‡§∞, ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§Ü‡§∞‡•ç‡§ü">
                    <button class="btn btn-primary" id="generateImageBtn"><i class="fas fa-image"></i> ‡§õ‡§µ‡§ø ‡§¨‡§®‡§æ‡§è‡§Å</button>
                </div>
                
                <div style="margin: 15px 0;">
                    <p><strong>‡§®‡§ï‡§æ‡§∞‡§æ‡§§‡•ç‡§Æ‡§ï ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü (‡§ï‡•ç‡§Ø‡§æ ‡§®‡§π‡•Ä‡§Ç ‡§ö‡§æ‡§π‡§ø‡§è):</strong></p>
                    <input type="text" id="negativePrompt" placeholder="‡§ß‡•Å‡§Ç‡§ß‡§≤‡§æ, ‡§ï‡§Æ ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ, ‡§µ‡§ø‡§ï‡•É‡§§" value="‡§ß‡•Å‡§Ç‡§ß‡§≤‡§æ, ‡§ï‡§Æ ‡§ó‡•Å‡§£‡§µ‡§§‡•ç‡§§‡§æ, ‡§µ‡§ø‡§ï‡•É‡§§, ‡§Ö‡§§‡§ø‡§∞‡§ø‡§ï‡•ç‡§§ ‡§Ö‡§Ç‡§ó">
                </div>
                
                <p><strong>‡§∂‡•à‡§≤‡•Ä ‡§ö‡•Å‡§®‡•á‡§Ç:</strong></p>
                <div class="style-grid" id="imageStyles">
                    <div class="style-btn selected" data-style="photorealistic">üì∏ ‡§´‡•ã‡§ü‡•ã‡§∞‡§ø‡§Ø‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï</div>
                    <div class="style-btn" data-style="oilpainting">üé® ‡§ë‡§Ø‡§≤ ‡§™‡•á‡§Ç‡§ü‡§ø‡§Ç‡§ó</div>
                    <div class="style-btn" data-style="anime">üå∏ ‡§è‡§®‡•Ä‡§Æ‡•á</div>
                    <div class="style-btn" data-style="watercolor">üíß ‡§µ‡•â‡§ü‡§∞‡§ï‡§≤‡§∞</div>
                    <div class="style-btn" data-style="3d">üßä 3D ‡§∞‡•á‡§Ç‡§°‡§∞</div>
                    <div class="style-btn" data-style="sketch">‚úèÔ∏è ‡§∏‡•ç‡§ï‡•á‡§ö</div>
                </div>
                
                <div style="margin: 20px 0; display: flex; gap: 15px; align-items: center;">
                    <label><strong>‡§ó‡§æ‡§á‡§°‡•á‡§Ç‡§∏ ‡§∏‡•ç‡§ï‡•á‡§≤:</strong> <span id="cfgValue">7.5</span></label>
                    <input type="range" id="cfgScale" min="1" max="15" value="7.5" step="0.5" style="flex:1;">
                    <label><strong>‡§∏‡•ç‡§ü‡•á‡§™‡•ç‡§∏:</strong> <span id="stepsValue">30</span></label>
                    <input type="range" id="steps" min="10" max="50" value="30" step="5" style="width: 100px;">
                </div>
                
                <!-- ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡•Ä ‡§ó‡§à ‡§õ‡§µ‡§ø‡§Ø‡§æ‡§Å ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•Ä -->
                <div id="generatedImages" class="generated-media"></div>
                
                <!-- ‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü ‡§â‡§¶‡§æ‡§π‡§∞‡§£ -->
                <div style="margin-top: 20px;">
                    <p><strong>‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§â‡§¶‡§æ‡§π‡§∞‡§£:</strong></p>
                    <div class="style-grid" style="grid-template-columns: repeat(3, 1fr);">
                        <button class="style-btn example-btn" data-prompt="‡§¨‡§æ‡§¶‡§≤‡•ã‡§Ç ‡§ï‡•á ‡§¨‡•Ä‡§ö ‡§â‡§°‡§º‡§§‡§æ ‡§π‡•Å‡§Ü ‡§∂‡•á‡§∞, ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§Ü‡§∞‡•ç‡§ü">ü¶Å ‡§∂‡•á‡§∞</button>
                        <button class="style-btn example-btn" data-prompt="‡§§‡§æ‡§ú ‡§Æ‡§π‡§≤, ‡§∏‡•Ç‡§∞‡•ç‡§Ø‡§æ‡§∏‡•ç‡§§, ‡§´‡•ã‡§ü‡•ã‡§∞‡§ø‡§Ø‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï">üè∞ ‡§§‡§æ‡§ú ‡§Æ‡§π‡§≤</button>
                        <button class="style-btn example-btn" data-prompt="‡§®‡•Ä‡§≤‡•á ‡§∞‡§Ç‡§ó ‡§ï‡•Ä ‡§§‡§ø‡§§‡§≤‡•Ä, ‡§Æ‡•à‡§ï‡•ç‡§∞‡•ã ‡§´‡•ã‡§ü‡•ã‡§ó‡•ç‡§∞‡§æ‡§´‡•Ä">ü¶ã ‡§§‡§ø‡§§‡§≤‡•Ä</button>
                    </div>
                </div>
            </div>
            
            <!-- ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡§®‡•á ‡§µ‡§æ‡§≤‡§æ ‡§ü‡•à‡§¨ -->
            <div class="media-content" id="video-tab">
                <div class="input-row">
                    <input type="text" id="videoPrompt" placeholder="‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ï‡§æ ‡§µ‡§∞‡•ç‡§£‡§® ‡§ï‡§∞‡•á‡§Ç..." value="‡§è‡§ï ‡§¨‡§ø‡§≤‡•ç‡§≤‡•Ä ‡§™‡§ø‡§Ø‡§æ‡§®‡•ã ‡§¨‡§ú‡§æ ‡§∞‡§π‡•Ä ‡§π‡•à, ‡§ú‡•à‡§ú‡§º ‡§¨‡§æ‡§∞ ‡§Æ‡•á‡§Ç">
                    <button class="btn btn-primary" id="generateVideoBtn"><i class="fas fa-video"></i> ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ‡§è‡§Å</button>
                </div>
                
                <div style="margin: 20px 0;">
                    <label><strong>‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§µ‡§ß‡§ø (‡§∏‡•á‡§ï‡§Ç‡§°):</strong></label>
                    <select id="videoDuration" style="padding: 10px; border-radius: 40px; border: 2px solid var(--dark); margin-left: 15px;">
                        <option value="3">3 ‡§∏‡•á‡§ï‡§Ç‡§°</option>
                        <option value="5" selected>5 ‡§∏‡•á‡§ï‡§Ç‡§°</option>
                        <option value="10">10 ‡§∏‡•á‡§ï‡§Ç‡§°</option>
                    </select>
                </div>
                
                <div class="style-grid" style="grid-template-columns: repeat(2, 1fr); margin: 15px 0;" id="videoStyles">
                    <div class="style-btn selected" data-style="cinematic">üé¨ ‡§∏‡§ø‡§®‡•á‡§Æ‡•à‡§ü‡§ø‡§ï</div>
                    <div class="style-btn" data-style="animation">üìΩÔ∏è ‡§è‡§®‡§ø‡§Æ‡•á‡§∂‡§®</div>
                </div>
                
                <!-- ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§ø‡§è ‡§ó‡§è ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ø‡§π‡§æ‡§Å ‡§¶‡§ø‡§ñ‡•á‡§Ç‡§ó‡•á -->
                <div id="generatedVideos" class="generated-media"></div>
            </div>
            
            <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                <i class="fas fa-info-circle"></i> ‡§®‡•ã‡§ü: ‡§Ø‡§π ‡§è‡§ï ‡§°‡•á‡§Æ‡•ã ‡§∏‡§Ç‡§∏‡•ç‡§ï‡§∞‡§£ ‡§π‡•à‡•§ ‡§Ö‡§∏‡§≤‡•Ä AI ‡§ú‡§®‡§∞‡•á‡§∂‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§∞‡•ç‡§µ‡§∞ ‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•ã‡§ó‡§æ‡•§ 
            </p>
        </div>

        <!-- ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§≠‡§æ‡§ó (‡§Æ‡§ø‡§§‡•ç‡§∞ ‡§Æ‡§Ç‡§°‡§≤‡•Ä) -->
        <div class="video-section">
            <h3 style="color:var(--primary);"><i class="fas fa-video"></i> ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡§∞)</h3>
            <div class="mock-player" id="videoPlaceholder">
                <i class="fas fa-play-circle" style="font-size:3rem; color:var(--primary);"></i>
                <p id="videoMessage">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å' ‡§¶‡§¨‡§æ‡§è‡§Å</p>
            </div>
            <div class="flex-row" style="justify-content:center;">
                <button class="btn btn-primary" id="playVideoBtn"><i class="fas fa-play"></i> AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å</button>
                <button class="btn" id="requestVideoBtn"><i class="fas fa-cloud-upload-alt"></i> ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç</button>
            </div>
        </div>

        <!-- ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü -->
        <div class="test-card" id="mockTest">
            <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
                <h3><i class="fas fa-pencil-alt"></i> ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (RRB ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤)</h3>
                <div class="timer" id="timer" style="background:var(--primary); padding:8px 20px; border-radius:40px;">02:00</div>
            </div>
            <div id="testArea">
                <div id="questionText" style="margin:15px 0;">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                <div class="options-grid" id="optionsContainer"></div>
                <div class="test-footer" style="display:flex; gap:10px; justify-content:center;">
                    <button class="btn" id="prevBtn" disabled><i class="fas fa-arrow-left"></i> ‡§™‡§ø‡§õ‡§≤‡§æ</button>
                    <button class="btn" id="nextBtn">‡§Ö‡§ó‡§≤‡§æ <i class="fas fa-arrow-right"></i></button>
                    <button class="btn btn-primary" id="submitTest">‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç</button>
                </div>
            </div>
            <div id="testResult" class="result-box" style="background:var(--primary); border-radius:20px; padding:20px; margin-top:20px; display:none;"></div>
        </div>

        <!-- ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï - ‡§Ö‡§¨ ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ ‡§ï‡•á ‡§∏‡§æ‡§• -->
        <h3 class="section-title"><i class="fas fa-notebook"></i> ‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï</h3>
        <div class="category-filter">
            <button class="cat-btn active" data-cat="all">‡§∏‡§≠‡•Ä</button>
            <button class="cat-btn" data-cat="physics">‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏</button>
            <button class="cat-btn" data-cat="chemistry">‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</button>
            <button class="cat-btn" data-cat="biology">‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä</button>
        </div>

        <!-- ‡§®‡§Ø‡§æ: ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§æ‡§∞ -->
        <div style="margin-bottom: 15px;">
            <input type="text" id="noteSearchInput" placeholder="üîç Notes mein dhoondhein..." 
                   style="width: 100%; padding: 12px 20px; border-radius: 40px; border: 2px solid var(--primary);">
        </div>

        <div class="notebook-grid" id="notebookList"></div>
        <div style="display: flex; gap:10px; margin-top:15px;">
            <input type="text" id="newNoteText" placeholder="‡§®‡§Ø‡§æ ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç..." style="flex:1; padding:12px; border-radius:40px; border:2px solid var(--dark);">
            <select id="newNoteCategory" style="padding:12px; border-radius:40px; border:2px solid var(--dark);">
                <option value="physics">‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏</option>
                <option value="chemistry">‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</option>
                <option value="biology">‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä</option>
            </select>
            <button class="btn btn-primary" id="addNoteBtn"><i class="fas fa-plus"></i> ‡§ú‡•ã‡§°‡§º‡•á‡§Ç</button>
        </div>
        <button class="btn" id="exportNotesBtn" style="margin:15px 0;"><i class="fas fa-download"></i> ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</button>

        <!-- ‡§á‡§§‡§ø‡§π‡§æ‡§∏ -->
        <h3 class="section-title"><i class="fas fa-history"></i> ‡§Æ‡•á‡§∞‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ (‡§¶‡•á‡§ñ‡•á ‡§ó‡§è ‡§µ‡§ø‡§∑‡§Ø)</h3>
        <div id="historyList" class="history-list"></div>

        <!-- ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ -->
        <div id="adminPanel" style="display: none; margin-top: 25px; border-top: 3px dashed var(--primary); padding-top: 20px;">
            <h3 class="section-title"><i class="fas fa-check-double"></i> ‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï : ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≤‡§Ç‡§¨‡§ø‡§§</h3>
            <div id="requestList"></div>
        </div>

        <!-- ‡§ü‡•ã‡§∏‡•ç‡§ü ‡§Æ‡•à‡§∏‡•á‡§ú -->
        <div class="toast" id="toast"></div>
    </div> <!-- dashboard end -->

    <div class="footer">‡§≤‡§æ‡§≤ & ‡§ï‡§æ‡§≤‡§æ ‡§•‡•Ä‡§Æ ¬∑ AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ (‡§°‡•á‡§Æ‡•ã) ¬∑ ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡§æ</div>
</div>

<script>
(function() {
    // ================== ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§ï‡•Ä ==================
    const USERS_KEY = 'studyDost_users';
    const CURRENT_USER_KEY = 'studyDost_currentUser';
    const HISTORY_KEY = 'studyDost_history';
    const REQUESTS_KEY = 'studyDost_videoRequests';

    // ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§Ö‡§¨ ‡§Ø‡•Ç‡§ú‡§∞-‡§∏‡•ç‡§™‡•á‡§∏‡§ø‡§´‡§ø‡§ï
    function getNotesKey() { return currentUser ? `notes_${currentUser.username}` : 'notes_default'; }

    // ‡§°‡§ø‡§´‡§º‡•â‡§≤‡•ç‡§ü ‡§Ø‡•Ç‡§ú‡§∞
    if (!localStorage.getItem(USERS_KEY)) {
        localStorage.setItem(USERS_KEY, JSON.stringify([
            { username: '‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ', password: '123' },
            { username: '‡§∞‡§æ‡§π‡•Å‡§≤', password: '123' },
            { username: 'admin', password: 'admin' }
        ]));
    }
    if (!localStorage.getItem(REQUESTS_KEY)) localStorage.setItem(REQUESTS_KEY, JSON.stringify([]));
    if (!localStorage.getItem(HISTORY_KEY)) localStorage.setItem(HISTORY_KEY, JSON.stringify([]));

    // ================== ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•à‡§∞‡§ø‡§è‡§¨‡§≤ ==================
    let currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY) || 'null');
    let selectedClass = '12';
    let selectedSubject = 'physics';

    // ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ‡§ï‡•á ‡§≤‡§ø‡§è
    const mockQuestions = [
        { question: '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§Æ‡•á‡§Ç ‡§ß‡§æ‡§§‡•Å ‡§∏‡•á ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§® ‡§â‡§§‡•ç‡§∏‡§∞‡•ç‡§ú‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à?', options: ['‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§§‡•Ä‡§µ‡•ç‡§∞‡§§‡§æ', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§∞‡§Ç‡§ó', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§ß‡•ç‡§∞‡•Å‡§µ‡§£'], answer: 1 },
        { question: '‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞ ‡§ï‡•å‡§® ‡§∏‡§æ ‡§π‡•à?', options: ['AV ‡§®‡•ã‡§°', 'SA ‡§®‡•ã‡§°', '‡§¨‡§Ç‡§°‡§≤ ‡§ë‡§´ ‡§π‡§ø‡§ú', '‡§™‡§∞‡•ç‡§ï‡§ø‡§Ç‡§ú‡•Ä ‡§§‡§Ç‡§§‡•Å'], answer: 1 },
        { question: '‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ax¬≤+bx+c=0 ‡§ï‡•á ‡§Æ‡•Ç‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§Ø‡•ã‡§ó ‡§π‡•ã‡§§‡§æ ‡§π‡•à?', options: ['-b/a', 'b/a', 'c/a', '-c/a'], answer: 0 },
    ];
    let currentQuestionIndex = 0, userAnswers = new Array(mockQuestions.length).fill(-1);
    let timerInterval, timeLeft = 120, testActive = false;

    // ================== DOM ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏ ==================
    const loginArea = document.getElementById('loginArea');
    const dashboardArea = document.getElementById('dashboardArea');
    const userInfoDiv = document.getElementById('userInfo');
    const usernameSpan = document.getElementById('usernameDisplay');
    const toast = document.getElementById('toast');
    const notesContent = document.getElementById('notesContent');
    const subjectNameSpan = document.getElementById('subjectName');
    const biologyDiagram = document.getElementById('biologyDiagram');
    const videoMessage = document.getElementById('videoMessage');
    const adminPanel = document.getElementById('adminPanel');
    const requestListDiv = document.getElementById('requestList');
    const historyListDiv = document.getElementById('historyList');
    const notebookListDiv = document.getElementById('notebookList');
    const noteSearchInput = document.getElementById('noteSearchInput'); // ‡§®‡§Ø‡§æ

    // ================== ‡§â‡§™‡§Ø‡•ã‡§ó‡§ø‡§§‡§æ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ==================
    function showToast(msg, type = 'success') {
        toast.style.display = 'block';
        toast.innerHTML = msg;
        toast.style.background = type === 'error' ? '#b71c1c' : (type === 'warning' ? '#b85e00' : '#1e1e1e');
        setTimeout(() => toast.style.display = 'none', 3000);
    }

    function saveCurrentUser(user) { currentUser = user; localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user)); }

    // ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§°‡•á‡§ü‡§æ‡§¨‡•á‡§∏ (‡§∏‡•ç‡§ü‡•à‡§ü‡§ø‡§ï)
    const notesDatabase = {
        physics: '‚öõÔ∏è **‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ**: K_max = hf - œÜ‚ÇÄ\n‚Ä¢ ‡§®‡§ø‡§∞‡•ã‡§ß‡•Ä ‡§µ‡§ø‡§≠‡§µ V‚ÇÄ = (h/e)f - œÜ‚ÇÄ/e\n‚Ä¢ ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø: f‚ÇÄ = œÜ‚ÇÄ/h',
        chemistry: 'üß™ **‡§∞‡§æ‡§∏‡§æ‡§Ø‡§®‡§ø‡§ï ‡§¨‡§≤‡§ó‡§§‡§ø‡§ï‡•Ä**: ‡§Ö‡§≠‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§¶‡§∞, ‡§ï‡•ã‡§ü‡§ø, ‡§Ü‡§£‡§µ‡§ø‡§ï‡§§‡§æ‡•§\n‚Ä¢ ‡§™‡•ç‡§∞‡§•‡§Æ ‡§ï‡•ã‡§ü‡§ø: k = (2.303/t) log([R]‚ÇÄ/[R])',
        maths: 'üìê **‡§Ö‡§µ‡§ï‡§≤‡§®**: d/dx(sin x) = cos x, d/dx(cos x) = -sin x\n‚Ä¢ ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§®‡§ø‡§Ø‡§Æ',
        biology: 'üß¨ **‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø**: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑ ‚Äì ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø‡•§ SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞‡•§'
    };

    function updateNotesAndUI() {
        subjectNameSpan.innerText = (selectedSubject === 'physics' ? '‡§≠‡•å‡§§‡§ø‡§ï‡•Ä' : selectedSubject === 'chemistry' ? '‡§∞‡§∏‡§æ‡§Ø‡§®' : selectedSubject === 'maths' ? '‡§ó‡§£‡§ø‡§§' : '‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®');
        notesContent.innerText = notesDatabase[selectedSubject] || '‡§®‡•ã‡§ü‡•ç‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç';
        if (selectedSubject === 'biology') {
            biologyDiagram.style.display = 'block';
        } else {
            biologyDiagram.style.display = 'none';
        }
        addToHistory(selectedSubject);
        checkApprovedVideo(selectedSubject);
        // ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡§§‡•á ‡§∏‡§Æ‡§Ø ‡§∏‡§∞‡•ç‡§ö ‡§ï‡•ç‡§≤‡§ø‡§Ø‡§∞ ‡§ï‡§∞ ‡§¶‡•á‡§Ç (‡§®‡§π‡•Ä‡§Ç ‡§§‡•ã ‡§™‡•Å‡§∞‡§æ‡§®‡§æ ‡§∏‡§∞‡•ç‡§ö ‡§¨‡§®‡§æ ‡§∞‡§π‡•á‡§ó‡§æ)
        if (noteSearchInput) noteSearchInput.value = '';
        renderNotebookFromStorage();
    }

    // ‡§á‡§§‡§ø‡§π‡§æ‡§∏
    function addToHistory(subject) {
        if (!currentUser) return;
        let history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        history.push({ username: currentUser.username, subject, className: selectedClass, timestamp: new Date().toLocaleString('hi-IN') });
        localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        renderHistory();
    }

    function renderHistory() {
        if (!currentUser) return;
        const history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        const userHistory = history.filter(h => h.username === currentUser.username).reverse().slice(0, 10);
        historyListDiv.innerHTML = userHistory.length ? userHistory.map(h => `
            <div class="history-item"><span><i class="fas fa-book"></i> ${h.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${h.className})</span><span class="badge">${h.timestamp}</span></div>
        `).join('') : '<div class="history-item">‡§ï‡•ã‡§à ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç</div>';
    }

    // ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß
    function requestVideo() {
        if (!currentUser) return;
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        requests.push({ username: currentUser.username, subject: selectedSubject, className: selectedClass, approved: false, timestamp: new Date().toLocaleString() });
        localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests));
        showToast('‚úÖ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ, ‡§è‡§°‡§Æ‡§ø‡§® ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•ã‡§ó‡§æ');
        if (currentUser.username === 'admin') renderRequests();
    }

    function renderRequests() {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const pending = requests.filter(r => !r.approved);
        if (!pending.length) { requestListDiv.innerHTML = '<div class="history-item">‡§ï‡•ã‡§à ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç</div>'; return; }
        requestListDiv.innerHTML = pending.map((r, idx) => `
            <div class="request-item">
                <span>${r.username} - ${r.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${r.className})</span>
                <button class="btn" onclick="approveRequest(${idx})" style="padding:4px 16px;">‡§Æ‡§Ç‡§ú‡•Ç‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
            </div>`).join('');
    }

    window.approveRequest = function(pendingIdx) {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        let count = -1;
        for (let i=0; i<requests.length; i++) {
            if (!requests[i].approved) count++;
            if (count === pendingIdx) { requests[i].approved = true; break; }
        }
        localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests));
        showToast('‚úÖ ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§ø‡§§');
        renderRequests();
        checkApprovedVideo(selectedSubject);
    };

    function checkApprovedVideo(subject) {
        if (!currentUser) return;
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const approved = requests.find(r => r.subject === subject && r.className === selectedClass && r.approved);
        videoMessage.innerHTML = approved ? '<span style="color:lightgreen;">‚úÖ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§â‡§™‡§≤‡§¨‡•ç‡§ß! ‡§ö‡§≤‡§æ‡§è‡§Å.</span>' : '‡§ï‡•ã‡§à ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§®‡§π‡•Ä‡§Ç‡•§ "‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç" ‡§¶‡§¨‡§æ‡§è‡§Å‡•§';
    }

    function playVideo() {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const approved = requests.find(r => r.subject === selectedSubject && r.className === selectedClass && r.approved);
        if (approved || (currentUser && currentUser.username === 'admin')) {
            videoMessage.innerHTML = 'üé¨ [AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã] ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à... <i class="fas fa-sync fa-spin"></i> ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ç‡§ó (‡§Æ‡•â‡§ï)';
            showToast('üîä ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∂‡•Å‡§∞‡•Ç');
        } else showToast('‚ùå ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§™‡§π‡§≤‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç‡•§', 'error');
    }

    // ========== AI ‡§ü‡•Ç‡§≤‡•ç‡§∏ ==========
    const topicInput = document.getElementById('topicInput');
    const generateBtn = document.getElementById('generateBtn');
    const improveBtn = document.getElementById('improveBtn');
    const voiceSearchBtn = document.getElementById('voiceSearchBtn');
    const fileUpload = document.getElementById('fileUpload');
    const fileInfoArea = document.getElementById('fileInfoArea');
    const fileNameSpan = document.getElementById('fileName');
    const fileSizeSpan = document.getElementById('fileSize');
    const clearFileBtn = document.getElementById('clearFileBtn');
    const ocrProgress = document.getElementById('ocrProgress');
    const ocrFill = document.getElementById('ocrProgressFill');
    const imgPreviewBox = document.getElementById('imgPreviewBox');
    const videoPreviewBox = document.getElementById('videoPreviewBox');
    const previewImg = document.getElementById('previewImg');
    const videoPreview = document.getElementById('videoPreview');
    const outputArea = document.getElementById('outputArea');

    // ‡§µ‡•â‡§á‡§∏
    if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = 'hi-IN';
        recognition.continuous = false;
        recognition.onstart = () => showToast('üé§ ‡§¨‡•ã‡§≤‡§ø‡§è...', 'processing');
        recognition.onend = () => {};
        recognition.onresult = (e) => { topicInput.value = e.results[0][0].transcript; processAI(); };
        voiceSearchBtn.onclick = () => recognition.start();
    } else voiceSearchBtn.onclick = () => showToast('‚ùå ‡§µ‡•â‡§á‡§∏ ‡§∏‡§™‡•ã‡§∞‡•ç‡§ü ‡§®‡§π‡•Ä‡§Ç', 'error');

    // ‡§´‡§æ‡§á‡§≤ ‡§π‡•à‡§Ç‡§°‡§≤‡§ø‡§Ç‡§ó
    clearFileBtn.addEventListener('click', () => { fileUpload.value = ''; fileInfoArea.style.display = 'none'; imgPreviewBox.classList.remove('show'); videoPreviewBox.classList.remove('show'); });
    fileUpload.addEventListener('change', async (e) => {
        const file = e.target.files[0]; if (!file) return;
        fileNameSpan.textContent = file.name; fileSizeSpan.textContent = `(${(file.size/1024).toFixed(1)} KB)`; fileInfoArea.style.display = 'flex';
        if (file.type.startsWith('image/')) {
            previewImg.src = URL.createObjectURL(file); imgPreviewBox.classList.add('show');
            ocrProgress.style.display = 'block';
            try {
                const result = await Tesseract.recognize(file, 'hin+eng', { 
                    logger: m => { if (m.status === 'recognizing text') ocrFill.style.width = Math.round(m.progress*100)+'%'; } 
                });
                topicInput.value = result.data.text.trim().substring(0,200) || '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ';
                ocrProgress.style.display = 'none'; showToast('‚úÖ OCR ‡§∏‡§´‡§≤');
            } catch { ocrProgress.style.display = 'none'; showToast('‚ùå OCR ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø', 'error'); }
        } else if (file.type.startsWith('video/')) { 
            videoPreview.src = URL.createObjectURL(file); videoPreviewBox.classList.add('show'); topicInput.value = file.name; 
        } else topicInput.value = file.name;
    });

    // AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂ ‡§ú‡§®‡§∞‡•á‡§ü‡§∞
    function generateAISummary(topic) {
        let t = topic.toLowerCase();
        if (t.includes('‡§™‡•ç‡§∞‡§ï‡§æ‡§∂')) return "‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ: $$K_{\\text{max}} = hf - \\phi_0$$‡•§ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§";
        if (t.includes('‡§π‡•É‡§¶‡§Ø')) return "‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑, SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞, ‡§∞‡§ï‡•ç‡§§ ‡§™‡§Ç‡§™ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§";
        if (t.includes('‡§ó‡§£‡§ø‡§§')||t.includes('‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£')) return "‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£: $$x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$$";
        if (t.includes('rrb')) return "RRB NTPC: ‡§∏‡§æ‡§Æ‡§æ‡§®‡•ç‡§Ø ‡§ú‡•ç‡§û‡§æ‡§®, ‡§ó‡§£‡§ø‡§§, ‡§∞‡•Ä‡§ú‡§®‡§ø‡§Ç‡§ó‡•§";
        return `${topic} ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂: ‡§Ø‡§π ‡§ü‡•â‡§™‡§ø‡§ï ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§`;
    }

    function generateEasyModeText(topic) {
        let t = topic.toLowerCase();
        if (t.includes('‡§™‡•ç‡§∞‡§ï‡§æ‡§∂')) return "‡§ú‡§¨ ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ß‡§æ‡§§‡•Å ‡§™‡§∞ ‡§ó‡§ø‡§∞‡§§‡§æ ‡§π‡•à ‡§§‡•ã ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§® ‡§®‡§ø‡§ï‡§≤‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§á‡§∏‡•á ‡§´‡•ã‡§ü‡•ã‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡§ø‡§ï ‡§á‡§´‡•á‡§ï‡•ç‡§ü ‡§ï‡§π‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§´‡•â‡§∞‡•ç‡§Æ‡•Ç‡§≤‡§æ: K_max = hf - œÜ‚ÇÄ‡•§";
        if (t.includes('‡§π‡•É‡§¶‡§Ø')) return "‡§π‡•É‡§¶‡§Ø ‡§è‡§ï ‡§™‡§Ç‡§™ ‡§π‡•à, ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑, SA ‡§®‡•ã‡§° ‡§ß‡§°‡§º‡§ï‡§® ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§";
        if (t.includes('‡§ó‡§£‡§ø‡§§')) return "ax¬≤+bx+c=0 ‡§ï‡§æ ‡§π‡§≤: x = [-b ¬± ‚àö(b¬≤-4ac)]/2a ‡•§";
        return `${topic} ‡§ï‡•ã ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡•á‡§Ç: ‡§Æ‡•Å‡§ñ‡•ç‡§Ø ‡§¨‡§ø‡§Ç‡§¶‡•Å ‡§Ø‡§æ‡§¶ ‡§ï‡§∞‡•á‡§Ç‡•§`;
    }

    function processAI() {
        const topic = topicInput.value.trim(); if (!topic) return;
        const summary = generateAISummary(topic);
        outputArea.innerHTML = `<div class="deep-card" style="margin-top:10px; background:white; padding:15px; border-radius:20px;"><h3 style="color:var(--primary);">ü§ñ AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</h3><p>${summary}</p></div>`;
        if (window.renderMathInElement) renderMathInElement(outputArea);
    }

    function improveContent() {
        const topic = topicInput.value.trim(); if (!topic) { showToast('‚ùå ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç','error'); return; }
        const easy = generateEasyModeText(topic);
        const speechText = `‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ, ‡§∏‡•Å‡§®‡§ø‡§è: ${easy}`;
        outputArea.innerHTML += `<div class="deep-card" style="border-left:8px solid var(--primary); position:relative; background:white; padding:20px; border-radius:20px; margin-top:15px;">
            <div style="position:absolute; right:20px; top:20px; display:flex; gap:5px;">
                <button class="btn btn-icon" onclick="speakContent('${speechText.replace(/'/g, "\\'")}')"><i class="fas fa-volume-up"></i></button>
                <button class="btn btn-icon" onclick="stopSpeaking()"><i class="fas fa-stop"></i></button>
            </div>
            <h3><i class="fas fa-smile"></i> ‡§Ü‡§∏‡§æ‡§® ‡§Æ‡•ã‡§°</h3><p>${easy}</p>
        </div>`;
    }

    // ‡§µ‡•â‡§á‡§∏ ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤
    window.speakContent = function(text) {
        if (!window.speechSynthesis) return;
        window.speechSynthesis.cancel();
        const utter = new SpeechSynthesisUtterance(text); utter.lang = 'hi-IN'; utter.rate = 0.85;
        window.speechSynthesis.speak(utter);
    };
    window.stopSpeaking = () => window.speechSynthesis.cancel();

    // ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï (‡§Ø‡•Ç‡§ú‡§∞ ‡§∏‡•ç‡§™‡•á‡§∏‡§ø‡§´‡§ø‡§ï)
    function getNotes() { return JSON.parse(localStorage.getItem(getNotesKey()) || '[]'); }
    function saveNotes(notes) { localStorage.setItem(getNotesKey(), JSON.stringify(notes)); }

    function renderNotebookFromStorage(cat = 'all') {
        let notes = getNotes();
        // ‡§´‡§º‡§ø‡§≤‡•ç‡§ü‡§∞ ‡§ï‡§∞‡•á‡§Ç: ‡§™‡§π‡§≤‡•á category ‡§´‡§ø‡§∞ search (‡§Ö‡§ó‡§∞ search ‡§ñ‡§æ‡§≤‡•Ä ‡§π‡•à ‡§§‡•ã ‡§∏‡§¨)
        const searchTerm = noteSearchInput ? noteSearchInput.value.toLowerCase() : '';
        let filtered = cat === 'all' ? notes : notes.filter(n => n.category === cat);
        if (searchTerm) {
            filtered = filtered.filter(n => n.text.toLowerCase().includes(searchTerm));
        }
        if (!filtered.length) { notebookListDiv.innerHTML = '<div class="note-item">‡§ï‡•ã‡§à ‡§®‡•ã‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</div>'; return; }
        filtered.sort((a,b) => b.timestamp - a.timestamp);
        notebookListDiv.innerHTML = filtered.map(n => `
            <div class="note-item">
                <span><i class="fas fa-${n.category==='physics'?'atom':(n.category==='chemistry'?'flask':'dna')}"></i> ${n.text}</span>
                <button class="delete-note" onclick="deleteNote('${n.id}')"><i class="fas fa-trash"></i></button>
            </div>`).join('');
    }

    window.deleteNote = (id) => { 
        let notes = getNotes(); 
        notes = notes.filter(n => n.id !== id); 
        saveNotes(notes); 
        // ‡§´‡§ø‡§∞ ‡§∏‡•á ‡§∞‡•á‡§Ç‡§°‡§∞ ‡§ï‡§∞‡•á‡§Ç, ‡§Æ‡•å‡§ú‡•Ç‡§¶‡§æ ‡§ï‡•à‡§ü‡•á‡§ó‡§∞‡•Ä ‡§î‡§∞ ‡§∏‡§∞‡•ç‡§ö ‡§ï‡•á ‡§∏‡§æ‡§•
        const activeCat = document.querySelector('.cat-btn.active')?.dataset.cat || 'all';
        renderNotebookFromStorage(activeCat); 
    };

    document.getElementById('addNoteBtn').addEventListener('click', () => {
        const text = document.getElementById('newNoteText').value.trim();
        const category = document.getElementById('newNoteCategory').value;
        if (!text) { showToast('‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç', 'error'); return; }
        let notes = getNotes();
        const newNote = {
            id: 'note_' + Date.now() + Math.random(),
            text: text,
            category: category,
            timestamp: Date.now()
        };
        notes.push(newNote);
        saveNotes(notes);
        document.getElementById('newNoteText').value = '';
        const activeCat = document.querySelector('.cat-btn.active')?.dataset.cat || 'all';
        renderNotebookFromStorage(activeCat);
        showToast('‚úÖ ‡§®‡•ã‡§ü ‡§ú‡•Å‡§°‡§º ‡§ó‡§Ø‡§æ');
    });

    document.querySelectorAll('.cat-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.cat-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active');
        renderNotebookFromStorage(this.dataset.cat);
    }));

    // ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§∏‡§∞‡•ç‡§ö ‡§á‡§µ‡•á‡§Ç‡§ü
    if (noteSearchInput) {
        noteSearchInput.addEventListener('input', function() {
            const activeCat = document.querySelector('.cat-btn.active')?.dataset.cat || 'all';
            renderNotebookFromStorage(activeCat);
        });
    }

    document.getElementById('exportNotesBtn').addEventListener('click', () => {
        const data = JSON.stringify(getNotes(), null, 2);
        const a = document.createElement('a'); a.href = URL.createObjectURL(new Blob([data],{type:'application/json'})); a.download = 'notebook.json'; a.click();
    });

    // ========== ‡§®‡§Ø‡§æ: AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ==========
    const mediaTabs = document.querySelectorAll('.media-tab');
    const mediaContents = document.querySelectorAll('.media-content');
    
    mediaTabs.forEach(tab => {
        tab.addEventListener('click', () => {
            mediaTabs.forEach(t => t.classList.remove('active'));
            mediaContents.forEach(c => c.classList.remove('active'));
            tab.classList.add('active');
            document.getElementById(tab.dataset.media + '-tab').classList.add('active');
        });
    });
    
    // ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§∏‡•á‡§≤‡•á‡§ï‡•ç‡§∂‡§®
    document.querySelectorAll('.style-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            if (this.classList.contains('example-btn')) return; // example buttons handled separately
            this.parentElement.querySelectorAll('.style-btn').forEach(b => b.classList.remove('selected'));
            this.classList.add('selected');
        });
    });
    
    // ‡§∏‡•ç‡§≤‡§æ‡§á‡§°‡§∞ ‡§µ‡•à‡§≤‡•ç‡§Ø‡•Ç ‡§Ö‡§™‡§°‡•á‡§ü
    document.getElementById('cfgScale').addEventListener('input', (e) => {
        document.getElementById('cfgValue').textContent = e.target.value;
    });
    document.getElementById('steps').addEventListener('input', (e) => {
        document.getElementById('stepsValue').textContent = e.target.value;
    });
    
    // ‡§â‡§¶‡§æ‡§π‡§∞‡§£ ‡§¨‡§ü‡§®
    document.querySelectorAll('.example-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.getElementById('imagePrompt').value = this.dataset.prompt;
            showToast('‚úÖ ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§∏‡•á‡§ü ‡§π‡•ã ‡§ó‡§Ø‡§æ', 'success');
        });
    });
    
    // ‡§õ‡§µ‡§ø ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§°‡•á‡§Æ‡•ã)
    document.getElementById('generateImageBtn').addEventListener('click', () => {
        const prompt = document.getElementById('imagePrompt').value.trim();
        if (!prompt) { showToast('‚ùå ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç', 'error'); return; }
        
        const negative = document.getElementById('negativePrompt').value;
        const style = document.querySelector('#imageStyles .style-btn.selected')?.dataset.style || 'photorealistic';
        const cfg = document.getElementById('cfgScale').value;
        const steps = document.getElementById('steps').value;
        
        showToast('üñºÔ∏è AI ‡§õ‡§µ‡§ø ‡§¨‡§®‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...', 'processing');
        
        // ‡§°‡•á‡§Æ‡•ã ‡§ï‡•á ‡§≤‡§ø‡§è ‡§™‡•ç‡§∞‡•Ä‡§∏‡•á‡§ü ‡§á‡§Æ‡•á‡§ú ‡§¶‡§ø‡§ñ‡§æ‡§è‡§Å (‡§Ö‡§∏‡§≤‡•Ä AI ‡§®‡§π‡•Ä‡§Ç)
        setTimeout(() => {
            const imagesContainer = document.getElementById('generatedImages');
            
            // ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ ‡§ï‡•á ‡§Ö‡§®‡•Å‡§∏‡§æ‡§∞ ‡§Ö‡§≤‡§ó-‡§Ö‡§≤‡§ó ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞ ‡§á‡§Æ‡•á‡§ú
            const styleImages = {
                photorealistic: 'https://via.placeholder.com/300x200/b22222/ffffff?text=üì∏+‡§´‡•ã‡§ü‡•ã‡§∞‡§ø‡§Ø‡§≤‡§ø‡§∏‡•ç‡§ü‡§ø‡§ï',
                oilpainting: 'https://via.placeholder.com/300x200/8b4513/ffffff?text=üé®+‡§ë‡§Ø‡§≤+‡§™‡•á‡§Ç‡§ü‡§ø‡§Ç‡§ó',
                anime: 'https://via.placeholder.com/300x200/ff69b4/ffffff?text=üå∏+‡§è‡§®‡•Ä‡§Æ‡•á',
                watercolor: 'https://via.placeholder.com/300x200/4682b4/ffffff?text=üíß+‡§µ‡•â‡§ü‡§∞‡§ï‡§≤‡§∞',
                '3d': 'https://via.placeholder.com/300x200/2e8b57/ffffff?text=üßä+3D+‡§∞‡•á‡§Ç‡§°‡§∞',
                sketch: 'https://via.placeholder.com/300x200/708090/ffffff?text=‚úèÔ∏è+‡§∏‡•ç‡§ï‡•á‡§ö'
            };
            
            const imageUrl = styleImages[style] || styleImages.photorealistic;
            
            const imageHtml = `
                <div class="media-item">
                    <img src="${imageUrl}" alt="Generated Image">
                    <p class="prompt-text">"${prompt.substring(0, 50)}${prompt.length > 50 ? '...' : ''}"</p>
                    <p><small>‡§∂‡•à‡§≤‡•Ä: ${style} | CFG: ${cfg} | ‡§∏‡•ç‡§ü‡•á‡§™‡•ç‡§∏: ${steps}</small></p>
                    <button class="btn" style="margin-top:10px; padding:5px 15px;" onclick="showToast('üì• ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° ‡§∂‡•Å‡§∞‡•Ç (‡§°‡•á‡§Æ‡•ã)')">üì• ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
                </div>
            `;
            
            imagesContainer.innerHTML = imageHtml + imagesContainer.innerHTML;
            if (imagesContainer.children.length > 4) {
                imagesContainer.removeChild(imagesContainer.lastElementChild);
            }
            
            showToast('‚úÖ ‡§õ‡§µ‡§ø ‡§§‡•à‡§Ø‡§æ‡§∞! (‡§°‡•á‡§Æ‡•ã ‡§Æ‡•ã‡§°)', 'success');
        }, 2000);
    });
    
    // ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç (‡§°‡•á‡§Æ‡•ã)
    document.getElementById('generateVideoBtn').addEventListener('click', () => {
        const prompt = document.getElementById('videoPrompt').value.trim();
        if (!prompt) { showToast('‚ùå ‡§™‡•ç‡§∞‡•â‡§Æ‡•ç‡§™‡•ç‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç', 'error'); return; }
        
        const duration = document.getElementById('videoDuration').value;
        const style = document.querySelector('#videoStyles .style-btn.selected')?.dataset.style || 'cinematic';
        
        showToast('üé¨ AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ ‡§∞‡§π‡§æ ‡§π‡•à...', 'processing');
        
        setTimeout(() => {
            const videosContainer = document.getElementById('generatedVideos');
            
            // ‡§°‡•á‡§Æ‡•ã ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§™‡•ç‡§≤‡•á‡§∏‡§π‡•ã‡§≤‡•ç‡§°‡§∞
            const videoHtml = `
                <div class="media-item">
                    <video controls>
                        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4">
                    </video>
                    <p class="prompt-text">"${prompt.substring(0, 50)}${prompt.length > 50 ? '...' : ''}"</p>
                    <p><small>‡§Ö‡§µ‡§ß‡§ø: ${duration} ‡§∏‡•á‡§ï‡§Ç‡§° | ‡§∂‡•à‡§≤‡•Ä: ${style}</small></p>
                    <button class="btn" style="margin-top:10px; padding:5px 15px;" onclick="showToast('üì• ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§° (‡§°‡•á‡§Æ‡•ã)')">üì• ‡§°‡§æ‡§â‡§®‡§≤‡•ã‡§°</button>
                </div>
            `;
            
            videosContainer.innerHTML = videoHtml + videosContainer.innerHTML;
            if (videosContainer.children.length > 3) {
                videosContainer.removeChild(videosContainer.lastElementChild);
            }
            
            showToast('‚úÖ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§§‡•à‡§Ø‡§æ‡§∞! (‡§°‡•á‡§Æ‡•ã ‡§Æ‡•ã‡§°)', 'success');
        }, 3000);
    });

    // ========== ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ‡§´‡§Ç‡§ï‡•ç‡§∂‡§® ==========
    function initMockTest() {
        currentQuestionIndex = 0; userAnswers.fill(-1); timeLeft = 120; testActive = true;
        document.getElementById('submitTest').style.display = 'inline-flex';
        document.getElementById('testResult').style.display = 'none';
        startTimer(); showQuestion();
    }
    function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--; let mins = Math.floor(timeLeft/60), secs = timeLeft%60;
            document.getElementById('timer').innerText = `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            if (timeLeft <= 0) { clearInterval(timerInterval); submitMockTest(); }
        },1000);
    }
    function showQuestion() {
        if (!testActive) return;
        let q = mockQuestions[currentQuestionIndex];
        document.getElementById('questionText').innerHTML = `<strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${currentQuestionIndex+1}/${mockQuestions.length}:</strong> ${q.question}`;
        let opts = '';
        q.options.forEach((opt, idx) => {
            opts += `<div class="opt-btn ${userAnswers[currentQuestionIndex] === idx ? 'selected' : ''}" onclick="selectOption(${idx})">${String.fromCharCode(65+idx)}. ${opt}</div>`;
        });
        document.getElementById('optionsContainer').innerHTML = opts;
        document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
        document.getElementById('nextBtn').disabled = currentQuestionIndex === mockQuestions.length-1;
    }
    window.selectOption = function(idx) { if (!testActive) return; userAnswers[currentQuestionIndex] = idx; showQuestion(); };
    document.getElementById('prevBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex>0) { currentQuestionIndex--; showQuestion(); } });
    document.getElementById('nextBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex < mockQuestions.length-1) { currentQuestionIndex++; showQuestion(); } });
    document.getElementById('submitTest')?.addEventListener('click', submitMockTest);
    function submitMockTest() {
        clearInterval(timerInterval); testActive = false;
        let correct = userAnswers.reduce((acc, ans, i) => acc + (ans === mockQuestions[i].answer ? 1 : 0), 0);
        let percent = (correct / mockQuestions.length) * 100;
        document.getElementById('testResult').innerHTML = `<h3>‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h3><p>‡§∏‡§π‡•Ä: ${correct}/${mockQuestions.length} (${percent.toFixed(1)}%)</p><button class="btn" onclick="initMockTest()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏</button>`;
        document.getElementById('testResult').style.display = 'block';
        document.getElementById('submitTest').style.display = 'none';
    }

    // ‡§≤‡•â‡§ó‡§ø‡§® / ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü
    document.getElementById('loginBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const user = users.find(u => u.username === document.getElementById('loginUsername').value.trim() && u.password === document.getElementById('loginPassword').value.trim());
        if (user) { onLogin(user); } else showToast('‡§ó‡§≤‡§§ ‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°', 'error');
    });
    document.getElementById('signupBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const newU = document.getElementById('loginUsername').value.trim(); const newP = document.getElementById('loginPassword').value.trim();
        if (!newU || !newP) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡•á‡§Ç','error');
        if (users.find(u => u.username === newU)) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ ‡§Æ‡•å‡§ú‡•Ç‡§¶','error');
        users.push({ username: newU, password: newP }); localStorage.setItem(USERS_KEY, JSON.stringify(users)); showToast('‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§¨‡§®‡§æ, ‡§Ö‡§¨ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç');
    });

    function onLogin(user) {
        saveCurrentUser(user); usernameSpan.innerText = user.username; userInfoDiv.style.display = 'flex'; loginArea.style.display = 'none'; dashboardArea.style.display = 'block';
        if (user.username === 'admin') { adminPanel.style.display = 'block'; renderRequests(); } else adminPanel.style.display = 'none';
        updateNotesAndUI(); renderHistory(); renderNotebookFromStorage(); initMockTest();
    }

    document.getElementById('logoutBtn').addEventListener('click', () => {
        currentUser = null; localStorage.removeItem(CURRENT_USER_KEY);
        userInfoDiv.style.display = 'none'; loginArea.style.display = 'block'; dashboardArea.style.display = 'none';
    });

    // ‡§á‡§µ‡•á‡§Ç‡§ü ‡§≤‡§ø‡§∏‡§®‡§∞
    document.querySelectorAll('.class-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.class-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedClass = this.dataset.class; updateNotesAndUI();
    }));
    document.querySelectorAll('.sub-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.sub-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedSubject = this.dataset.subject; updateNotesAndUI();
    }));
    document.getElementById('playVideoBtn').addEventListener('click', playVideo);
    document.getElementById('requestVideoBtn').addEventListener('click', requestVideo);
    generateBtn.addEventListener('click', processAI);
    improveBtn.addEventListener('click', improveContent);

    // ‡§Ö‡§ó‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§≤‡•â‡§ó‡§ø‡§® ‡§π‡•ã
    if (currentUser) onLogin(currentUser);
})();
</script>
</body>
</html>