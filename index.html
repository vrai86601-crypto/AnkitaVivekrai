<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI ‡§∏‡•ç‡§ü‡§°‡•Ä ‚Äì ‡§¨‡§π‡•Å‡§≠‡§æ‡§∑‡•Ä‡§Ø ‡§Æ‡§Ç‡§°‡§≤‡•Ä</title>
    <!-- Fonts & Icons -->
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Devanagari:wght@400;500;600;700&family=Montserrat:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- KaTeX (‡§ó‡§£‡§ø‡§§) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script>
    <!-- Tesseract OCR -->
    <script src="https://unpkg.com/tesseract.js@5.0.3/dist/tesseract.min.js"></script>
    <!-- PDF export (html2pdf) optional -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* ---------- ‡§Æ‡•Ç‡§≤ ‡§∂‡•à‡§≤‡•Ä (‡§•‡•Ä‡§Æ: ‡§≤‡§æ‡§≤ + ‡§ï‡§æ‡§≤‡§æ) ---------- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary: #b22222;          /* ‡§≤‡§æ‡§≤ */
            --primary-dark: #8b1a1a;
            --dark: #1e1e1e;              /* ‡§ï‡§æ‡§≤‡§æ */
            --paper: #fffcf7;
            --border-radius: 24px;
            --shadow: 0 15px 30px -12px rgba(0,0,0,0.2);
            --glass: rgba(255, 255, 255, 0.9);
        }
        body {
            background: linear-gradient(145deg, #d6cbbd, #e6ddd2);
            font-family: 'Poppins', 'IBM Plex Sans Devanagari', sans-serif;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
        }
        .app-container {
            max-width: 1400px;
            width: 100%;
            background: var(--paper);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            border: 2px solid var(--primary);
            overflow: hidden;
        }
        /* Header */
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 25px;
            background: var(--glass);
            backdrop-filter: blur(10px);
            border-bottom: 3px solid var(--primary);
            position: sticky;
            top: 0;
            z-index: 1000;
            flex-wrap: wrap;
            gap: 12px;
        }
        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .brand-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            background: linear-gradient(90deg, var(--primary), var(--dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 700;
        }
        .ai-icon { color: var(--primary); font-size: 1.8rem; }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        /* ‡§≠‡§æ‡§∑‡§æ ‡§∏‡•ç‡§µ‡§ø‡§ö (‡§ü‡•â‡§ó‡§≤) */
        .lang-switch {
            display: flex;
            align-items: center;
            background: var(--dark);
            padding: 4px;
            border-radius: 30px;
            border: 1px solid var(--primary);
            cursor: pointer;
            position: relative;
            width: 100px;
            height: 38px;
        }
        .lang-btn {
            flex: 1;
            text-align: center;
            font-size: 0.85rem;
            font-weight: 700;
            color: #fff;
            z-index: 2;
            transition: 0.3s;
            line-height: 30px;
        }
        .lang-slider {
            position: absolute;
            width: 46px;
            height: 30px;
            background: var(--primary);
            border-radius: 25px;
            transition: 0.3s;
            left: 4px;
            top: 4px;
        }
        .lang-switch.eng .lang-slider {
            left: 50px;
        }

        .search-box {
            background: #eee;
            padding: 6px 15px;
            border-radius: 25px;
            display: flex;
            align-items: center;
            border: 1px solid var(--primary);
        }
        .search-box input {
            border: none;
            background: transparent;
            outline: none;
            padding-left: 8px;
            min-width: 180px;
            font-family: 'Poppins', sans-serif;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--dark);
            color: white;
            padding: 5px 15px 5px 10px;
            border-radius: 40px;
            border: 2px solid var(--primary);
        }
        .btn-logout {
            background: var(--primary);
            color: white;
            border: none;
            padding: 5px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            transition: 0.2s;
            border: 1px solid white;
        }
        .btn-logout:hover { background: #8b1a1a; transform: scale(1.02); }

        /* AI ‡§á‡§Ç‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§ï‡•ç‡§∂‡§® */
        .ai-intro { padding: 30px 25px 10px 25px; }
        .intro-card {
            background: white;
            padding: 25px;
            border-radius: 20px;
            border-left: 8px solid var(--primary);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .intro-card h2 { color: var(--primary); margin-bottom: 15px; font-weight: 600; }
        .ai-features {
            list-style: none; display: flex; gap: 25px; margin-top: 20px; flex-wrap: wrap;
        }
        .ai-features li {
            background: #f9f9f9; padding: 10px 18px; border-radius: 40px; font-size: 0.95rem; border: 1px solid var(--primary);
        }
        .ai-features i { color: var(--primary); margin-right: 8px; }

        /* ‡§¨‡§æ‡§ï‡•Ä ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤ (‡§™‡•Å‡§∞‡§æ‡§®‡•á ‡§∏‡•á) */
        .container-main { padding: 20px 25px 25px; }
        .section-title { color: var(--primary); margin:25px 0 15px; border-left:8px solid var(--primary); padding-left:15px; }
        .class-grid, .subject-grid { display:flex; gap:12px; flex-wrap:wrap; margin-bottom:25px; }
        .class-btn, .sub-btn { background:white; border:2px solid var(--dark); padding:12px 24px; border-radius:40px; font-weight:600; cursor:pointer; }
        .class-btn.active, .sub-btn.active { background:var(--primary); color:white; border-color:var(--primary); }
        .notes-card { background:var(--dark); color:white; border-radius:28px; padding:25px; margin:20px 0; border:2px solid var(--primary); box-shadow:5px 5px 0 var(--primary-dark); }
        .heart-diagram { display:none; flex-direction:column; align-items:center; margin:20px 0; color:black; background:#f0f0f0; padding:15px; border-radius:30px; }
        .heart-chambers { display:grid; grid-template-columns:1fr 1fr; gap:15px; max-width:300px; margin:10px auto; }
        .chamber { background:var(--primary); color:white; padding:15px; border-radius:50%; text-align:center; font-weight:bold; box-shadow:4px 4px 0 var(--dark); }
        .video-section { background:white; border-radius:28px; padding:25px; border:2px solid var(--primary); margin:25px 0; }
        .mock-player { background:#2d2d2d; border-radius:20px; padding:40px; text-align:center; color:white; margin:15px 0; border:2px solid var(--primary); }
        .history-item, .request-item { background:white; border-radius:40px; padding:12px 20px; margin-bottom:12px; border-left:12px solid var(--primary); display:flex; justify-content:space-between; align-items:center; box-shadow:3px 3px 0 var(--dark); }
        .badge { background:var(--primary); color:white; padding:4px 12px; border-radius:30px; font-size:0.8rem; }
        .ai-card { background:white; border-radius:28px; padding:25px; border:2px solid var(--primary); margin:20px 0; }
        .input-row { display:flex; gap:12px; flex-wrap:wrap; margin-bottom:20px; }
        .input-row input { flex:1; min-width:250px; padding:14px 22px; border-radius:50px; border:2px solid var(--dark); font-size:1rem; }
        .file-zone { background:#f0ebe2; border-radius:40px; padding:16px 20px; display:flex; align-items:center; flex-wrap:wrap; gap:15px; border:2px dashed var(--primary); margin:15px 0; }
        .file-info { background:white; padding:8px 16px; border-radius:40px; display:flex; align-items:center; gap:12px; border:2px solid var(--dark); }
        .progress-bar { height:8px; background:#e0d6cc; border-radius:10px; overflow:hidden; width:100%; margin-top:12px; display:none; }
        .progress-fill { height:100%; background:var(--primary); transition:width 0.2s; }
        .preview-box { background:white; border:2px solid var(--dark); border-radius:20px; padding:10px; max-width:200px; display:none; }
        .preview-box.show { display:block; }
        .toast { background:var(--dark); color:white; padding:12px 20px; border-radius:50px; display:none; margin:15px 0; position:fixed; bottom:20px; right:20px; z-index:9999; }
        .notebook-grid { background:#ffeede; border-radius:30px; padding:20px; border:3px solid var(--primary); min-height:150px; }
        .note-item { background:white; border-radius:40px; padding:12px 18px; margin-bottom:10px; border-left:12px solid var(--primary); display:flex; justify-content:space-between; align-items:center; }
        .delete-note { background:none; border:none; color:var(--primary); font-size:1.3rem; cursor:pointer; }
        .category-filter { display:flex; gap:10px; flex-wrap:wrap; margin-bottom:15px; }
        .cat-btn { background:transparent; border:2px solid var(--dark); padding:6px 20px; border-radius:40px; cursor:pointer; }
        .cat-btn.active { background:var(--primary); color:white; border-color:var(--primary); }
        .test-card { background:var(--dark); color:white; border-radius:28px; padding:25px; margin:20px 0; }
        .options-grid { display:grid; grid-template-columns:repeat(2,1fr); gap:10px; margin:20px 0; }
        .opt-btn { background:#3a3a3a; border:2px solid var(--primary); padding:12px; border-radius:40px; cursor:pointer; color:white; }
        .opt-btn.selected { background:var(--primary); }
        .media-creator-card { background:linear-gradient(145deg, #ffffff, #f8f4ed); border-radius:28px; padding:25px; border:3px solid var(--primary); margin:30px 0; box-shadow:8px 8px 0 var(--dark); }
        .media-tabs { display:flex; gap:10px; margin-bottom:20px; border-bottom:2px solid var(--primary); padding-bottom:10px; }
        .media-tab { padding:10px 25px; border-radius:40px; cursor:pointer; font-weight:600; background:white; border:2px solid var(--dark); }
        .media-tab.active { background:var(--primary); color:white; border-color:var(--primary); }
        .media-content { display:none; }
        .media-content.active { display:block; }
        .style-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(120px,1fr)); gap:10px; margin:15px 0; }
        .style-btn { background:white; border:2px solid var(--dark); padding:8px 12px; border-radius:30px; cursor:pointer; text-align:center; font-size:0.9rem; }
        .style-btn.selected { background:var(--primary); color:white; border-color:var(--primary); }
        .generated-media { display:grid; grid-template-columns:repeat(auto-fill, minmax(200px,1fr)); gap:20px; margin:20px 0; }
        .media-item { background:var(--dark); border-radius:20px; padding:15px; color:white; text-align:center; border:2px solid var(--primary); }
        .media-item img, .media-item video { width:100%; border-radius:15px; margin-bottom:10px; border:2px solid var(--primary); }
        .footer { margin-top:30px; text-align:center; color:#5f4e3c; padding-bottom:20px; }
        .login-card { background:white; border-radius:28px; padding:30px; max-width:400px; margin:30px auto; border:2px solid var(--primary); box-shadow:6px 6px 0 var(--dark); }
        #google_translate_element { margin-top:10px; text-align:center; background:white; border-radius:40px; padding:5px; border:2px solid var(--primary); width:fit-content; margin-left:auto; margin-right:auto; }
        .goog-te-gadget-simple { border:none !important; background:transparent !important; }
        .visually-hidden { position:absolute; left:-9999px; }
        @media (max-width:700px) {
            .options-grid { grid-template-columns:1fr; }
            .style-grid { grid-template-columns:repeat(2,1fr); }
            .header-right { width:100%; justify-content:center; }
        }
    </style>
</head>
<body>
<div class="app-container">
    <!-- ‡§®‡§Ø‡§æ ‡§π‡•á‡§°‡§∞: ‡§≠‡§æ‡§∑‡§æ ‡§ü‡•â‡§ó‡§≤ + ‡§ó‡•Ç‡§ó‡§≤ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§≤‡•á‡§ü (‡§µ‡•à‡§ï‡§≤‡•ç‡§™‡§ø‡§ï) -->
    <header class="header">
        <div class="logo">
            <i class="fas fa-microchip ai-icon"></i> 
            <span class="brand-name" id="brandName">‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI Study</span>
        </div>
        <div class="header-right">
            <!-- ‡§≠‡§æ‡§∑‡§æ ‡§∏‡•ç‡§µ‡§ø‡§ö (HI/EN) -->
            <div class="lang-switch" id="langToggle" onclick="toggleLanguage()">
                <div class="lang-slider"></div>
                <div class="lang-btn" id="langHi">HI</div>
                <div class="lang-btn" id="langEn">EN</div>
            </div>

            <div class="search-box" id="globalSearch">
                <i class="fas fa-search"></i>
                <input type="text" placeholder="AI ‡§ü‡•â‡§™‡§ø‡§ï ‡§ñ‡•ã‡§ú‡•á‡§Ç..." id="globalSearchInput">
            </div>
            
            <div id="userInfo" class="user-info" style="display: none;">
                <span class="user-tag"><i class="fas fa-user-graduate"></i> <span id="usernameDisplay"></span></span>
                <button class="btn-logout" id="logoutBtn">‡§≤‡•â‡§ó‡§Ü‡§â‡§ü</button>
            </div>
        </div>
    </header>

    <!-- ‡§ó‡•Ç‡§ó‡§≤ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§≤‡•á‡§ü (‡§õ‡§ø‡§™‡§æ ‡§π‡•Å‡§Ü ‡§Ø‡§æ ‡§Ö‡§≤‡§ó ‡§∏‡•á, ‡§≤‡•á‡§ï‡§ø‡§® ‡§â‡§™‡§≤‡§¨‡•ç‡§ß) -->
    <div id="google_translate_element" style="margin: 5px auto; text-align: center;"></div>

    <!-- login area -->
    <div id="loginArea" class="login-card">
        <h2><i class="fas fa-lock"></i> <span id="loginHeading">‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂</span></h2>
        <label for="loginUsername" class="visually-hidden">‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ</label>
        <input type="text" id="loginUsername" placeholder="‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ (‡§ú‡•à‡§∏‡•á: ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ)" value="‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ">
        <label for="loginPassword" class="visually-hidden">‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°</label>
        <input type="password" id="loginPassword" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°" value="123">
        <div class="flex-row">
            <button class="btn btn-primary" id="loginBtn" style="background:var(--primary);border:none;color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-sign-in-alt"></i> <span id="loginBtnText">‡§≤‡•â‡§ó‡§ø‡§®</span></button>
            <button class="btn" id="signupBtn" style="background:var(--dark);color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-user-plus"></i> <span id="signupBtnText">‡§∏‡§æ‡§á‡§®‡§Ö‡§™</span></button>
        </div>
        <p style="margin-top:15px;">üîë admin/admin (‡§è‡§°‡§Æ‡§ø‡§®)  |  ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ/123 (‡§°‡•á‡§Æ‡•ã)</p>
    </div>

    <!-- main dashboard -->
    <div id="dashboardArea" style="display: none;">
        <!-- AI ‡§á‡§Ç‡§ü‡•ç‡§∞‡•ã ‡§∏‡•á‡§ï‡•ç‡§∂‡§® -->
        <div class="ai-intro">
            <div class="intro-card">
                <h2 id="introHeading">What is Artificial Intelligence?</h2>
                <p id="introText">
                    <strong>Artificial Intelligence (AI)</strong> is the sophisticated simulation of human cognition by computer systems. It empowers machines to not only <em>learn</em> from data and <em>reason</em> through complex problems but also to <em>perceive</em> environments and execute <em>autonomous decisions</em>.
                </p>
                <ul class="ai-features">
                    <li id="feature1"><i class="fas fa-brain"></i> <strong>Narrow AI:</strong> Designed for specific tasks like language processing.</li>
                    <li id="feature2"><i class="fas fa-rocket"></i> <strong>General AI:</strong> Future frontier aiming for human-level versatility.</li>
                </ul>
            </div>
        </div>

        <div class="container-main">
            <!-- ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§î‡§∞ ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡§Ø‡§® (‡§π‡§ø‡§Ç‡§¶‡•Ä/‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡§º‡•Ä ‡§Æ‡•á‡§Ç ‡§π‡§æ‡§∞‡•ç‡§°‡§ï‡•ã‡§°‡•á‡§° ‡§®‡§π‡•Ä‡§Ç; ‡§¨‡§ü‡§® ‡§ü‡•á‡§ï‡•ç‡§∏‡•ç‡§ü ‡§¨‡§¶‡§≤‡•á‡§Ç‡§ó‡•á) -->
            <h3 class="section-title" id="classTitle"><i class="fas fa-graduation-cap"></i> ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
            <div class="class-grid" id="classGrid">
                <button class="class-btn" data-class="9" id="class9">‡§ï‡§ï‡•ç‡§∑‡§æ 9</button>
                <button class="class-btn" data-class="10" id="class10">‡§ï‡§ï‡•ç‡§∑‡§æ 10</button>
                <button class="class-btn" data-class="11" id="class11">‡§ï‡§ï‡•ç‡§∑‡§æ 11</button>
                <button class="class-btn active" data-class="12" id="class12">‡§ï‡§ï‡•ç‡§∑‡§æ 12</button>
            </div>

            <h3 class="section-title" id="subjectTitle"><i class="fas fa-book-open"></i> ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç</h3>
            <div class="subject-grid" id="subjectGrid">
                <button class="sub-btn active" data-subject="physics" id="subPhysics">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</button>
                <button class="sub-btn" data-subject="chemistry" id="subChemistry">‡§∞‡§∏‡§æ‡§Ø‡§®</button>
                <button class="sub-btn" data-subject="maths" id="subMaths">‡§ó‡§£‡§ø‡§§</button>
                <button class="sub-btn" data-subject="biology" id="subBiology">‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®</button>
            </div>

            <!-- ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§ï‡§æ‡§∞‡•ç‡§° (‡§°‡§æ‡§Ø‡§®‡§æ‡§Æ‡§ø‡§ï) -->
            <div class="notes-card" id="notesCard">
                <h3><i class="fas fa-sticky-note"></i> <span id="subjectName">‡§≠‡•å‡§§‡§ø‡§ï‡•Ä</span> - <span id="notesLabel">‡§Æ‡•Ç‡§≤ ‡§®‡•ã‡§ü‡•ç‡§∏</span></h3>
                <div id="notesContent" style="white-space: pre-line;"></div>
                <div id="biologyDiagram" class="heart-diagram">
                    <h4 style="color: var(--primary);">‚ù§Ô∏è <span id="heartTitle">‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ</span></h4>
                    <div class="heart-chambers">
                        <div class="chamber" id="chamberRA">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Right Atrium)</small></div>
                        <div class="chamber" id="chamberLA">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Left Atrium)</small></div>
                        <div class="chamber" id="chamberRV">‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Right Ventricle)</small></div>
                        <div class="chamber" id="chamberLV">‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Left Ventricle)</small></div>
                    </div>
                    <p id="saNodeText"><i class="fas fa-arrow-right"></i> SA ‡§®‡•ã‡§° (‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞) ‡§¶‡§æ‡§è‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§</p>
                </div>
            </div>

            <!-- AI ‡§ü‡•Ç‡§≤‡•ç‡§∏ -->
            <div class="ai-card">
                <h3 style="color:var(--primary);"><i class="fas fa-microchip"></i> <span id="aiHelperTitle">AI ‡§∏‡§π‡§æ‡§Ø‡§ï ‚Äì ‡§Ö‡§™‡§®‡§æ ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç</span></h3>
                <div class="input-row">
                    <input type="text" id="topicInput" placeholder="‡§ú‡•à‡§∏‡•á: ‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ, ‡§π‡•É‡§¶‡§Ø, ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£..." value="‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ">
                    <button class="btn btn-primary" id="generateBtn" style="background:var(--primary);border:none;color:white;padding:12px 25px;border-radius:40px;"><i class="fas fa-magic"></i> <span id="summaryBtn">‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</span></button>
                    <button class="btn btn-icon" id="improveBtn" style="background:var(--dark);color:white;padding:12px;border-radius:40px;" title="‡§Ü‡§∏‡§æ‡§® ‡§Æ‡•ã‡§°"><i class="fas fa-smile"></i></button>
                    <button class="btn btn-icon" id="voiceSearchBtn" style="background:var(--dark);color:white;padding:12px;border-radius:40px;" title="‡§µ‡•â‡§á‡§∏ ‡§∏‡§∞‡•ç‡§ö"><i class="fas fa-microphone-alt"></i></button>
                </div>
                <!-- ‡§¨‡§æ‡§ï‡•Ä AI ‡§≠‡§æ‡§ó (‡§´‡§æ‡§á‡§≤, OCR, ‡§Ü‡§â‡§ü‡§™‡•Å‡§ü) ‡§µ‡§π‡•Ä ‡§∞‡§π‡•á‡§ó‡§æ -->
                <div class="file-zone" id="fileDropZone">
                    <i class="fas fa-cloud-upload-alt" style="font-size:2rem; color:var(--primary);"></i>
                    <div style="flex:1;" id="fileZoneText">‡§´‡•ã‡§ü‡•ã/PDF/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç</div>
                    <label for="fileUpload" class="btn" style="background:var(--primary); color:white; padding:10px 22px; border-radius:40px;"><i class="fas fa-folder-open"></i> <span id="browseBtn">‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç</span></label>
                    <input type="file" id="fileUpload" hidden accept="image/*,application/pdf,video/*,.txt">
                </div>
                <div id="fileInfoArea" class="file-info" style="display:none; margin-top:10px;">
                    <i class="fas fa-file"></i> <span id="fileName"></span> <span id="fileSize"></span>
                    <button class="clear-file" id="clearFileBtn" style="background:none;border:none;color:red;"><i class="fas fa-times-circle"></i></button>
                </div>
                <div class="progress-bar" id="ocrProgress"><div class="progress-fill" id="ocrProgressFill"></div></div>
                <div class="preview-container" style="display: flex; gap:10px; margin-top:10px;">
                    <div class="preview-box" id="imgPreviewBox"><img id="previewImg" src="#"></div>
                    <div class="preview-box" id="videoPreviewBox"><video id="videoPreview" controls></video></div>
                </div>
                <div id="outputArea"></div>
            </div>

            <!-- AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ (‡§°‡•á‡§Æ‡•ã) -->
            <div class="media-creator-card">
                <h2 style="color:var(--primary); display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-magic"></i> <span id="mediaTitle">AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞</span>
                    <span style="background: var(--primary); color: white; padding: 4px 15px; border-radius: 40px; font-size: 0.9rem;" id="demoTag">‡§°‡•á‡§Æ‡•ã</span>
                </h2>
                <p id="mediaDesc">‡§Ö‡§™‡§®‡•á ‡§™‡§¢‡§º‡§æ‡§à ‡§ï‡•á ‡§ü‡•â‡§™‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§õ‡§µ‡§ø‡§Ø‡§æ‡§Å ‡§î‡§∞ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ‡§è‡§Å‡•§</p>
                <!-- ‡§ü‡•à‡§¨ ‡§Ü‡§¶‡§ø ‡§™‡§π‡§≤‡•á ‡§ú‡•à‡§∏‡•á -->
                <div class="media-tabs">
                    <div class="media-tab active" data-media="image" id="tabImage">üñºÔ∏è ‡§õ‡§µ‡§ø ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</div>
                    <div class="media-tab" data-media="video" id="tabVideo">üé¨ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç</div>
                </div>
                <!-- ‡§¨‡§æ‡§ï‡•Ä ‡§ï‡§Ç‡§ü‡•á‡§Ç‡§ü (‡§õ‡§µ‡§ø/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã) ‡§™‡•Ç‡§∞‡•ç‡§µ‡§µ‡§§ -->
                <!-- ... (‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§õ‡•ã‡§°‡§º‡§æ, ‡§™‡§∞ ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§ï‡•ã‡§° ‡§Æ‡•á‡§Ç ‡§∞‡§π‡•á‡§ó‡§æ) -->
                <div class="media-content active" id="image-tab">...</div>
                <div class="media-content" id="video-tab">...</div>
            </div>

            <!-- ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§≠‡§æ‡§ó -->
            <div class="video-section">
                <h3 style="color:var(--primary);"><i class="fas fa-video"></i> <span id="videoTitle">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡§∞)</span></h3>
                <div class="mock-player" id="videoPlaceholder">
                    <i class="fas fa-play-circle" style="font-size:3rem; color:var(--primary);"></i>
                    <p id="videoMessage">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§≤‡•ã‡§° ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è 'AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å' ‡§¶‡§¨‡§æ‡§è‡§Å</p>
                </div>
                <div class="flex-row" style="justify-content:center;">
                    <button class="btn" id="playVideoBtn" style="background:var(--primary);color:white;border:none;padding:12px 25px;border-radius:40px;"><i class="fas fa-play"></i> <span id="playBtn">AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å</span></button>
                    <button class="btn" id="requestVideoBtn" style="background:var(--dark);color:white;border:none;padding:12px 25px;border-radius:40px;"><i class="fas fa-cloud-upload-alt"></i> <span id="requestBtn">‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç</span></button>
                </div>
            </div>

            <!-- ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü -->
            <div class="test-card" id="mockTest">
                <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap;">
                    <h3><i class="fas fa-pencil-alt"></i> <span id="testTitle">‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (RRB ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤)</span></h3>
                    <div class="timer" id="timer" style="background:var(--primary); padding:8px 20px; border-radius:40px;">02:00</div>
                </div>
                <div id="testArea">
                    <div id="questionText" style="margin:15px 0;">‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</div>
                    <div class="options-grid" id="optionsContainer"></div>
                    <div class="test-footer" style="display:flex; gap:10px; justify-content:center;">
                        <button class="btn" id="prevBtn" disabled><i class="fas fa-arrow-left"></i> <span id="prevText">‡§™‡§ø‡§õ‡§≤‡§æ</span></button>
                        <button class="btn" id="nextBtn"><span id="nextText">‡§Ö‡§ó‡§≤‡§æ</span> <i class="fas fa-arrow-right"></i></button>
                        <button class="btn btn-primary" id="submitTest"><span id="submitText">‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç</span></button>
                    </div>
                </div>
                <div id="testResult" class="result-box" style="background:var(--primary); border-radius:20px; padding:20px; margin-top:20px; display:none;"></div>
            </div>

            <!-- ‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï -->
            <h3 class="section-title"><i class="fas fa-notebook"></i> <span id="notebookTitle">‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï</span></h3>
            <div class="category-filter">
                <button class="cat-btn active" data-cat="all" id="catAll">‡§∏‡§≠‡•Ä</button>
                <button class="cat-btn" data-cat="physics" id="catPhysics">‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏</button>
                <button class="cat-btn" data-cat="chemistry" id="catChemistry">‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</button>
                <button class="cat-btn" data-cat="biology" id="catBiology">‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä</button>
            </div>
            <div style="margin-bottom: 15px;">
                <input type="text" id="noteSearchInput" placeholder="üîç ‡§®‡•ã‡§ü‡•ç‡§∏ ‡§Æ‡•á‡§Ç ‡§ñ‡•ã‡§ú‡•á‡§Ç..." style="width:100%; padding:12px 20px; border-radius:40px; border:2px solid var(--primary);">
            </div>
            <div class="notebook-grid" id="notebookList"></div>
            <div style="display: flex; gap:10px; margin-top:15px;">
                <input type="text" id="newNoteText" placeholder="‡§®‡§Ø‡§æ ‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç..." style="flex:1; padding:12px; border-radius:40px; border:2px solid var(--dark);">
                <select id="newNoteCategory" style="padding:12px; border-radius:40px; border:2px solid var(--dark);">
                    <option value="physics">‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏</option>
                    <option value="chemistry">‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä</option>
                    <option value="biology">‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä</option>
                </select>
                <button class="btn btn-primary" id="addNoteBtn" style="background:var(--primary);border:none;color:white;padding:12px 20px;border-radius:40px;"><i class="fas fa-plus"></i> <span id="addBtn">‡§ú‡•ã‡§°‡§º‡•á‡§Ç</span></button>
            </div>
            <button class="btn" id="exportNotesBtn" style="margin:15px 0;background:var(--dark);color:white;border:none;padding:10px 20px;border-radius:40px;"><i class="fas fa-download"></i> <span id="exportBtn">‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü</span></button>

            <!-- ‡§á‡§§‡§ø‡§π‡§æ‡§∏ -->
            <h3 class="section-title"><i class="fas fa-history"></i> <span id="historyTitle">‡§Æ‡•á‡§∞‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ (‡§¶‡•á‡§ñ‡•á ‡§ó‡§è ‡§µ‡§ø‡§∑‡§Ø)</span></h3>
            <div id="historyList" class="history-list"></div>

            <!-- ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡•à‡§®‡§≤ -->
            <div id="adminPanel" style="display: none; margin-top: 25px; border-top: 3px dashed var(--primary); padding-top: 20px;">
                <h3 class="section-title"><i class="fas fa-check-double"></i> <span id="adminTitle">‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï : ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≤‡§Ç‡§¨‡§ø‡§§</span></h3>
                <div id="requestList"></div>
            </div>

            <!-- ‡§ü‡•ã‡§∏‡•ç‡§ü -->
            <div class="toast" id="toast"></div>
        </div> <!-- container-main end -->
    </div> <!-- dashboard end -->

    <div class="footer">‡§≤‡§æ‡§≤ & ‡§ï‡§æ‡§≤‡§æ ‡§•‡•Ä‡§Æ ¬∑ AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ (‡§°‡•á‡§Æ‡•ã) ¬∑ ‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡§®‡§æ</div>
</div>

<!-- ‡§ó‡•Ç‡§ó‡§≤ ‡§ü‡•ç‡§∞‡§æ‡§Ç‡§∏‡§≤‡•á‡§ü ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü -->
<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({pageLanguage: 'hi'}, 'google_translate_element');
}
</script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

<!-- ‡§∏‡§æ‡§∞‡§æ ‡§ú‡§æ‡§µ‡§æ‡§∏‡•ç‡§ï‡•ç‡§∞‡§ø‡§™‡•ç‡§ü (‡§Æ‡§∞‡•ç‡§ú) -->
<script>
(function() {
    // ==================== ‡§°‡•á‡§ü‡§æ ‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§ú ‡§ï‡•Ä ====================
    const USERS_KEY = 'studyDost_users';
    const CURRENT_USER_KEY = 'studyDost_currentUser';
    const HISTORY_KEY = 'studyDost_history';
    const REQUESTS_KEY = 'studyDost_videoRequests';

    function getNotesKey() { return currentUser ? `notes_${currentUser.username}` : 'notes_default'; }

    if (!localStorage.getItem(USERS_KEY)) {
        localStorage.setItem(USERS_KEY, JSON.stringify([
            { username: '‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ', password: '123' },
            { username: '‡§∞‡§æ‡§π‡•Å‡§≤', password: '123' },
            { username: 'admin', password: 'admin' }
        ]));
    }
    if (!localStorage.getItem(REQUESTS_KEY)) localStorage.setItem(REQUESTS_KEY, JSON.stringify([]));
    if (!localStorage.getItem(HISTORY_KEY)) localStorage.setItem(HISTORY_KEY, JSON.stringify([]));

    // ==================== ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§µ‡•à‡§∞‡§ø‡§è‡§¨‡§≤ ====================
    let currentUser = JSON.parse(localStorage.getItem(CURRENT_USER_KEY) || 'null');
    let selectedClass = '12';
    let selectedSubject = 'physics';
    let currentLang = 'hi'; // hi / en

    // ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü
    const mockQuestions = [
        { question: '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ ‡§Æ‡•á‡§Ç ‡§ß‡§æ‡§§‡•Å ‡§∏‡•á ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§® ‡§â‡§§‡•ç‡§∏‡§∞‡•ç‡§ú‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§µ‡§∂‡•ç‡§Ø‡§ï ‡§π‡•à?', options: ['‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§§‡•Ä‡§µ‡•ç‡§∞‡§§‡§æ', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§∞‡§Ç‡§ó', '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§ï‡§æ ‡§ß‡•ç‡§∞‡•Å‡§µ‡§£'], answer: 1 },
        { question: '‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§ï‡§æ ‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞ ‡§ï‡•å‡§® ‡§∏‡§æ ‡§π‡•à?', options: ['AV ‡§®‡•ã‡§°', 'SA ‡§®‡•ã‡§°', '‡§¨‡§Ç‡§°‡§≤ ‡§ë‡§´ ‡§π‡§ø‡§ú', '‡§™‡§∞‡•ç‡§ï‡§ø‡§Ç‡§ú‡•Ä ‡§§‡§Ç‡§§‡•Å'], answer: 1 },
        { question: '‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£ ax¬≤+bx+c=0 ‡§ï‡•á ‡§Æ‡•Ç‡§≤‡•ã‡§Ç ‡§ï‡§æ ‡§Ø‡•ã‡§ó ‡§π‡•ã‡§§‡§æ ‡§π‡•à?', options: ['-b/a', 'b/a', 'c/a', '-c/a'], answer: 0 },
    ];
    let currentQuestionIndex = 0, userAnswers = new Array(mockQuestions.length).fill(-1);
    let timerInterval, timeLeft = 120, testActive = false;

    // ==================== DOM ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏ ====================
    const loginArea = document.getElementById('loginArea');
    const dashboardArea = document.getElementById('dashboardArea');
    const userInfoDiv = document.getElementById('userInfo');
    const usernameSpan = document.getElementById('usernameDisplay');
    const toast = document.getElementById('toast');
    const notesContent = document.getElementById('notesContent');
    const subjectNameSpan = document.getElementById('subjectName');
    const biologyDiagram = document.getElementById('biologyDiagram');
    const videoMessage = document.getElementById('videoMessage');
    const adminPanel = document.getElementById('adminPanel');
    const requestListDiv = document.getElementById('requestList');
    const historyListDiv = document.getElementById('historyList');
    const notebookListDiv = document.getElementById('notebookList');
    const noteSearchInput = document.getElementById('noteSearchInput');
    const topicInput = document.getElementById('topicInput');
    const generateBtn = document.getElementById('generateBtn');
    const improveBtn = document.getElementById('improveBtn');
    const voiceSearchBtn = document.getElementById('voiceSearchBtn');
    const fileUpload = document.getElementById('fileUpload');
    const fileInfoArea = document.getElementById('fileInfoArea');
    const fileNameSpan = document.getElementById('fileName');
    const fileSizeSpan = document.getElementById('fileSize');
    const clearFileBtn = document.getElementById('clearFileBtn');
    const ocrProgress = document.getElementById('ocrProgress');
    const ocrFill = document.getElementById('ocrProgressFill');
    const imgPreviewBox = document.getElementById('imgPreviewBox');
    const videoPreviewBox = document.getElementById('videoPreviewBox');
    const previewImg = document.getElementById('previewImg');
    const videoPreview = document.getElementById('videoPreview');
    const outputArea = document.getElementById('outputArea');

    // ==================== ‡§â‡§™‡§Ø‡•ã‡§ó‡§ø‡§§‡§æ ====================
    function showToast(msg, type = 'success') {
        toast.style.display = 'block';
        toast.innerHTML = msg;
        toast.style.background = type === 'error' ? '#b71c1c' : (type === 'warning' ? '#b85e00' : '#1e1e1e');
        setTimeout(() => toast.style.display = 'none', 3000);
    }

    function saveCurrentUser(user) { currentUser = user; localStorage.setItem(CURRENT_USER_KEY, JSON.stringify(user)); }

    const notesDatabase = {
        physics: '‚öõÔ∏è **‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ**: K_max = hf - œÜ‚ÇÄ\n‚Ä¢ ‡§®‡§ø‡§∞‡•ã‡§ß‡•Ä ‡§µ‡§ø‡§≠‡§µ V‚ÇÄ = (h/e)f - œÜ‚ÇÄ/e\n‚Ä¢ ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø: f‚ÇÄ = œÜ‚ÇÄ/h',
        chemistry: 'üß™ **‡§∞‡§æ‡§∏‡§æ‡§Ø‡§®‡§ø‡§ï ‡§¨‡§≤‡§ó‡§§‡§ø‡§ï‡•Ä**: ‡§Ö‡§≠‡§ø‡§ï‡•ç‡§∞‡§ø‡§Ø‡§æ ‡§ï‡•Ä ‡§¶‡§∞, ‡§ï‡•ã‡§ü‡§ø, ‡§Ü‡§£‡§µ‡§ø‡§ï‡§§‡§æ‡•§\n‚Ä¢ ‡§™‡•ç‡§∞‡§•‡§Æ ‡§ï‡•ã‡§ü‡§ø: k = (2.303/t) log([R]‚ÇÄ/[R])',
        maths: 'üìê **‡§Ö‡§µ‡§ï‡§≤‡§®**: d/dx(sin x) = cos x, d/dx(cos x) = -sin x\n‚Ä¢ ‡§∂‡•ç‡§∞‡•É‡§Ç‡§ñ‡§≤‡§æ ‡§®‡§ø‡§Ø‡§Æ',
        biology: 'üß¨ **‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø**: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑ ‚Äì ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¶‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§Ö‡§≤‡§ø‡§Ç‡§¶, ‡§¨‡§æ‡§Ø‡§æ‡§Ç ‡§®‡§ø‡§≤‡§Ø‡•§ SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞‡•§'
    };

    function updateNotesAndUI() {
        subjectNameSpan.innerText = (selectedSubject === 'physics' ? '‡§≠‡•å‡§§‡§ø‡§ï‡•Ä' : selectedSubject === 'chemistry' ? '‡§∞‡§∏‡§æ‡§Ø‡§®' : selectedSubject === 'maths' ? '‡§ó‡§£‡§ø‡§§' : '‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®');
        notesContent.innerText = notesDatabase[selectedSubject] || '‡§®‡•ã‡§ü‡•ç‡§∏ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§®‡§π‡•Ä‡§Ç';
        biologyDiagram.style.display = selectedSubject === 'biology' ? 'flex' : 'none';
        addToHistory(selectedSubject);
        checkApprovedVideo(selectedSubject);
        renderNotebookFromStorage();
    }

    function addToHistory(subject) {
        if (!currentUser) return;
        let history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        history.push({ username: currentUser.username, subject, className: selectedClass, timestamp: new Date().toLocaleString('hi-IN') });
        localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
        renderHistory();
    }

    function renderHistory() {
        if (!currentUser) return;
        const history = JSON.parse(localStorage.getItem(HISTORY_KEY)) || [];
        const userHistory = history.filter(h => h.username === currentUser.username).reverse().slice(0, 10);
        historyListDiv.innerHTML = userHistory.length ? userHistory.map(h => `
            <div class="history-item"><span><i class="fas fa-book"></i> ${h.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${h.className})</span><span class="badge">${h.timestamp}</span></div>
        `).join('') : '<div class="history-item">‡§ï‡•ã‡§à ‡§á‡§§‡§ø‡§π‡§æ‡§∏ ‡§®‡§π‡•Ä‡§Ç</div>';
    }

    function requestVideo() {
        if (!currentUser) return;
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        requests.push({ username: currentUser.username, subject: selectedSubject, className: selectedClass, approved: false, timestamp: new Date().toLocaleString() });
        localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests));
        showToast('‚úÖ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≠‡•á‡§ú‡§æ ‡§ó‡§Ø‡§æ, ‡§è‡§°‡§Æ‡§ø‡§® ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§® ‡§ï‡•á ‡§¨‡§æ‡§¶ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§π‡•ã‡§ó‡§æ');
        if (currentUser.username === 'admin') renderRequests();
    }

    function renderRequests() {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const pending = requests.filter(r => !r.approved);
        if (!pending.length) { requestListDiv.innerHTML = '<div class="history-item">‡§ï‡•ã‡§à ‡§≤‡§Ç‡§¨‡§ø‡§§ ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§®‡§π‡•Ä‡§Ç</div>'; return; }
        requestListDiv.innerHTML = pending.map((r, idx) => `
            <div class="request-item">
                <span>${r.username} - ${r.subject} (‡§ï‡§ï‡•ç‡§∑‡§æ ${r.className})</span>
                <button class="btn" onclick="window.approveRequest(${idx})" style="padding:4px 16px; background:var(--primary); color:white; border:none; border-radius:40px;">‡§Æ‡§Ç‡§ú‡•Ç‡§∞ ‡§ï‡§∞‡•á‡§Ç</button>
            </div>`).join('');
    }

    window.approveRequest = function(pendingIdx) {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        let count = -1;
        for (let i=0; i<requests.length; i++) {
            if (!requests[i].approved) count++;
            if (count === pendingIdx) { requests[i].approved = true; break; }
        }
        localStorage.setItem(REQUESTS_KEY, JSON.stringify(requests));
        showToast('‚úÖ ‡§Ö‡§®‡•Å‡§Æ‡•ã‡§¶‡§ø‡§§');
        renderRequests();
        checkApprovedVideo(selectedSubject);
    };

    function checkApprovedVideo(subject) {
        if (!currentUser) return;
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const approved = requests.find(r => r.subject === subject && r.className === selectedClass && r.approved);
        videoMessage.innerHTML = approved ? '<span style="color:lightgreen;">‚úÖ ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§â‡§™‡§≤‡§¨‡•ç‡§ß! ‡§ö‡§≤‡§æ‡§è‡§Å.</span>' : '‡§ï‡•ã‡§à ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§®‡§π‡•Ä‡§Ç‡•§ "‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç" ‡§¶‡§¨‡§æ‡§è‡§Å‡•§';
    }

    function playVideo() {
        const requests = JSON.parse(localStorage.getItem(REQUESTS_KEY)) || [];
        const approved = requests.find(r => r.subject === selectedSubject && r.className === selectedClass && r.approved);
        if (approved || (currentUser && currentUser.username === 'admin')) {
            videoMessage.innerHTML = 'üé¨ [AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã] ‡§ö‡§≤ ‡§∞‡§π‡§æ ‡§π‡•à... <i class="fas fa-sync fa-spin"></i> ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ‡§ø‡§Ç‡§ó (‡§Æ‡•â‡§ï)';
            showToast('üîä ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∂‡•Å‡§∞‡•Ç');
        } else showToast('‚ùå ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§®‡§π‡•Ä‡§Ç‡•§ ‡§™‡§π‡§≤‡•á ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç‡•§', 'error');
    }

    // ========== AI ‡§ü‡•Ç‡§≤‡•ç‡§∏ (‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§) ==========
    if ('webkitSpeechRecognition' in window) {
        const recognition = new webkitSpeechRecognition();
        recognition.lang = 'hi-IN';
        recognition.onresult = (e) => { topicInput.value = e.results[0][0].transcript; processAI(); };
        voiceSearchBtn.onclick = () => recognition.start();
    }

    clearFileBtn.addEventListener('click', () => { fileUpload.value = ''; fileInfoArea.style.display = 'none'; imgPreviewBox.classList.remove('show'); videoPreviewBox.classList.remove('show'); });

    fileUpload.addEventListener('change', async (e) => {
        const file = e.target.files[0]; if (!file) return;
        fileNameSpan.textContent = file.name; fileSizeSpan.textContent = `(${(file.size/1024).toFixed(1)} KB)`; fileInfoArea.style.display = 'flex';
        if (file.type.startsWith('image/')) {
            previewImg.src = URL.createObjectURL(file); imgPreviewBox.classList.add('show');
            ocrProgress.style.display = 'block';
            try {
                const result = await Tesseract.recognize(file, 'hin+eng', { logger: m => { if (m.status === 'recognizing text') ocrFill.style.width = Math.round(m.progress*100)+'%'; } });
                topicInput.value = result.data.text.trim().substring(0,200) || '‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ';
                ocrProgress.style.display = 'none'; showToast('‚úÖ OCR ‡§∏‡§´‡§≤');
            } catch { ocrProgress.style.display = 'none'; showToast('‚ùå OCR ‡§§‡•ç‡§∞‡•Å‡§ü‡§ø', 'error'); }
        } else if (file.type.startsWith('video/')) { videoPreview.src = URL.createObjectURL(file); videoPreviewBox.classList.add('show'); topicInput.value = file.name; } 
        else topicInput.value = file.name;
    });

    function generateAISummary(topic) {
        let t = topic.toLowerCase();
        if (t.includes('‡§™‡•ç‡§∞‡§ï‡§æ‡§∂')) return "‡§™‡•ç‡§∞‡§ï‡§æ‡§∂ ‡§µ‡•à‡§¶‡•ç‡§Ø‡•Å‡§§ ‡§™‡•ç‡§∞‡§≠‡§æ‡§µ: $$K_{\\text{max}} = hf - \\phi_0$$‡•§ ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§¶‡•á‡§π‡§≤‡•Ä ‡§Ü‡§µ‡•É‡§§‡•ç‡§§‡§ø ‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§π‡•ã‡§®‡•Ä ‡§ö‡§æ‡§π‡§ø‡§è‡•§";
        if (t.includes('‡§π‡•É‡§¶‡§Ø')) return "‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø: ‡§ö‡§æ‡§∞ ‡§ï‡§ï‡•ç‡§∑, SA ‡§®‡•ã‡§° ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞, ‡§∞‡§ï‡•ç‡§§ ‡§™‡§Ç‡§™ ‡§ï‡§∞‡§§‡§æ ‡§π‡•à‡•§";
        if (t.includes('‡§ó‡§£‡§ø‡§§')||t.includes('‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£')) return "‡§¶‡•ç‡§µ‡§ø‡§ò‡§æ‡§§ ‡§∏‡§Æ‡•Ä‡§ï‡§∞‡§£: $$x = \\frac{-b \\pm \\sqrt{b^2-4ac}}{2a}$$";
        return `${topic} ‡§ï‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡§ø‡§™‡•ç‡§§ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂: ‡§Ø‡§π ‡§ü‡•â‡§™‡§ø‡§ï ‡§™‡§∞‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Æ‡§π‡§§‡•ç‡§µ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§π‡•à‡•§`;
    }

    function processAI() {
        const topic = topicInput.value.trim(); if (!topic) return;
        outputArea.innerHTML = `<div style="margin-top:10px; background:white; padding:15px; border-radius:20px; border-left:6px solid var(--primary);"><h3 style="color:var(--primary);">ü§ñ AI ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂</h3><p>${generateAISummary(topic)}</p></div>`;
        if (window.renderMathInElement) renderMathInElement(outputArea);
    }

    function improveContent() {
        const topic = topicInput.value.trim(); if (!topic) { showToast('‚ùå ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç','error'); return; }
        let easy = topic; // simplified mock
        outputArea.innerHTML += `<div style="border-left:8px solid var(--primary); background:white; padding:20px; border-radius:20px; margin-top:15px;"><h3><i class="fas fa-smile"></i> ‡§Ü‡§∏‡§æ‡§® ‡§Æ‡•ã‡§°</h3><p>${easy} ‡§ï‡•ã ‡§∏‡§∞‡§≤ ‡§≠‡§æ‡§∑‡§æ ‡§Æ‡•á‡§Ç ‡§∏‡§Æ‡§ù‡•á‡§Ç</p></div>`;
    }

    generateBtn.addEventListener('click', processAI);
    improveBtn.addEventListener('click', improveContent);

    // ========== ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ==========
    function getNotes() { return JSON.parse(localStorage.getItem(getNotesKey()) || '[]'); }
    function saveNotes(notes) { localStorage.setItem(getNotesKey(), JSON.stringify(notes)); }

    function renderNotebookFromStorage(cat = 'all') {
        let notes = getNotes();
        const searchTerm = noteSearchInput ? noteSearchInput.value.toLowerCase() : '';
        let filtered = cat === 'all' ? notes : notes.filter(n => n.category === cat);
        if (searchTerm) filtered = filtered.filter(n => n.text.toLowerCase().includes(searchTerm));
        filtered.sort((a,b) => b.timestamp - a.timestamp);
        notebookListDiv.innerHTML = filtered.length ? filtered.map(n => `
            <div class="note-item">
                <span><i class="fas fa-${n.category==='physics'?'atom':(n.category==='chemistry'?'flask':'dna')}"></i> ${n.text}</span>
                <button class="delete-note" onclick="deleteNote('${n.id}')"><i class="fas fa-trash"></i></button>
            </div>`).join('') : '<div class="note-item">‡§ï‡•ã‡§à ‡§®‡•ã‡§ü ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ</div>';
    }

    window.deleteNote = (id) => { let notes = getNotes(); notes = notes.filter(n => n.id !== id); saveNotes(notes); const activeCat = document.querySelector('.cat-btn.active')?.dataset.cat || 'all'; renderNotebookFromStorage(activeCat); };
    document.getElementById('addNoteBtn').addEventListener('click', () => {
        const text = document.getElementById('newNoteText').value.trim();
        const category = document.getElementById('newNoteCategory').value;
        if (!text) { showToast('‡§®‡•ã‡§ü ‡§≤‡§ø‡§ñ‡•á‡§Ç', 'error'); return; }
        let notes = getNotes();
        notes.push({ id: 'note_' + Date.now() + Math.random(), text: text, category: category, timestamp: Date.now() });
        saveNotes(notes);
        document.getElementById('newNoteText').value = '';
        renderNotebookFromStorage(document.querySelector('.cat-btn.active')?.dataset.cat || 'all');
        showToast('‚úÖ ‡§®‡•ã‡§ü ‡§ú‡•Å‡§°‡§º ‡§ó‡§Ø‡§æ');
    });

    document.querySelectorAll('.cat-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.cat-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active');
        renderNotebookFromStorage(this.dataset.cat);
    }));

    // ========== ‡§≠‡§æ‡§∑‡§æ ‡§ü‡•â‡§ó‡§≤ ==========
    window.toggleLanguage = function() {
        const toggle = document.getElementById('langToggle');
        const searchInput = document.getElementById('globalSearchInput');
        if (currentLang === 'hi') {
            currentLang = 'en';
            toggle.classList.add('eng');
            // English translations
            document.getElementById('brandName').innerText = "Ankita ¬∑ AI Study";
            searchInput.placeholder = "Search AI topics...";
            document.getElementById('introHeading').innerText = "Personalized AI Learning Hub";
            document.getElementById('introText').innerHTML = "<strong>Artificial Intelligence (AI)</strong> simulates human intelligence in machines, enabling them to learn, reason, and make decisions.";
            document.getElementById('feature1').innerHTML = '<i class="fas fa-brain"></i> <strong>Narrow AI:</strong> Excels at specific tasks like language translation.';
            document.getElementById('feature2').innerHTML = '<i class="fas fa-rocket"></i> <strong>General AI:</strong> Future human-like intelligence.';
            document.getElementById('classTitle').innerHTML = '<i class="fas fa-graduation-cap"></i> Select Class';
            document.getElementById('class9').innerText = 'Class 9';
            document.getElementById('class10').innerText = 'Class 10';
            document.getElementById('class11').innerText = 'Class 11';
            document.getElementById('class12').innerText = 'Class 12';
            document.getElementById('subjectTitle').innerHTML = '<i class="fas fa-book-open"></i> Select Subject';
            document.getElementById('subPhysics').innerText = 'Physics';
            document.getElementById('subChemistry').innerText = 'Chemistry';
            document.getElementById('subMaths').innerText = 'Maths';
            document.getElementById('subBiology').innerText = 'Biology';
            document.getElementById('notesLabel').innerText = 'Basic Notes';
            document.getElementById('heartTitle').innerText = 'Human Heart Structure';
            document.getElementById('chamberRA').innerHTML = 'Right Atrium <small>(Right Atrium)</small>';
            document.getElementById('chamberLA').innerHTML = 'Left Atrium <small>(Left Atrium)</small>';
            document.getElementById('chamberRV').innerHTML = 'Right Ventricle <small>(Right Ventricle)</small>';
            document.getElementById('chamberLV').innerHTML = 'Left Ventricle <small>(Left Ventricle)</small>';
            document.getElementById('saNodeText').innerHTML = '<i class="fas fa-arrow-right"></i> SA node (natural pacemaker) located in right atrium';
            document.getElementById('aiHelperTitle').innerText = 'AI Assistant ‚Äì Enter Your Topic';
            document.getElementById('summaryBtn').innerText = 'Summary';
            document.getElementById('fileZoneText').innerText = 'Upload or drag photo/PDF/video';
            document.getElementById('browseBtn').innerText = 'Browse';
            document.getElementById('mediaTitle').innerText = 'AI Media Creator';
            document.getElementById('demoTag').innerText = 'DEMO';
            document.getElementById('mediaDesc').innerText = 'Create stunning images & videos of your study topics.';
            document.getElementById('tabImage').innerHTML = 'üñºÔ∏è Generate Image';
            document.getElementById('tabVideo').innerHTML = 'üé¨ Generate Video';
            document.getElementById('videoTitle').innerText = 'Video Explanation (on request)';
            document.getElementById('playBtn').innerText = 'Play AI Video';
            document.getElementById('requestBtn').innerText = 'Request Video';
            document.getElementById('testTitle').innerText = 'Mock Test (RRB Style)';
            document.getElementById('prevText').innerText = 'Previous';
            document.getElementById('nextText').innerText = 'Next';
            document.getElementById('submitText').innerText = 'Submit';
            document.getElementById('notebookTitle').innerText = 'My Notebook';
            document.getElementById('catAll').innerText = 'All';
            document.getElementById('catPhysics').innerText = 'Physics';
            document.getElementById('catChemistry').innerText = 'Chemistry';
            document.getElementById('catBiology').innerText = 'Biology';
            document.getElementById('addBtn').innerText = 'Add';
            document.getElementById('exportBtn').innerText = 'Export Notebook';
            document.getElementById('historyTitle').innerText = 'My History (Viewed Topics)';
            document.getElementById('adminTitle').innerText = 'Admin : Pending Video Requests';
            document.getElementById('loginHeading').innerText = 'Login to Account';
            document.getElementById('loginBtnText').innerText = 'Login';
            document.getElementById('signupBtnText').innerText = 'Sign Up';
        } else {
            currentLang = 'hi';
            toggle.classList.remove('eng');
            // Hindi translations
            document.getElementById('brandName').innerText = "‡§Ö‡§Ç‡§ï‡§ø‡§§‡§æ ¬∑ AI Study";
            searchInput.placeholder = "AI ‡§ü‡•â‡§™‡§ø‡§ï ‡§ñ‡•ã‡§ú‡•á‡§Ç...";
            document.getElementById('introHeading').innerText = "What is Artificial Intelligence?";
            document.getElementById('introText').innerHTML = "<strong>Artificial Intelligence (AI)</strong> is the sophisticated simulation of human cognition by computer systems. It empowers machines to not only <em>learn</em> from data and <em>reason</em> through complex problems but also to <em>perceive</em> environments and execute <em>autonomous decisions</em>.";
            document.getElementById('feature1').innerHTML = '<i class="fas fa-brain"></i> <strong>Narrow AI:</strong> Designed for specific tasks like language processing.';
            document.getElementById('feature2').innerHTML = '<i class="fas fa-rocket"></i> <strong>General AI:</strong> Future frontier aiming for human-level versatility.';
            document.getElementById('classTitle').innerHTML = '<i class="fas fa-graduation-cap"></i> ‡§ï‡§ï‡•ç‡§∑‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç';
            document.getElementById('class9').innerText = '‡§ï‡§ï‡•ç‡§∑‡§æ 9';
            document.getElementById('class10').innerText = '‡§ï‡§ï‡•ç‡§∑‡§æ 10';
            document.getElementById('class11').innerText = '‡§ï‡§ï‡•ç‡§∑‡§æ 11';
            document.getElementById('class12').innerText = '‡§ï‡§ï‡•ç‡§∑‡§æ 12';
            document.getElementById('subjectTitle').innerHTML = '<i class="fas fa-book-open"></i> ‡§µ‡§ø‡§∑‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç';
            document.getElementById('subPhysics').innerText = '‡§≠‡•å‡§§‡§ø‡§ï‡•Ä';
            document.getElementById('subChemistry').innerText = '‡§∞‡§∏‡§æ‡§Ø‡§®';
            document.getElementById('subMaths').innerText = '‡§ó‡§£‡§ø‡§§';
            document.getElementById('subBiology').innerText = '‡§ú‡•Ä‡§µ ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§®';
            document.getElementById('notesLabel').innerText = '‡§Æ‡•Ç‡§≤ ‡§®‡•ã‡§ü‡•ç‡§∏';
            document.getElementById('heartTitle').innerText = '‡§Æ‡§æ‡§®‡§µ ‡§π‡•É‡§¶‡§Ø ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ';
            document.getElementById('chamberRA').innerHTML = '‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Right Atrium)</small>';
            document.getElementById('chamberLA').innerHTML = '‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ <small>(Left Atrium)</small>';
            document.getElementById('chamberRV').innerHTML = '‡§¶‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Right Ventricle)</small>';
            document.getElementById('chamberLV').innerHTML = '‡§¨‡§æ‡§Ø‡§æ‡§Å ‡§®‡§ø‡§≤‡§Ø <small>(Left Ventricle)</small>';
            document.getElementById('saNodeText').innerHTML = '<i class="fas fa-arrow-right"></i> SA ‡§®‡•ã‡§° (‡§™‡•ç‡§∞‡§æ‡§ï‡•É‡§§‡§ø‡§ï ‡§™‡•á‡§∏‡§Æ‡•á‡§ï‡§∞) ‡§¶‡§æ‡§è‡§Å ‡§Ö‡§≤‡§ø‡§Ç‡§¶ ‡§Æ‡•á‡§Ç ‡§∏‡•ç‡§•‡§ø‡§§';
            document.getElementById('aiHelperTitle').innerText = 'AI ‡§∏‡§π‡§æ‡§Ø‡§ï ‚Äì ‡§Ö‡§™‡§®‡§æ ‡§ü‡•â‡§™‡§ø‡§ï ‡§≤‡§ø‡§ñ‡•á‡§Ç';
            document.getElementById('summaryBtn').innerText = '‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂';
            document.getElementById('fileZoneText').innerText = '‡§´‡•ã‡§ü‡•ã/PDF/‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§™‡§≤‡•ã‡§° ‡§ï‡§∞‡•á‡§Ç ‡§Ø‡§æ ‡§ñ‡•Ä‡§Ç‡§ö‡•á‡§Ç';
            document.getElementById('browseBtn').innerText = '‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç';
            document.getElementById('mediaTitle').innerText = 'AI ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞';
            document.getElementById('demoTag').innerText = '‡§°‡•á‡§Æ‡•ã';
            document.getElementById('mediaDesc').innerText = '‡§Ö‡§™‡§®‡•á ‡§™‡§¢‡§º‡§æ‡§à ‡§ï‡•á ‡§ü‡•â‡§™‡§ø‡§ï‡•ç‡§∏ ‡§ï‡•Ä ‡§∂‡§æ‡§®‡§¶‡§æ‡§∞ ‡§õ‡§µ‡§ø‡§Ø‡§æ‡§Å ‡§î‡§∞ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§¨‡§®‡§æ‡§è‡§Å‡•§';
            document.getElementById('tabImage').innerHTML = 'üñºÔ∏è ‡§õ‡§µ‡§ø ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç';
            document.getElementById('tabVideo').innerHTML = 'üé¨ ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ú‡§®‡§∞‡•á‡§ü ‡§ï‡§∞‡•á‡§Ç';
            document.getElementById('videoTitle').innerText = '‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§µ‡•ç‡§Ø‡§æ‡§ñ‡•ç‡§Ø‡§æ (‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§™‡§∞)';
            document.getElementById('playBtn').innerText = 'AI ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§ö‡§≤‡§æ‡§è‡§Å';
            document.getElementById('requestBtn').innerText = '‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§ï‡§∞‡•á‡§Ç';
            document.getElementById('testTitle').innerText = '‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü (RRB ‡§∏‡•ç‡§ü‡§æ‡§á‡§≤)';
            document.getElementById('prevText').innerText = '‡§™‡§ø‡§õ‡§≤‡§æ';
            document.getElementById('nextText').innerText = '‡§Ö‡§ó‡§≤‡§æ';
            document.getElementById('submitText').innerText = '‡§ú‡§Æ‡§æ ‡§ï‡§∞‡•á‡§Ç';
            document.getElementById('notebookTitle').innerText = '‡§Æ‡•á‡§∞‡•Ä ‡§®‡•ã‡§ü‡§¨‡•Å‡§ï';
            document.getElementById('catAll').innerText = '‡§∏‡§≠‡•Ä';
            document.getElementById('catPhysics').innerText = '‡§´‡§ø‡§ú‡§ø‡§ï‡•ç‡§∏';
            document.getElementById('catChemistry').innerText = '‡§ï‡•á‡§Æ‡§ø‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä';
            document.getElementById('catBiology').innerText = '‡§¨‡§æ‡§Ø‡•ã‡§≤‡•â‡§ú‡•Ä';
            document.getElementById('addBtn').innerText = '‡§ú‡•ã‡§°‡§º‡•á‡§Ç';
            document.getElementById('exportBtn').innerText = '‡§®‡•ã‡§ü‡§¨‡•Å‡§ï ‡§è‡§ï‡•ç‡§∏‡§™‡•ã‡§∞‡•ç‡§ü';
            document.getElementById('historyTitle').innerText = '‡§Æ‡•á‡§∞‡§æ ‡§á‡§§‡§ø‡§π‡§æ‡§∏ (‡§¶‡•á‡§ñ‡•á ‡§ó‡§è ‡§µ‡§ø‡§∑‡§Ø)';
            document.getElementById('adminTitle').innerText = '‡§µ‡•ç‡§Ø‡§µ‡§∏‡•ç‡§•‡§æ‡§™‡§ï : ‡§µ‡•Ä‡§°‡§ø‡§Ø‡•ã ‡§Ö‡§®‡•Å‡§∞‡•ã‡§ß ‡§≤‡§Ç‡§¨‡§ø‡§§';
            document.getElementById('loginHeading').innerText = '‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§Æ‡•á‡§Ç ‡§™‡•ç‡§∞‡§µ‡•á‡§∂';
            document.getElementById('loginBtnText').innerText = '‡§≤‡•â‡§ó‡§ø‡§®';
            document.getElementById('signupBtnText').innerText = '‡§∏‡§æ‡§á‡§®‡§Ö‡§™';
        }
        showToast(`Language changed to ${currentLang === 'hi' ? 'Hindi' : 'English'}`);
    };

    // ========== ‡§Æ‡•â‡§ï ‡§ü‡•á‡§∏‡•ç‡§ü ==========
    function initMockTest() {
        currentQuestionIndex = 0; userAnswers.fill(-1); timeLeft = 120; testActive = true;
        document.getElementById('submitTest').style.display = 'inline-flex';
        document.getElementById('testResult').style.display = 'none';
        startTimer(); showQuestion();
    }
    function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
            timeLeft--; let mins = Math.floor(timeLeft/60), secs = timeLeft%60;
            document.getElementById('timer').innerText = `${mins.toString().padStart(2,'0')}:${secs.toString().padStart(2,'0')}`;
            if (timeLeft <= 0) { clearInterval(timerInterval); submitMockTest(); }
        },1000);
    }
    function showQuestion() {
        if (!testActive) return;
        let q = mockQuestions[currentQuestionIndex];
        document.getElementById('questionText').innerHTML = `<strong>‡§™‡•ç‡§∞‡§∂‡•ç‡§® ${currentQuestionIndex+1}/${mockQuestions.length}:</strong> ${q.question}`;
        let opts = '';
        q.options.forEach((opt, idx) => {
            opts += `<div class="opt-btn ${userAnswers[currentQuestionIndex] === idx ? 'selected' : ''}" onclick="selectOption(${idx})">${String.fromCharCode(65+idx)}. ${opt}</div>`;
        });
        document.getElementById('optionsContainer').innerHTML = opts;
        document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
        document.getElementById('nextBtn').disabled = currentQuestionIndex === mockQuestions.length-1;
    }
    window.selectOption = function(idx) { if (!testActive) return; userAnswers[currentQuestionIndex] = idx; showQuestion(); };
    document.getElementById('prevBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex>0) { currentQuestionIndex--; showQuestion(); } });
    document.getElementById('nextBtn')?.addEventListener('click', ()=>{ if(currentQuestionIndex < mockQuestions.length-1) { currentQuestionIndex++; showQuestion(); } });
    document.getElementById('submitTest')?.addEventListener('click', submitMockTest);
    function submitMockTest() {
        clearInterval(timerInterval); testActive = false;
        let correct = userAnswers.reduce((acc, ans, i) => acc + (ans === mockQuestions[i].answer ? 1 : 0), 0);
        let percent = (correct / mockQuestions.length) * 100;
        document.getElementById('testResult').innerHTML = `<h3>‡§™‡§∞‡§ø‡§£‡§æ‡§Æ</h3><p>‡§∏‡§π‡•Ä: ${correct}/${mockQuestions.length} (${percent.toFixed(1)}%)</p><button class="btn" onclick="initMockTest()">‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏</button>`;
        document.getElementById('testResult').style.display = 'block';
        document.getElementById('submitTest').style.display = 'none';
    }

    // ========== ‡§≤‡•â‡§ó‡§ø‡§® / ‡§≤‡•â‡§ó‡§Ü‡§â‡§ü ==========
    document.getElementById('loginBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const user = users.find(u => u.username === document.getElementById('loginUsername').value.trim() && u.password === document.getElementById('loginPassword').value.trim());
        if (user) { onLogin(user); } else showToast('‡§ó‡§≤‡§§ ‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°', 'error');
    });
    document.getElementById('signupBtn').addEventListener('click', () => {
        const users = JSON.parse(localStorage.getItem(USERS_KEY)) || [];
        const newU = document.getElementById('loginUsername').value.trim(); const newP = document.getElementById('loginPassword').value.trim();
        if (!newU || !newP) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ/‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§° ‡§¶‡•á‡§Ç','error');
        if (users.find(u => u.username === newU)) return showToast('‡§Ø‡•Ç‡§ú‡§∞‡§®‡•á‡§Æ ‡§Æ‡•å‡§ú‡•Ç‡§¶','error');
        users.push({ username: newU, password: newP }); localStorage.setItem(USERS_KEY, JSON.stringify(users)); showToast('‡§Ö‡§ï‡§æ‡§â‡§Ç‡§ü ‡§¨‡§®‡§æ, ‡§Ö‡§¨ ‡§≤‡•â‡§ó‡§ø‡§® ‡§ï‡§∞‡•á‡§Ç');
    });

    function onLogin(user) {
        saveCurrentUser(user); usernameSpan.innerText = user.username; userInfoDiv.style.display = 'flex'; loginArea.style.display = 'none'; dashboardArea.style.display = 'block';
        if (user.username === 'admin') { adminPanel.style.display = 'block'; renderRequests(); } else adminPanel.style.display = 'none';
        updateNotesAndUI(); renderHistory(); renderNotebookFromStorage(); initMockTest();
    }

    document.getElementById('logoutBtn').addEventListener('click', () => {
        currentUser = null; localStorage.removeItem(CURRENT_USER_KEY);
        userInfoDiv.style.display = 'none'; loginArea.style.display = 'block'; dashboardArea.style.display = 'none';
    });

    document.querySelectorAll('.class-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.class-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedClass = this.dataset.class; updateNotesAndUI();
    }));
    document.querySelectorAll('.sub-btn').forEach(b => b.addEventListener('click', function() {
        document.querySelectorAll('.sub-btn').forEach(bb => bb.classList.remove('active')); this.classList.add('active'); selectedSubject = this.dataset.subject; updateNotesAndUI();
    }));
    document.getElementById('playVideoBtn').addEventListener('click', playVideo);
    document.getElementById('requestVideoBtn').addEventListener('click', requestVideo);

    // ‡§ó‡•ç‡§≤‡•ã‡§¨‡§≤ ‡§∏‡§∞‡•ç‡§ö
    document.getElementById('globalSearchInput').addEventListener('keypress', (e) => {
        if (e.key === 'Enter') {
            topicInput.value = e.target.value;
            processAI();
        }
    });

    if (currentUser) onLogin(currentUser);

    // ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ‡§ü‡•à‡§¨ (‡§∏‡§∞‡§≤‡•Ä‡§ï‡•É‡§§) ‚Äì ‡§¨‡§∏ ‡§°‡§Æ‡•Ä ‡§á‡§µ‡•á‡§Ç‡§ü ‡§§‡§æ‡§ï‡§ø error ‡§® ‡§π‡•ã
    document.querySelectorAll('.media-tab').forEach(tab => {
        tab.addEventListener('click', function() {
            document.querySelectorAll('.media-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.media-content').forEach(c => c.classList.remove('active'));
            this.classList.add('active');
            document.getElementById(this.dataset.media + '-tab').classList.add('active');
        });
    });
    // ‡§°‡§Æ‡•Ä ‡§ú‡§®‡§∞‡•á‡§ü ‡§¨‡§ü‡§®
    document.getElementById('generateImageBtn')?.addEventListener('click', ()=> showToast('üñºÔ∏è Image generation demo'));
    document.getElementById('generateVideoBtn')?.addEventListener('click', ()=> showToast('üé¨ Video generation demo'));
})();
</script>
<!-- ‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ï‡•ç‡§∞‡§ø‡§è‡§ü‡§∞ ‡§ï‡•á ‡§õ‡•Ç‡§ü‡•á ‡§π‡•Å‡§è ‡§≠‡§æ‡§ó ‡§ï‡•ã ‡§™‡•Ç‡§∞‡§æ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§°‡§Æ‡•Ä ‡§è‡§≤‡§ø‡§Æ‡•á‡§Ç‡§ü‡•ç‡§∏ (‡§µ‡•á ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à‡§Ç, ‡§™‡§∞ ‡§Ø‡§π‡§æ‡§Å ‡§™‡•Ç‡§∞‡§æ ‡§ï‡•ã‡§° ‡§¨‡§π‡•Å‡§§ ‡§≤‡§Ç‡§¨‡§æ ‡§π‡•à; ‡§∏‡•Å‡§®‡§ø‡§∂‡•ç‡§ö‡§ø‡§§ ‡§ï‡§∞‡•á‡§Ç ‡§ï‡§ø image-tab ‡§î‡§∞ video-tab ‡§Æ‡•á‡§Ç ‡§¨‡§ü‡§® ‡§π‡•à‡§Ç) -->
<!-- ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ ‡§°‡§Æ‡•Ä ‡§°‡§æ‡§≤ ‡§∞‡§π‡•á ‡§π‡•à‡§Ç -->
<div style="display:none;">‡§Æ‡•Ä‡§°‡§ø‡§Ø‡§æ ‡§ü‡•à‡§¨ ‡§ï‡•Ä ‡§∏‡§Ç‡§∞‡§ö‡§®‡§æ ‡§™‡•Ç‡§∞‡•Ä ‡§π‡•à</div>
</body>
</html>